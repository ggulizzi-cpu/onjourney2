{"version":3,"mappings":"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","names":["m","require$$0","createRoot","mockAuth","supabase","AuthContext","createContext","useAuth","context","useContext","AuthProvider","children","user","setUser","useState","useEffect","session","_a","subscription","_event","value","email","password","error","toast","jsx","Logo","Link","NAV_ITEMS","NavigationComponent","item","Navigation","memo","MobileMenuComponent","isOpen","setIsOpen","toggleMenu","useCallback","prev","handleItemClick","jsxs","X","Menu","MobileMenu","AuthButtons","signOut","UserCircle","Header","socialLinks","Facebook","Twitter","Instagram","Youtube","contactInfo","Mail","Phone","MapPin","Footer","Icon","text","href","label","Layout","Image","src","alt","className","props","setError","backgroundImages","destinations","getRandomTravelImage","default_format","formatters","v","RFC1738","is_array","hex_table","array","i","limit","encode","str","_defaultEncoder","charset","_kind","format","string","$0","out","j","segment","arr","c","is_buffer","obj","maybe_map","val","fn","mapped","has","array_prefix_generators","prefix","key","push","push_to_array","value_or_array","to_ISO","defaults","date","is_non_nullish_primitive","sentinel","inner_stringify","object","generateArrayPrefix","commaRoundTrip","allowEmptyArrays","strictNullHandling","skipNulls","encodeDotInKeys","encoder","filter","sort","allowDots","serializeDate","formatter","encodeValuesOnly","sideChannel","tmp_sc","step","find_flag","pos","key_value","values","obj_keys","keys","encoded_prefix","adjusted_prefix","encoded_key","key_prefix","valueSideChannel","normalize_stringify_options","opts","arrayFormat","stringify","options","joined","VERSION","auto","kind","fetch","FormData","File","ReadableStream","getMultipartRequestOptions","getDefaultAgent","fileFromPath","isFsReadStream","setShims","shims","MultipartBody","body","getRuntime","manuallyImported","recommendation","_fetch","_Request","_Response","_Headers","form","url","shims.kind","shims.setShims","auto.getRuntime","OpenAIError","APIError","status","message","headers","data","msg","errorResponse","APIConnectionError","castToError","BadRequestError","AuthenticationError","PermissionDeniedError","NotFoundError","ConflictError","UnprocessableEntityError","RateLimitError","InternalServerError","APIUserAbortError","cause","APIConnectionTimeoutError","LengthFinishReasonError","ContentFilterFinishReasonError","LineDecoder","chunk","trailingNewline","lines","bytes","Stream","iterator","controller","response","consumed","done","sse","_iterSSEMessages","e","readableStream","iterLines","lineDecoder","iter","readableStreamAsyncIterable","line","left","right","teeIterator","queue","result","self","ctrl","err","sseDecoder","SSEDecoder","sseChunk","iterSSEChunks","binaryChunk","newData","patternIndex","findDoubleNewlineIndex","buffer","fieldname","_","partition","delimiter","index","stream","reader","cancelPromise","isResponseLike","isFileLike","isBlobLike","isUploadable","toFile","name","blob","bits","getBytes","getName","type","parts","isAsyncIterableIterator","propsForError","p","getStringFromMaybeBuffer","x","isMultipartBody","multipartFormRequestOptions","createForm","addFormValue","file","entry","prop","__classPrivateFieldSet","receiver","state","f","__classPrivateFieldGet","_AbstractPage_client","defaultParseResponse","debug","contentType","json","_addRequestID","APIPromise","responsePromise","parseResponse","resolve","transform","onfulfilled","onrejected","onfinally","APIClient","baseURL","maxRetries","timeout","httpAgent","overridenFetch","validatePositiveInteger","getPlatformHeaders","customHeaders","uuid4","path","method","Page","retryCount","query","contentLength","minAgentTimeout","reqHeaders","defaultHeaders","applyHeadersMut","shimsKind","getHeader","request","header","remainingRetries","optionsInput","retriesRemaining","req","_b","responseHeaders","createResponseHeaders","retryMessage","errText","errJSON","safeJSON","errMessage","PagePromise","isAbsoluteURL","defaultQuery","isEmptyObj","init","ms","signal","shouldRetryHeader","timeoutMillis","retryAfterMillisHeader","timeoutMs","retryAfterHeader","timeoutSeconds","sleep","numRetries","sleepSeconds","jitter","AbstractPage","client","nextInfo","nextOptions","params","page","target","requestOptionsKeys","isRequestOptions","k","hasOwn","getPlatformProperties","normalizePlatform","normalizeArch","browserInfo","getBrowserInfo","browserPatterns","pattern","match","major","minor","patch","arch","platform","_platformHeaders","startsWithSchemeRegexp","n","readEnv","env","define_process_env_default","_d","_c","_k","targetHeaders","newHeaders","lowerKey","action","args","r","isRunningInBrowser","isHeadersProtocol","lowerCasedHeader","intercapsHeader","_m","g1","g2","isObj","CursorPage","info","id","APIResource","CompletionsAPI.Completions","Chat","Completions","Speech","Transcriptions","Core.multipartFormRequestOptions","Translations","Audio","TranscriptionsAPI.Transcriptions","TranslationsAPI.Translations","SpeechAPI.Speech","Batches","batchId","BatchesPage","Assistants","assistantId","AssistantsPage","isRunnableFunctionWithParse","isAssistantMessage","isFunctionMessage","isToolMessage","_EventStream_instances","_EventStream_connectedPromise","_EventStream_resolveConnectedPromise","_EventStream_rejectConnectedPromise","_EventStream_endPromise","_EventStream_resolveEndPromise","_EventStream_rejectEndPromise","_EventStream_listeners","_EventStream_ended","_EventStream_errored","_EventStream_aborted","_EventStream_catchingPromiseCreated","_EventStream_handleError","EventStream","reject","executor","event","listener","listeners","l","openAIError","isAutoParsableResponseFormat","response_format","isAutoParsableTool","tool","maybeParseChatCompletion","completion","hasAutoParseableInput","choice","parseChatCompletion","choices","toolCall","parseToolCall","parseResponseFormat","content","inputTool","shouldParseToolCall","validateInputTools","tools","_AbstractChatCompletionRunner_instances","_AbstractChatCompletionRunner_getFinalContent","_AbstractChatCompletionRunner_getFinalMessage","_AbstractChatCompletionRunner_getFinalFunctionCall","_AbstractChatCompletionRunner_getFinalFunctionCallResult","_AbstractChatCompletionRunner_calculateTotalUsage","_AbstractChatCompletionRunner_validateParams","_AbstractChatCompletionRunner_stringifyFunctionCallResult","DEFAULT_MAX_CHAT_COMPLETIONS","AbstractChatCompletionRunner","chatCompletion","emit","tool_call","finalMessage","finalContent","finalFunctionCall","finalFunctionCallResult","role","function_call","restParams","singleFunctionToCall","maxChatCompletions","functionsByName","functions","parsed","rawContent","tool_choice","inputTools","t","tool_call_id","rest","ret","y","total","usage","ChatCompletionRunner","runner","STR","NUM","ARR","OBJ","NULL","BOOL","NAN","INFINITY","MINUS_INFINITY","INF","SPECIAL","ATOM","COLLECTION","ALL","Allow","PartialJSON","MalformedJSON","parseJSON","jsonString","allowPartial","_parseJSON","allow","length","markPartialJSON","throwMalformedError","parseAny","skipBlank","parseStr","parseObj","parseArr","parseNum","start","escape","partialParse","input","_ChatCompletionStream_instances","_ChatCompletionStream_params","_ChatCompletionStream_choiceEventStates","_ChatCompletionStream_currentChatCompletionSnapshot","_ChatCompletionStream_beginRequest","_ChatCompletionStream_getChoiceEventState","_ChatCompletionStream_addChunk","_ChatCompletionStream_emitToolCallDoneEvent","_ChatCompletionStream_emitContentDoneEvents","_ChatCompletionStream_endRequest","_ChatCompletionStream_getAutoParseableResponseFormat","_ChatCompletionStream_accumulateChatCompletion","ChatCompletionStream","chatId","choiceSnapshot","_e","_f","_g","_h","_i","_j","_l","toolCallDelta","toolCallSnapshot","_n","_o","toolCallIndex","responseFormat","snapshot","finalizeChatCompletion","delta","finish_reason","logprobs","other","refusal","tool_calls","pushQueue","readQueue","created","model","system_fingerprint","choiceRest","messageRest","toolRest","fnRest","ChatCompletionStreamingRunner","_AssistantStream_instances","_AssistantStream_events","_AssistantStream_runStepSnapshots","_AssistantStream_messageSnapshots","_AssistantStream_messageSnapshot","_AssistantStream_finalRun","_AssistantStream_currentContentIndex","_AssistantStream_currentContent","_AssistantStream_currentToolCallIndex","_AssistantStream_currentToolCall","_AssistantStream_currentEvent","_AssistantStream_currentRunSnapshot","_AssistantStream_currentRunStepSnapshot","_AssistantStream_addEvent","_AssistantStream_endRequest","_AssistantStream_handleMessage","_AssistantStream_handleRunStep","_AssistantStream_handleEvent","_AssistantStream_accumulateRunStep","_AssistantStream_accumulateMessage","_AssistantStream_accumulateContent","_AssistantStream_handleRun","AssistantStream","threadId","runId","runs","run","thread","acc","deltaValue","accValue","Core.isObj","deltaEntry","accEntry","accumulatedMessage","newContent","snapshotContent","textDelta","currentContent","accumulatedRunStep","accumulated","contentElement","Messages","messageId","MessagesPage","Steps","stepId","RunStepsPage","Runs","StepsAPI.Steps","include","RunsPage","sleepInterval","headerInterval","headerIntervalMs","Threads","RunsAPI.Runs","MessagesAPI.Messages","allSettledWithThrow","promises","results","rejected","vectorStoreId","fileId","VectorStoreFilesPage","fileResponse","fileInfo","Files","FileBatches","batch","files","fileIds","configuredConcurrency","concurrencyLimit","fileIterator","allFileIds","processFiles","fileObj","workers","VectorStores","FilesAPI.Files","FileBatchesAPI.FileBatches","VectorStoresPage","Beta","VectorStoresAPI.VectorStores","ChatAPI.Chat","AssistantsAPI.Assistants","ThreadsAPI.Threads","Embeddings","FileObjectsPage","pollInterval","maxWait","TERMINAL_STATES","Checkpoints","fineTuningJobId","FineTuningJobCheckpointsPage","Jobs","CheckpointsAPI.Checkpoints","FineTuningJobsPage","FineTuningJobEventsPage","FineTuning","JobsAPI.Jobs","Images","Models","ModelsPage","Moderations","Parts","uploadId","Uploads","PartsAPI.Parts","OpenAI","Core.APIClient","Core.readEnv","apiKey","organization","project","Errors.OpenAIError","Core.isRunningInBrowser","API.Completions","API.Chat","API.Embeddings","API.Files","API.Images","API.Audio","API.Moderations","API.Models","API.FineTuning","API.Beta","API.Batches","API.Uploads","qs.stringify","Errors.APIError","Errors.APIConnectionError","Errors.APIConnectionTimeoutError","Errors.APIUserAbortError","Errors.NotFoundError","Errors.ConflictError","Errors.RateLimitError","Errors.BadRequestError","Errors.AuthenticationError","Errors.InternalServerError","Errors.PermissionDeniedError","Errors.UnprocessableEntityError","Uploads.toFile","Uploads.fileFromPath","UploadsAPIUploads","API_BASE_URL","fetchFromAPI","endpoint","suggestionsCache","CACHE_DURATION","getSearchSuggestions","cached","suggestions","generateFallbackSuggestions","SearchSuggestions","onSelect","visible","suggestion","useDebounce","delay","debouncedValue","setDebouncedValue","handler","SearchHeroComponent","navigate","useNavigate","setQuery","setSuggestions","showSuggestions","setShowSuggestions","backgroundImage","setBackgroundImage","debouncedQuery","fetchSuggestions","handleSearch","handleSuggestionSelect","Search","SearchHero","LoadingSpinner","Loader2","FeaturedDestinations","React","__vitePreload","mod","HomePage","Fragment","Suspense","searchCache","API_URL","getSearchResults","dest","getIconForRecommendationType","iconMap","Camera","Utensils","Hotel","Compass","Music","Coffee","Wine","ShoppingBag","Ticket","RelatedQueries","baseQuery","handleQueryClick","ArrowRight","SearchResultContent","isLoading","followUpResults","setFollowUpResults","section","highlight","Star","Info","Calendar","Thermometer","Coins","Languages","rec","TravelTip","tip","author","Lightbulb","travelTips","TravelTipsCarousel","currentTipIndex","setCurrentTipIndex","isTransitioning","setIsTransitioning","interval","currentTip","LoadingPage","progress","setProgress","fastProgress","slowProgress","finalProgress","Plane","SearchResultsPage","searchParams","useSearchParams","setIsLoading","searchResults","setSearchResults","fetchResults","AuthForm","mode","setEmail","setPassword","loading","setLoading","signIn","signUp","handleSubmit","LoginPage","RegisterPage","App","Routes","Route","queryClient","QueryClient","container","root","QueryClientProvider","BrowserRouter","Toaster"],"ignoreList":[0,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70],"sources":["../../node_modules/react-dom/client.js","../../src/utils/supabase.ts","../../src/hooks/useAuth.tsx","../../src/components/layout/Logo.tsx","../../src/utils/constants.ts","../../src/components/layout/Navigation.tsx","../../src/components/layout/MobileMenu.tsx","../../src/components/auth/AuthButtons.tsx","../../src/components/layout/Header.tsx","../../src/components/layout/Footer.tsx","../../src/components/layout/Layout.tsx","../../src/components/ui/Image.tsx","../../src/data/images.ts","../../src/data/destinations.ts","../../src/utils/images.ts","../../node_modules/openai/internal/qs/formats.mjs","../../node_modules/openai/internal/qs/utils.mjs","../../node_modules/openai/internal/qs/stringify.mjs","../../node_modules/openai/version.mjs","../../node_modules/openai/_shims/registry.mjs","../../node_modules/openai/_shims/MultipartBody.mjs","../../node_modules/openai/_shims/web-runtime.mjs","../../node_modules/openai/_shims/index.mjs","../../node_modules/openai/error.mjs","../../node_modules/openai/internal/decoders/line.mjs","../../node_modules/openai/streaming.mjs","../../node_modules/openai/uploads.mjs","../../node_modules/openai/core.mjs","../../node_modules/openai/pagination.mjs","../../node_modules/openai/resource.mjs","../../node_modules/openai/resources/chat/completions.mjs","../../node_modules/openai/resources/chat/chat.mjs","../../node_modules/openai/resources/audio/speech.mjs","../../node_modules/openai/resources/audio/transcriptions.mjs","../../node_modules/openai/resources/audio/translations.mjs","../../node_modules/openai/resources/audio/audio.mjs","../../node_modules/openai/resources/batches.mjs","../../node_modules/openai/resources/beta/assistants.mjs","../../node_modules/openai/lib/RunnableFunction.mjs","../../node_modules/openai/lib/chatCompletionUtils.mjs","../../node_modules/openai/lib/EventStream.mjs","../../node_modules/openai/lib/parser.mjs","../../node_modules/openai/lib/AbstractChatCompletionRunner.mjs","../../node_modules/openai/lib/ChatCompletionRunner.mjs","../../node_modules/openai/_vendor/partial-json-parser/parser.mjs","../../node_modules/openai/lib/ChatCompletionStream.mjs","../../node_modules/openai/lib/ChatCompletionStreamingRunner.mjs","../../node_modules/openai/resources/beta/chat/completions.mjs","../../node_modules/openai/resources/beta/chat/chat.mjs","../../node_modules/openai/lib/AssistantStream.mjs","../../node_modules/openai/resources/beta/threads/messages.mjs","../../node_modules/openai/resources/beta/threads/runs/steps.mjs","../../node_modules/openai/resources/beta/threads/runs/runs.mjs","../../node_modules/openai/resources/beta/threads/threads.mjs","../../node_modules/openai/lib/Util.mjs","../../node_modules/openai/resources/beta/vector-stores/files.mjs","../../node_modules/openai/resources/beta/vector-stores/file-batches.mjs","../../node_modules/openai/resources/beta/vector-stores/vector-stores.mjs","../../node_modules/openai/resources/beta/beta.mjs","../../node_modules/openai/resources/completions.mjs","../../node_modules/openai/resources/embeddings.mjs","../../node_modules/openai/resources/files.mjs","../../node_modules/openai/resources/fine-tuning/jobs/checkpoints.mjs","../../node_modules/openai/resources/fine-tuning/jobs/jobs.mjs","../../node_modules/openai/resources/fine-tuning/fine-tuning.mjs","../../node_modules/openai/resources/images.mjs","../../node_modules/openai/resources/models.mjs","../../node_modules/openai/resources/moderations.mjs","../../node_modules/openai/resources/uploads/parts.mjs","../../node_modules/openai/resources/uploads/uploads.mjs","../../node_modules/openai/index.mjs","../../src/utils/openai.ts","../../src/utils/api.ts","../../src/utils/suggestions.ts","../../src/components/search/SearchSuggestions.tsx","../../src/hooks/useDebounce.ts","../../src/components/search/SearchHero.tsx","../../src/components/ui/LoadingSpinner.tsx","../../src/pages/HomePage.tsx","../../src/utils/search.ts","../../src/utils/icons.ts","../../src/components/search/RelatedQueries.tsx","../../src/components/search/SearchResultContent.tsx","../../src/components/loading/TravelTip.tsx","../../src/data/tips.ts","../../src/components/loading/TravelTipsCarousel.tsx","../../src/components/loading/LoadingPage.tsx","../../src/pages/SearchResultsPage.tsx","../../src/components/auth/AuthForm.tsx","../../src/pages/LoginPage.tsx","../../src/pages/RegisterPage.tsx","../../src/App.tsx","../../src/main.tsx"],"sourcesContent":["'use strict';\n\nvar m = require('react-dom');\nif (process.env.NODE_ENV === 'production') {\n  exports.createRoot = m.createRoot;\n  exports.hydrateRoot = m.hydrateRoot;\n} else {\n  var i = m.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;\n  exports.createRoot = function(c, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.createRoot(c, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n  exports.hydrateRoot = function(c, h, o) {\n    i.usingClientEntryPoint = true;\n    try {\n      return m.hydrateRoot(c, h, o);\n    } finally {\n      i.usingClientEntryPoint = false;\n    }\n  };\n}\n","import { createClient } from '@supabase/supabase-js';\n\n// For demo purposes, we'll use mock authentication\nconst mockAuth = {\n  user: null,\n  async signIn() { return { error: null }; },\n  async signUp() { return { error: null }; },\n  async signOut() { return { error: null }; },\n  onAuthStateChange() {\n    return {\n      data: {\n        subscription: {\n          unsubscribe: () => {}\n        }\n      }\n    };\n  },\n  async getSession() {\n    return { data: { session: null } };\n  }\n};\n\nexport const supabase = {\n  auth: mockAuth\n};","import React, { useState, useEffect, createContext, useContext, ReactNode } from 'react';\nimport { supabase } from '../utils/supabase';\nimport toast from 'react-hot-toast';\n\ninterface User {\n  id: string;\n  email: string;\n}\n\ninterface AuthContextType {\n  user: User | null;\n  signIn: (email: string, password: string) => Promise<void>;\n  signUp: (email: string, password: string) => Promise<void>;\n  signOut: () => Promise<void>;\n}\n\nconst AuthContext = createContext<AuthContextType>({\n  user: null,\n  signIn: async () => {},\n  signUp: async () => {},\n  signOut: async () => {},\n});\n\nexport function useAuth() {\n  const context = useContext(AuthContext);\n  if (context === undefined) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}\n\ninterface AuthProviderProps {\n  children: ReactNode;\n}\n\nexport function AuthProvider({ children }: AuthProviderProps) {\n  const [user, setUser] = useState<User | null>(null);\n\n  useEffect(() => {\n    // Check active sessions and sets the user\n    supabase.auth.getSession().then(({ data: { session } }) => {\n      if (session?.user?.email) {\n        setUser({\n          id: session.user.id,\n          email: session.user.email,\n        });\n      }\n    });\n\n    // Listen for changes on auth state\n    const { data: { subscription } } = supabase.auth.onAuthStateChange((_event, session) => {\n      if (session?.user?.email) {\n        setUser({\n          id: session.user.id,\n          email: session.user.email,\n        });\n      } else {\n        setUser(null);\n      }\n    });\n\n    return () => subscription.unsubscribe();\n  }, []);\n\n  const signIn = async (email: string, password: string) => {\n    try {\n      const { error } = await supabase.auth.signIn({ email, password });\n      if (error) throw error;\n      toast.success('Welcome back!');\n    } catch (error) {\n      toast.error('Failed to sign in. Please check your credentials.');\n      throw error;\n    }\n  };\n\n  const signUp = async (email: string, password: string) => {\n    try {\n      const { error } = await supabase.auth.signUp({ email, password });\n      if (error) throw error;\n      toast.success('Welcome! Please check your email to verify your account.');\n    } catch (error) {\n      toast.error('Failed to create account. Please try again.');\n      throw error;\n    }\n  };\n\n  const signOut = async () => {\n    try {\n      const { error } = await supabase.auth.signOut();\n      if (error) throw error;\n      toast.success('Successfully signed out');\n    } catch (error) {\n      toast.error('Failed to sign out');\n      throw error;\n    }\n  };\n\n  const value = { user, signIn, signUp, signOut };\n\n  return (\n    <AuthContext.Provider value={value}>\n      {children}\n    </AuthContext.Provider>\n  );\n}","import React from 'react';\nimport { Link } from 'react-router-dom';\n\nexport function Logo() {\n  return (\n    <Link to=\"/\" className=\"group\">\n      <h1 className=\"text-2xl font-bold tracking-tight\">\n        <span className=\"bg-gradient-to-r from-blue-600 via-purple-600 to-pink-600 \n                       bg-clip-text text-transparent \n                       group-hover:from-blue-500 group-hover:via-purple-500 group-hover:to-pink-500 \n                       transition-all duration-300\">\n          onjourney\n        </span>\n      </h1>\n    </Link>\n  );\n}","// Shared constants to avoid duplication\nexport const NAV_ITEMS = [\n  { href: '#destinations', label: 'Destinations' },\n  { href: '#itineraries', label: 'Itineraries' },\n  { href: '#chat', label: 'AI Assistant' },\n  { href: '#about', label: 'About' },\n  { href: '#contact', label: 'Contact' },\n] as const;\n\nexport const SOCIAL_LINKS = [\n  { href: '#', label: 'Facebook' },\n  { href: '#', label: 'Twitter' },\n  { href: '#', label: 'Instagram' },\n  { href: '#', label: 'YouTube' },\n] as const;\n\nexport const CONTACT_INFO = [\n  { text: 'contact@aitravel.com' },\n  { text: '+1 (555) 123-4567' },\n  { text: 'New York, NY 10001' },\n] as const;","import React, { memo } from 'react';\nimport { NAV_ITEMS } from '../../utils/constants';\n\nfunction NavigationComponent() {\n  return (\n    <nav className=\"hidden md:flex space-x-6\">\n      {NAV_ITEMS.map((item) => (\n        <a\n          key={item.href}\n          href={item.href}\n          className=\"text-gray-600 hover:text-blue-600 transition-colors\"\n        >\n          {item.label}\n        </a>\n      ))}\n    </nav>\n  );\n}\n\nexport const Navigation = memo(NavigationComponent);","import React, { memo, useState, useCallback } from 'react';\nimport { Menu, X } from 'lucide-react';\nimport { NAV_ITEMS } from '../../utils/constants';\n\nfunction MobileMenuComponent() {\n  const [isOpen, setIsOpen] = useState(false);\n\n  const toggleMenu = useCallback(() => {\n    setIsOpen(prev => !prev);\n  }, []);\n\n  const handleItemClick = useCallback(() => {\n    setIsOpen(false);\n  }, []);\n\n  return (\n    <div className=\"md:hidden\">\n      <button\n        onClick={toggleMenu}\n        className=\"text-gray-600 hover:text-blue-600 focus:outline-none\"\n        aria-label={isOpen ? 'Close menu' : 'Open menu'}\n      >\n        {isOpen ? <X className=\"h-6 w-6\" /> : <Menu className=\"h-6 w-6\" />}\n      </button>\n\n      {isOpen && (\n        <div className=\"absolute top-16 left-0 right-0 bg-white shadow-lg border-t\">\n          <div className=\"px-4 py-2\">\n            {NAV_ITEMS.map((item) => (\n              <a\n                key={item.href}\n                href={item.href}\n                className=\"block py-2 text-gray-600 hover:text-blue-600\"\n                onClick={handleItemClick}\n              >\n                {item.label}\n              </a>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n\nexport const MobileMenu = memo(MobileMenuComponent);","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { UserCircle } from 'lucide-react';\nimport { useAuth } from '../../hooks/useAuth';\n\nexport function AuthButtons() {\n  const { user, signOut } = useAuth();\n\n  if (user) {\n    return (\n      <div className=\"flex items-center space-x-4\">\n        <div className=\"flex items-center space-x-2\">\n          <UserCircle className=\"h-6 w-6 text-gray-600\" />\n          <span className=\"text-gray-700\">{user.email}</span>\n        </div>\n        <button\n          onClick={signOut}\n          className=\"text-gray-600 hover:text-blue-600 transition-colors\"\n        >\n          Sign Out\n        </button>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"flex items-center space-x-4\">\n      <Link\n        to=\"/login\"\n        className=\"text-gray-600 hover:text-blue-600 transition-colors\"\n      >\n        Log In\n      </Link>\n      <Link\n        to=\"/register\"\n        className=\"px-4 py-2 rounded-full bg-blue-600 text-white hover:bg-blue-700 \n                 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 \n                 focus:ring-offset-2\"\n      >\n        Sign Up\n      </Link>\n    </div>\n  );\n}","import React from 'react';\nimport { Logo } from './Logo';\nimport { Navigation } from './Navigation';\nimport { MobileMenu } from './MobileMenu';\nimport { AuthButtons } from '../auth/AuthButtons';\n\nexport function Header() {\n  return (\n    <header className=\"fixed w-full bg-white shadow-sm z-50\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4\">\n        <div className=\"flex items-center justify-between\">\n          <Logo />\n          <Navigation />\n          <div className=\"hidden md:block\">\n            <AuthButtons />\n          </div>\n          <MobileMenu />\n        </div>\n      </div>\n    </header>\n  );\n}","import React from 'react';\nimport { Logo } from './Logo';\nimport { \n  Facebook, \n  Twitter, \n  Instagram, \n  Youtube,\n  Mail,\n  Phone,\n  MapPin\n} from 'lucide-react';\n\nconst socialLinks = [\n  { icon: Facebook, href: '#', label: 'Facebook' },\n  { icon: Twitter, href: '#', label: 'Twitter' },\n  { icon: Instagram, href: '#', label: 'Instagram' },\n  { icon: Youtube, href: '#', label: 'YouTube' },\n];\n\nconst contactInfo = [\n  { icon: Mail, text: 'contact@aitravel.com' },\n  { icon: Phone, text: '+1 (555) 123-4567' },\n  { icon: MapPin, text: 'New York, NY 10001' },\n];\n\nexport function Footer() {\n  return (\n    <footer className=\"bg-gray-900 text-white\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12\">\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-8\">\n          {/* Brand Section */}\n          <div className=\"space-y-4\">\n            <div className=\"flex items-center space-x-2 text-white\">\n              <Logo />\n            </div>\n            <p className=\"text-gray-400\">\n              Your AI-powered travel companion for discovering amazing destinations worldwide.\n            </p>\n          </div>\n\n          {/* Quick Links */}\n          <div>\n            <h3 className=\"text-lg font-semibold mb-4\">Quick Links</h3>\n            <ul className=\"space-y-2\">\n              <li><a href=\"#about\" className=\"text-gray-400 hover:text-white\">About Us</a></li>\n              <li><a href=\"#destinations\" className=\"text-gray-400 hover:text-white\">Destinations</a></li>\n              <li><a href=\"#blog\" className=\"text-gray-400 hover:text-white\">Travel Blog</a></li>\n              <li><a href=\"#faq\" className=\"text-gray-400 hover:text-white\">FAQs</a></li>\n            </ul>\n          </div>\n\n          {/* Contact Info */}\n          <div>\n            <h3 className=\"text-lg font-semibold mb-4\">Contact Us</h3>\n            <ul className=\"space-y-2\">\n              {contactInfo.map(({ icon: Icon, text }) => (\n                <li key={text} className=\"flex items-center space-x-2 text-gray-400\">\n                  <Icon className=\"h-5 w-5\" />\n                  <span>{text}</span>\n                </li>\n              ))}\n            </ul>\n          </div>\n\n          {/* Social Links */}\n          <div>\n            <h3 className=\"text-lg font-semibold mb-4\">Follow Us</h3>\n            <div className=\"flex space-x-4\">\n              {socialLinks.map(({ icon: Icon, href, label }) => (\n                <a\n                  key={label}\n                  href={href}\n                  className=\"text-gray-400 hover:text-white transition-colors\"\n                  aria-label={label}\n                >\n                  <Icon className=\"h-6 w-6\" />\n                </a>\n              ))}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"mt-12 pt-8 border-t border-gray-800 text-center text-gray-400\">\n          <p>&copy; {new Date().getFullYear()} AI Travel. All rights reserved.</p>\n        </div>\n      </div>\n    </footer>\n  );\n}","import React from 'react';\nimport { Header } from './Header';\nimport { Footer } from './Footer';\n\ninterface LayoutProps {\n  children: React.ReactNode;\n}\n\nexport function Layout({ children }: LayoutProps) {\n  return (\n    <div className=\"min-h-screen flex flex-col\">\n      <Header />\n      <main className=\"flex-grow\">{children}</main>\n      <Footer />\n    </div>\n  );\n}","import React, { useState } from 'react';\n\ninterface ImageProps extends React.ImgHTMLAttributes<HTMLImageElement> {\n  src: string;\n  alt: string;\n  className?: string;\n}\n\nexport function Image({ src, alt, className = '', ...props }: ImageProps) {\n  const [error, setError] = useState(false);\n  const fallbackSrc = 'https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?auto=format&fit=crop&w=1920&q=75';\n\n  return (\n    <img\n      src={error ? fallbackSrc : src}\n      alt={alt}\n      className={className}\n      loading=\"lazy\"\n      decoding=\"async\"\n      onError={() => setError(true)}\n      {...props}\n    />\n  );\n}","export const backgroundImages = [\n  'https://images.unsplash.com/photo-1469854523086-cc02fe5d8800?auto=format&fit=crop&w=1920&q=75',\n  'https://images.unsplash.com/photo-1476514525535-07fb3b4ae5f1?auto=format&fit=crop&w=1920&q=75',\n  'https://images.unsplash.com/photo-1488646953014-85cb44e25828?auto=format&fit=crop&w=1920&q=75',\n  'https://images.unsplash.com/photo-1501785888041-af3ef285b470?auto=format&fit=crop&w=1920&q=75'\n];","import type { Destination } from '../types/destination';\n\nexport const destinations: Destination[] = [\n  {\n    id: 'paris',\n    name: 'Paris, France',\n    title: 'Paris: City of Light and Romance',\n    subtitle: 'Discover the magic of France\\'s iconic capital',\n    image: 'https://images.unsplash.com/photo-1502602898657-3e91760cbb34?auto=format&fit=crop&w=1920&q=75',\n    description: 'Experience the perfect blend of history, culture, and modern life',\n    sections: [\n      {\n        title: 'Cultural Heritage',\n        content: 'Paris is home to some of the world\\'s most famous museums and monuments.',\n        image: 'https://images.unsplash.com/photo-1543349689-9a4d426bee8e?auto=format&fit=crop&w=1920&q=75',\n        highlights: [\n          'Visit the iconic Louvre Museum',\n          'Explore Muse d\\'Orsay',\n          'Discover Notre-Dame Cathedral'\n        ]\n      },\n      {\n        title: 'Culinary Excellence',\n        content: 'Experience world-renowned French cuisine and wine.',\n        image: 'https://images.unsplash.com/photo-1595295333158-4742f28fbd85?auto=format&fit=crop&w=1920&q=75',\n        highlights: [\n          'Traditional French bistros',\n          'Michelin-starred restaurants',\n          'Local food markets'\n        ]\n      }\n    ],\n    practicalInfo: {\n      bestTimeToVisit: 'Spring (April-June) or Fall (September-November)',\n      climate: 'Temperate with mild summers and cool winters',\n      currency: 'Euro ()',\n      language: 'French'\n    },\n    recommendations: [\n      {\n        title: 'Eiffel Tower',\n        description: 'Visit at sunset for breathtaking views',\n        type: 'attraction'\n      },\n      {\n        title: 'Le Marais',\n        description: 'Historic district with boutiques and cafes',\n        type: 'location'\n      }\n    ]\n  },\n  {\n    id: 'tokyo',\n    name: 'Tokyo, Japan',\n    title: 'Tokyo: Where Tradition Meets Innovation',\n    subtitle: 'Experience Japan\\'s dynamic capital city',\n    image: 'https://images.unsplash.com/photo-1540959733332-eab4deabeeaf?auto=format&fit=crop&w=1920&q=75',\n    description: 'A fascinating blend of ultramodern and traditional',\n    sections: [\n      {\n        title: 'Modern Marvels',\n        content: 'Experience cutting-edge technology and architecture.',\n        image: 'https://images.unsplash.com/photo-1503899036084-c55cdd92da26?auto=format&fit=crop&w=1920&q=75',\n        highlights: [\n          'Shibuya Crossing',\n          'Akihabara Electronics',\n          'Tokyo Skytree'\n        ]\n      },\n      {\n        title: 'Traditional Japan',\n        content: 'Discover ancient temples and traditional gardens.',\n        image: 'https://images.unsplash.com/photo-1528360983277-13d401cdc186?auto=format&fit=crop&w=1920&q=75',\n        highlights: [\n          'Senso-ji Temple',\n          'Meiji Shrine',\n          'Imperial Palace'\n        ]\n      }\n    ],\n    practicalInfo: {\n      bestTimeToVisit: 'Spring (March-May) or Fall (September-November)',\n      climate: 'Four distinct seasons with humid summers',\n      currency: 'Japanese Yen ()',\n      language: 'Japanese'\n    },\n    recommendations: [\n      {\n        title: 'Tsukiji Outer Market',\n        description: 'Famous for fresh seafood and street food',\n        type: 'food'\n      },\n      {\n        title: 'Shinjuku Gyoen',\n        description: 'Beautiful park perfect for cherry blossom viewing',\n        type: 'nature'\n      }\n    ]\n  }\n];","import { backgroundImages } from '../data/images';\nimport { destinations } from '../data/destinations';\n\nexport function getRandomTravelImage(): string {\n  return backgroundImages[Math.floor(Math.random() * backgroundImages.length)];\n}\n\nexport function getDestinationImage(query: string): string {\n  const destination = destinations.find(dest => \n    dest.name.toLowerCase().includes(query.toLowerCase())\n  );\n  \n  return destination?.image || backgroundImages[0];\n}","export const default_format = 'RFC3986';\nexport const formatters = {\n    RFC1738: (v) => String(v).replace(/%20/g, '+'),\n    RFC3986: (v) => String(v),\n};\nexport const RFC1738 = 'RFC1738';\nexport const RFC3986 = 'RFC3986';\n//# sourceMappingURL=formats.mjs.map","import { RFC1738 } from \"./formats.mjs\";\nconst has = Object.prototype.hasOwnProperty;\nconst is_array = Array.isArray;\nconst hex_table = (() => {\n    const array = [];\n    for (let i = 0; i < 256; ++i) {\n        array.push('%' + ((i < 16 ? '0' : '') + i.toString(16)).toUpperCase());\n    }\n    return array;\n})();\nfunction compact_queue(queue) {\n    while (queue.length > 1) {\n        const item = queue.pop();\n        if (!item)\n            continue;\n        const obj = item.obj[item.prop];\n        if (is_array(obj)) {\n            const compacted = [];\n            for (let j = 0; j < obj.length; ++j) {\n                if (typeof obj[j] !== 'undefined') {\n                    compacted.push(obj[j]);\n                }\n            }\n            // @ts-ignore\n            item.obj[item.prop] = compacted;\n        }\n    }\n}\nfunction array_to_object(source, options) {\n    const obj = options && options.plainObjects ? Object.create(null) : {};\n    for (let i = 0; i < source.length; ++i) {\n        if (typeof source[i] !== 'undefined') {\n            obj[i] = source[i];\n        }\n    }\n    return obj;\n}\nexport function merge(target, source, options = {}) {\n    if (!source) {\n        return target;\n    }\n    if (typeof source !== 'object') {\n        if (is_array(target)) {\n            target.push(source);\n        }\n        else if (target && typeof target === 'object') {\n            if ((options && (options.plainObjects || options.allowPrototypes)) ||\n                !has.call(Object.prototype, source)) {\n                target[source] = true;\n            }\n        }\n        else {\n            return [target, source];\n        }\n        return target;\n    }\n    if (!target || typeof target !== 'object') {\n        return [target].concat(source);\n    }\n    let mergeTarget = target;\n    if (is_array(target) && !is_array(source)) {\n        // @ts-ignore\n        mergeTarget = array_to_object(target, options);\n    }\n    if (is_array(target) && is_array(source)) {\n        source.forEach(function (item, i) {\n            if (has.call(target, i)) {\n                const targetItem = target[i];\n                if (targetItem && typeof targetItem === 'object' && item && typeof item === 'object') {\n                    target[i] = merge(targetItem, item, options);\n                }\n                else {\n                    target.push(item);\n                }\n            }\n            else {\n                target[i] = item;\n            }\n        });\n        return target;\n    }\n    return Object.keys(source).reduce(function (acc, key) {\n        const value = source[key];\n        if (has.call(acc, key)) {\n            acc[key] = merge(acc[key], value, options);\n        }\n        else {\n            acc[key] = value;\n        }\n        return acc;\n    }, mergeTarget);\n}\nexport function assign_single_source(target, source) {\n    return Object.keys(source).reduce(function (acc, key) {\n        acc[key] = source[key];\n        return acc;\n    }, target);\n}\nexport function decode(str, _, charset) {\n    const strWithoutPlus = str.replace(/\\+/g, ' ');\n    if (charset === 'iso-8859-1') {\n        // unescape never throws, no try...catch needed:\n        return strWithoutPlus.replace(/%[0-9a-f]{2}/gi, unescape);\n    }\n    // utf-8\n    try {\n        return decodeURIComponent(strWithoutPlus);\n    }\n    catch (e) {\n        return strWithoutPlus;\n    }\n}\nconst limit = 1024;\nexport const encode = (str, _defaultEncoder, charset, _kind, format) => {\n    // This code was originally written by Brian White for the io.js core querystring library.\n    // It has been adapted here for stricter adherence to RFC 3986\n    if (str.length === 0) {\n        return str;\n    }\n    let string = str;\n    if (typeof str === 'symbol') {\n        string = Symbol.prototype.toString.call(str);\n    }\n    else if (typeof str !== 'string') {\n        string = String(str);\n    }\n    if (charset === 'iso-8859-1') {\n        return escape(string).replace(/%u[0-9a-f]{4}/gi, function ($0) {\n            return '%26%23' + parseInt($0.slice(2), 16) + '%3B';\n        });\n    }\n    let out = '';\n    for (let j = 0; j < string.length; j += limit) {\n        const segment = string.length >= limit ? string.slice(j, j + limit) : string;\n        const arr = [];\n        for (let i = 0; i < segment.length; ++i) {\n            let c = segment.charCodeAt(i);\n            if (c === 0x2d || // -\n                c === 0x2e || // .\n                c === 0x5f || // _\n                c === 0x7e || // ~\n                (c >= 0x30 && c <= 0x39) || // 0-9\n                (c >= 0x41 && c <= 0x5a) || // a-z\n                (c >= 0x61 && c <= 0x7a) || // A-Z\n                (format === RFC1738 && (c === 0x28 || c === 0x29)) // ( )\n            ) {\n                arr[arr.length] = segment.charAt(i);\n                continue;\n            }\n            if (c < 0x80) {\n                arr[arr.length] = hex_table[c];\n                continue;\n            }\n            if (c < 0x800) {\n                arr[arr.length] = hex_table[0xc0 | (c >> 6)] + hex_table[0x80 | (c & 0x3f)];\n                continue;\n            }\n            if (c < 0xd800 || c >= 0xe000) {\n                arr[arr.length] =\n                    hex_table[0xe0 | (c >> 12)] + hex_table[0x80 | ((c >> 6) & 0x3f)] + hex_table[0x80 | (c & 0x3f)];\n                continue;\n            }\n            i += 1;\n            c = 0x10000 + (((c & 0x3ff) << 10) | (segment.charCodeAt(i) & 0x3ff));\n            arr[arr.length] =\n                hex_table[0xf0 | (c >> 18)] +\n                    hex_table[0x80 | ((c >> 12) & 0x3f)] +\n                    hex_table[0x80 | ((c >> 6) & 0x3f)] +\n                    hex_table[0x80 | (c & 0x3f)];\n        }\n        out += arr.join('');\n    }\n    return out;\n};\nexport function compact(value) {\n    const queue = [{ obj: { o: value }, prop: 'o' }];\n    const refs = [];\n    for (let i = 0; i < queue.length; ++i) {\n        const item = queue[i];\n        // @ts-ignore\n        const obj = item.obj[item.prop];\n        const keys = Object.keys(obj);\n        for (let j = 0; j < keys.length; ++j) {\n            const key = keys[j];\n            const val = obj[key];\n            if (typeof val === 'object' && val !== null && refs.indexOf(val) === -1) {\n                queue.push({ obj: obj, prop: key });\n                refs.push(val);\n            }\n        }\n    }\n    compact_queue(queue);\n    return value;\n}\nexport function is_regexp(obj) {\n    return Object.prototype.toString.call(obj) === '[object RegExp]';\n}\nexport function is_buffer(obj) {\n    if (!obj || typeof obj !== 'object') {\n        return false;\n    }\n    return !!(obj.constructor && obj.constructor.isBuffer && obj.constructor.isBuffer(obj));\n}\nexport function combine(a, b) {\n    return [].concat(a, b);\n}\nexport function maybe_map(val, fn) {\n    if (is_array(val)) {\n        const mapped = [];\n        for (let i = 0; i < val.length; i += 1) {\n            mapped.push(fn(val[i]));\n        }\n        return mapped;\n    }\n    return fn(val);\n}\n//# sourceMappingURL=utils.mjs.map","import { encode, is_buffer, maybe_map } from \"./utils.mjs\";\nimport { default_format, formatters } from \"./formats.mjs\";\nconst has = Object.prototype.hasOwnProperty;\nconst array_prefix_generators = {\n    brackets(prefix) {\n        return String(prefix) + '[]';\n    },\n    comma: 'comma',\n    indices(prefix, key) {\n        return String(prefix) + '[' + key + ']';\n    },\n    repeat(prefix) {\n        return String(prefix);\n    },\n};\nconst is_array = Array.isArray;\nconst push = Array.prototype.push;\nconst push_to_array = function (arr, value_or_array) {\n    push.apply(arr, is_array(value_or_array) ? value_or_array : [value_or_array]);\n};\nconst to_ISO = Date.prototype.toISOString;\nconst defaults = {\n    addQueryPrefix: false,\n    allowDots: false,\n    allowEmptyArrays: false,\n    arrayFormat: 'indices',\n    charset: 'utf-8',\n    charsetSentinel: false,\n    delimiter: '&',\n    encode: true,\n    encodeDotInKeys: false,\n    encoder: encode,\n    encodeValuesOnly: false,\n    format: default_format,\n    formatter: formatters[default_format],\n    /** @deprecated */\n    indices: false,\n    serializeDate(date) {\n        return to_ISO.call(date);\n    },\n    skipNulls: false,\n    strictNullHandling: false,\n};\nfunction is_non_nullish_primitive(v) {\n    return (typeof v === 'string' ||\n        typeof v === 'number' ||\n        typeof v === 'boolean' ||\n        typeof v === 'symbol' ||\n        typeof v === 'bigint');\n}\nconst sentinel = {};\nfunction inner_stringify(object, prefix, generateArrayPrefix, commaRoundTrip, allowEmptyArrays, strictNullHandling, skipNulls, encodeDotInKeys, encoder, filter, sort, allowDots, serializeDate, format, formatter, encodeValuesOnly, charset, sideChannel) {\n    let obj = object;\n    let tmp_sc = sideChannel;\n    let step = 0;\n    let find_flag = false;\n    while ((tmp_sc = tmp_sc.get(sentinel)) !== void undefined && !find_flag) {\n        // Where object last appeared in the ref tree\n        const pos = tmp_sc.get(object);\n        step += 1;\n        if (typeof pos !== 'undefined') {\n            if (pos === step) {\n                throw new RangeError('Cyclic object value');\n            }\n            else {\n                find_flag = true; // Break while\n            }\n        }\n        if (typeof tmp_sc.get(sentinel) === 'undefined') {\n            step = 0;\n        }\n    }\n    if (typeof filter === 'function') {\n        obj = filter(prefix, obj);\n    }\n    else if (obj instanceof Date) {\n        obj = serializeDate?.(obj);\n    }\n    else if (generateArrayPrefix === 'comma' && is_array(obj)) {\n        obj = maybe_map(obj, function (value) {\n            if (value instanceof Date) {\n                return serializeDate?.(value);\n            }\n            return value;\n        });\n    }\n    if (obj === null) {\n        if (strictNullHandling) {\n            return encoder && !encodeValuesOnly ?\n                // @ts-expect-error\n                encoder(prefix, defaults.encoder, charset, 'key', format)\n                : prefix;\n        }\n        obj = '';\n    }\n    if (is_non_nullish_primitive(obj) || is_buffer(obj)) {\n        if (encoder) {\n            const key_value = encodeValuesOnly ? prefix\n                // @ts-expect-error\n                : encoder(prefix, defaults.encoder, charset, 'key', format);\n            return [\n                formatter?.(key_value) +\n                    '=' +\n                    // @ts-expect-error\n                    formatter?.(encoder(obj, defaults.encoder, charset, 'value', format)),\n            ];\n        }\n        return [formatter?.(prefix) + '=' + formatter?.(String(obj))];\n    }\n    const values = [];\n    if (typeof obj === 'undefined') {\n        return values;\n    }\n    let obj_keys;\n    if (generateArrayPrefix === 'comma' && is_array(obj)) {\n        // we need to join elements in\n        if (encodeValuesOnly && encoder) {\n            // @ts-expect-error values only\n            obj = maybe_map(obj, encoder);\n        }\n        obj_keys = [{ value: obj.length > 0 ? obj.join(',') || null : void undefined }];\n    }\n    else if (is_array(filter)) {\n        obj_keys = filter;\n    }\n    else {\n        const keys = Object.keys(obj);\n        obj_keys = sort ? keys.sort(sort) : keys;\n    }\n    const encoded_prefix = encodeDotInKeys ? String(prefix).replace(/\\./g, '%2E') : String(prefix);\n    const adjusted_prefix = commaRoundTrip && is_array(obj) && obj.length === 1 ? encoded_prefix + '[]' : encoded_prefix;\n    if (allowEmptyArrays && is_array(obj) && obj.length === 0) {\n        return adjusted_prefix + '[]';\n    }\n    for (let j = 0; j < obj_keys.length; ++j) {\n        const key = obj_keys[j];\n        const value = \n        // @ts-ignore\n        typeof key === 'object' && typeof key.value !== 'undefined' ? key.value : obj[key];\n        if (skipNulls && value === null) {\n            continue;\n        }\n        // @ts-ignore\n        const encoded_key = allowDots && encodeDotInKeys ? key.replace(/\\./g, '%2E') : key;\n        const key_prefix = is_array(obj) ?\n            typeof generateArrayPrefix === 'function' ?\n                generateArrayPrefix(adjusted_prefix, encoded_key)\n                : adjusted_prefix\n            : adjusted_prefix + (allowDots ? '.' + encoded_key : '[' + encoded_key + ']');\n        sideChannel.set(object, step);\n        const valueSideChannel = new WeakMap();\n        valueSideChannel.set(sentinel, sideChannel);\n        push_to_array(values, inner_stringify(value, key_prefix, generateArrayPrefix, commaRoundTrip, allowEmptyArrays, strictNullHandling, skipNulls, encodeDotInKeys, \n        // @ts-ignore\n        generateArrayPrefix === 'comma' && encodeValuesOnly && is_array(obj) ? null : encoder, filter, sort, allowDots, serializeDate, format, formatter, encodeValuesOnly, charset, valueSideChannel));\n    }\n    return values;\n}\nfunction normalize_stringify_options(opts = defaults) {\n    if (typeof opts.allowEmptyArrays !== 'undefined' && typeof opts.allowEmptyArrays !== 'boolean') {\n        throw new TypeError('`allowEmptyArrays` option can only be `true` or `false`, when provided');\n    }\n    if (typeof opts.encodeDotInKeys !== 'undefined' && typeof opts.encodeDotInKeys !== 'boolean') {\n        throw new TypeError('`encodeDotInKeys` option can only be `true` or `false`, when provided');\n    }\n    if (opts.encoder !== null && typeof opts.encoder !== 'undefined' && typeof opts.encoder !== 'function') {\n        throw new TypeError('Encoder has to be a function.');\n    }\n    const charset = opts.charset || defaults.charset;\n    if (typeof opts.charset !== 'undefined' && opts.charset !== 'utf-8' && opts.charset !== 'iso-8859-1') {\n        throw new TypeError('The charset option must be either utf-8, iso-8859-1, or undefined');\n    }\n    let format = default_format;\n    if (typeof opts.format !== 'undefined') {\n        if (!has.call(formatters, opts.format)) {\n            throw new TypeError('Unknown format option provided.');\n        }\n        format = opts.format;\n    }\n    const formatter = formatters[format];\n    let filter = defaults.filter;\n    if (typeof opts.filter === 'function' || is_array(opts.filter)) {\n        filter = opts.filter;\n    }\n    let arrayFormat;\n    if (opts.arrayFormat && opts.arrayFormat in array_prefix_generators) {\n        arrayFormat = opts.arrayFormat;\n    }\n    else if ('indices' in opts) {\n        arrayFormat = opts.indices ? 'indices' : 'repeat';\n    }\n    else {\n        arrayFormat = defaults.arrayFormat;\n    }\n    if ('commaRoundTrip' in opts && typeof opts.commaRoundTrip !== 'boolean') {\n        throw new TypeError('`commaRoundTrip` must be a boolean, or absent');\n    }\n    const allowDots = typeof opts.allowDots === 'undefined' ?\n        !!opts.encodeDotInKeys === true ?\n            true\n            : defaults.allowDots\n        : !!opts.allowDots;\n    return {\n        addQueryPrefix: typeof opts.addQueryPrefix === 'boolean' ? opts.addQueryPrefix : defaults.addQueryPrefix,\n        // @ts-ignore\n        allowDots: allowDots,\n        allowEmptyArrays: typeof opts.allowEmptyArrays === 'boolean' ? !!opts.allowEmptyArrays : defaults.allowEmptyArrays,\n        arrayFormat: arrayFormat,\n        charset: charset,\n        charsetSentinel: typeof opts.charsetSentinel === 'boolean' ? opts.charsetSentinel : defaults.charsetSentinel,\n        commaRoundTrip: !!opts.commaRoundTrip,\n        delimiter: typeof opts.delimiter === 'undefined' ? defaults.delimiter : opts.delimiter,\n        encode: typeof opts.encode === 'boolean' ? opts.encode : defaults.encode,\n        encodeDotInKeys: typeof opts.encodeDotInKeys === 'boolean' ? opts.encodeDotInKeys : defaults.encodeDotInKeys,\n        encoder: typeof opts.encoder === 'function' ? opts.encoder : defaults.encoder,\n        encodeValuesOnly: typeof opts.encodeValuesOnly === 'boolean' ? opts.encodeValuesOnly : defaults.encodeValuesOnly,\n        filter: filter,\n        format: format,\n        formatter: formatter,\n        serializeDate: typeof opts.serializeDate === 'function' ? opts.serializeDate : defaults.serializeDate,\n        skipNulls: typeof opts.skipNulls === 'boolean' ? opts.skipNulls : defaults.skipNulls,\n        // @ts-ignore\n        sort: typeof opts.sort === 'function' ? opts.sort : null,\n        strictNullHandling: typeof opts.strictNullHandling === 'boolean' ? opts.strictNullHandling : defaults.strictNullHandling,\n    };\n}\nexport function stringify(object, opts = {}) {\n    let obj = object;\n    const options = normalize_stringify_options(opts);\n    let obj_keys;\n    let filter;\n    if (typeof options.filter === 'function') {\n        filter = options.filter;\n        obj = filter('', obj);\n    }\n    else if (is_array(options.filter)) {\n        filter = options.filter;\n        obj_keys = filter;\n    }\n    const keys = [];\n    if (typeof obj !== 'object' || obj === null) {\n        return '';\n    }\n    const generateArrayPrefix = array_prefix_generators[options.arrayFormat];\n    const commaRoundTrip = generateArrayPrefix === 'comma' && options.commaRoundTrip;\n    if (!obj_keys) {\n        obj_keys = Object.keys(obj);\n    }\n    if (options.sort) {\n        obj_keys.sort(options.sort);\n    }\n    const sideChannel = new WeakMap();\n    for (let i = 0; i < obj_keys.length; ++i) {\n        const key = obj_keys[i];\n        if (options.skipNulls && obj[key] === null) {\n            continue;\n        }\n        push_to_array(keys, inner_stringify(obj[key], key, \n        // @ts-expect-error\n        generateArrayPrefix, commaRoundTrip, options.allowEmptyArrays, options.strictNullHandling, options.skipNulls, options.encodeDotInKeys, options.encode ? options.encoder : null, options.filter, options.sort, options.allowDots, options.serializeDate, options.format, options.formatter, options.encodeValuesOnly, options.charset, sideChannel));\n    }\n    const joined = keys.join(options.delimiter);\n    let prefix = options.addQueryPrefix === true ? '?' : '';\n    if (options.charsetSentinel) {\n        if (options.charset === 'iso-8859-1') {\n            // encodeURIComponent('&#10003;'), the \"numeric entity\" representation of a checkmark\n            prefix += 'utf8=%26%2310003%3B&';\n        }\n        else {\n            // encodeURIComponent('')\n            prefix += 'utf8=%E2%9C%93&';\n        }\n    }\n    return joined.length > 0 ? prefix + joined : '';\n}\n//# sourceMappingURL=stringify.mjs.map","export const VERSION = '4.76.0'; // x-release-please-version\n//# sourceMappingURL=version.mjs.map","export let auto = false;\nexport let kind = undefined;\nexport let fetch = undefined;\nexport let Request = undefined;\nexport let Response = undefined;\nexport let Headers = undefined;\nexport let FormData = undefined;\nexport let Blob = undefined;\nexport let File = undefined;\nexport let ReadableStream = undefined;\nexport let getMultipartRequestOptions = undefined;\nexport let getDefaultAgent = undefined;\nexport let fileFromPath = undefined;\nexport let isFsReadStream = undefined;\nexport function setShims(shims, options = { auto: false }) {\n    if (auto) {\n        throw new Error(`you must \\`import 'openai/shims/${shims.kind}'\\` before importing anything else from openai`);\n    }\n    if (kind) {\n        throw new Error(`can't \\`import 'openai/shims/${shims.kind}'\\` after \\`import 'openai/shims/${kind}'\\``);\n    }\n    auto = options.auto;\n    kind = shims.kind;\n    fetch = shims.fetch;\n    Request = shims.Request;\n    Response = shims.Response;\n    Headers = shims.Headers;\n    FormData = shims.FormData;\n    Blob = shims.Blob;\n    File = shims.File;\n    ReadableStream = shims.ReadableStream;\n    getMultipartRequestOptions = shims.getMultipartRequestOptions;\n    getDefaultAgent = shims.getDefaultAgent;\n    fileFromPath = shims.fileFromPath;\n    isFsReadStream = shims.isFsReadStream;\n}\n//# sourceMappingURL=registry.mjs.map","/**\n * Disclaimer: modules in _shims aren't intended to be imported by SDK users.\n */\nexport class MultipartBody {\n    constructor(body) {\n        this.body = body;\n    }\n    get [Symbol.toStringTag]() {\n        return 'MultipartBody';\n    }\n}\n//# sourceMappingURL=MultipartBody.mjs.map","import { MultipartBody } from \"./MultipartBody.mjs\";\nexport function getRuntime({ manuallyImported } = {}) {\n    const recommendation = manuallyImported ?\n        `You may need to use polyfills`\n        : `Add one of these imports before your first \\`import  from 'openai'\\`:\n- \\`import 'openai/shims/node'\\` (if you're running on Node)\n- \\`import 'openai/shims/web'\\` (otherwise)\n`;\n    let _fetch, _Request, _Response, _Headers;\n    try {\n        // @ts-ignore\n        _fetch = fetch;\n        // @ts-ignore\n        _Request = Request;\n        // @ts-ignore\n        _Response = Response;\n        // @ts-ignore\n        _Headers = Headers;\n    }\n    catch (error) {\n        throw new Error(`this environment is missing the following Web Fetch API type: ${error.message}. ${recommendation}`);\n    }\n    return {\n        kind: 'web',\n        fetch: _fetch,\n        Request: _Request,\n        Response: _Response,\n        Headers: _Headers,\n        FormData: \n        // @ts-ignore\n        typeof FormData !== 'undefined' ? FormData : (class FormData {\n            // @ts-ignore\n            constructor() {\n                throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${recommendation}`);\n            }\n        }),\n        Blob: typeof Blob !== 'undefined' ? Blob : (class Blob {\n            constructor() {\n                throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${recommendation}`);\n            }\n        }),\n        File: \n        // @ts-ignore\n        typeof File !== 'undefined' ? File : (class File {\n            // @ts-ignore\n            constructor() {\n                throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${recommendation}`);\n            }\n        }),\n        ReadableStream: \n        // @ts-ignore\n        typeof ReadableStream !== 'undefined' ? ReadableStream : (class ReadableStream {\n            // @ts-ignore\n            constructor() {\n                throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${recommendation}`);\n            }\n        }),\n        getMultipartRequestOptions: async (\n        // @ts-ignore\n        form, opts) => ({\n            ...opts,\n            body: new MultipartBody(form),\n        }),\n        getDefaultAgent: (url) => undefined,\n        fileFromPath: () => {\n            throw new Error('The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads');\n        },\n        isFsReadStream: (value) => false,\n    };\n}\n//# sourceMappingURL=web-runtime.mjs.map","/**\n * Disclaimer: modules in _shims aren't intended to be imported by SDK users.\n */\nimport * as shims from './registry.mjs';\nimport * as auto from 'openai/_shims/auto/runtime';\nif (!shims.kind) shims.setShims(auto.getRuntime(), { auto: true });\nexport * from './registry.mjs';\n","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { castToError } from \"./core.mjs\";\nexport class OpenAIError extends Error {\n}\nexport class APIError extends OpenAIError {\n    constructor(status, error, message, headers) {\n        super(`${APIError.makeMessage(status, error, message)}`);\n        this.status = status;\n        this.headers = headers;\n        this.request_id = headers?.['x-request-id'];\n        const data = error;\n        this.error = data;\n        this.code = data?.['code'];\n        this.param = data?.['param'];\n        this.type = data?.['type'];\n    }\n    static makeMessage(status, error, message) {\n        const msg = error?.message ?\n            typeof error.message === 'string' ?\n                error.message\n                : JSON.stringify(error.message)\n            : error ? JSON.stringify(error)\n                : message;\n        if (status && msg) {\n            return `${status} ${msg}`;\n        }\n        if (status) {\n            return `${status} status code (no body)`;\n        }\n        if (msg) {\n            return msg;\n        }\n        return '(no status code or body)';\n    }\n    static generate(status, errorResponse, message, headers) {\n        if (!status) {\n            return new APIConnectionError({ message, cause: castToError(errorResponse) });\n        }\n        const error = errorResponse?.['error'];\n        if (status === 400) {\n            return new BadRequestError(status, error, message, headers);\n        }\n        if (status === 401) {\n            return new AuthenticationError(status, error, message, headers);\n        }\n        if (status === 403) {\n            return new PermissionDeniedError(status, error, message, headers);\n        }\n        if (status === 404) {\n            return new NotFoundError(status, error, message, headers);\n        }\n        if (status === 409) {\n            return new ConflictError(status, error, message, headers);\n        }\n        if (status === 422) {\n            return new UnprocessableEntityError(status, error, message, headers);\n        }\n        if (status === 429) {\n            return new RateLimitError(status, error, message, headers);\n        }\n        if (status >= 500) {\n            return new InternalServerError(status, error, message, headers);\n        }\n        return new APIError(status, error, message, headers);\n    }\n}\nexport class APIUserAbortError extends APIError {\n    constructor({ message } = {}) {\n        super(undefined, undefined, message || 'Request was aborted.', undefined);\n        this.status = undefined;\n    }\n}\nexport class APIConnectionError extends APIError {\n    constructor({ message, cause }) {\n        super(undefined, undefined, message || 'Connection error.', undefined);\n        this.status = undefined;\n        // in some environments the 'cause' property is already declared\n        // @ts-ignore\n        if (cause)\n            this.cause = cause;\n    }\n}\nexport class APIConnectionTimeoutError extends APIConnectionError {\n    constructor({ message } = {}) {\n        super({ message: message ?? 'Request timed out.' });\n    }\n}\nexport class BadRequestError extends APIError {\n    constructor() {\n        super(...arguments);\n        this.status = 400;\n    }\n}\nexport class AuthenticationError extends APIError {\n    constructor() {\n        super(...arguments);\n        this.status = 401;\n    }\n}\nexport class PermissionDeniedError extends APIError {\n    constructor() {\n        super(...arguments);\n        this.status = 403;\n    }\n}\nexport class NotFoundError extends APIError {\n    constructor() {\n        super(...arguments);\n        this.status = 404;\n    }\n}\nexport class ConflictError extends APIError {\n    constructor() {\n        super(...arguments);\n        this.status = 409;\n    }\n}\nexport class UnprocessableEntityError extends APIError {\n    constructor() {\n        super(...arguments);\n        this.status = 422;\n    }\n}\nexport class RateLimitError extends APIError {\n    constructor() {\n        super(...arguments);\n        this.status = 429;\n    }\n}\nexport class InternalServerError extends APIError {\n}\nexport class LengthFinishReasonError extends OpenAIError {\n    constructor() {\n        super(`Could not parse response content as the length limit was reached`);\n    }\n}\nexport class ContentFilterFinishReasonError extends OpenAIError {\n    constructor() {\n        super(`Could not parse response content as the request was rejected by the content filter`);\n    }\n}\n//# sourceMappingURL=error.mjs.map","import { OpenAIError } from \"../../error.mjs\";\n/**\n * A re-implementation of httpx's `LineDecoder` in Python that handles incrementally\n * reading lines from text.\n *\n * https://github.com/encode/httpx/blob/920333ea98118e9cf617f246905d7b202510941c/httpx/_decoders.py#L258\n */\nexport class LineDecoder {\n    constructor() {\n        this.buffer = [];\n        this.trailingCR = false;\n    }\n    decode(chunk) {\n        let text = this.decodeText(chunk);\n        if (this.trailingCR) {\n            text = '\\r' + text;\n            this.trailingCR = false;\n        }\n        if (text.endsWith('\\r')) {\n            this.trailingCR = true;\n            text = text.slice(0, -1);\n        }\n        if (!text) {\n            return [];\n        }\n        const trailingNewline = LineDecoder.NEWLINE_CHARS.has(text[text.length - 1] || '');\n        let lines = text.split(LineDecoder.NEWLINE_REGEXP);\n        // if there is a trailing new line then the last entry will be an empty\n        // string which we don't care about\n        if (trailingNewline) {\n            lines.pop();\n        }\n        if (lines.length === 1 && !trailingNewline) {\n            this.buffer.push(lines[0]);\n            return [];\n        }\n        if (this.buffer.length > 0) {\n            lines = [this.buffer.join('') + lines[0], ...lines.slice(1)];\n            this.buffer = [];\n        }\n        if (!trailingNewline) {\n            this.buffer = [lines.pop() || ''];\n        }\n        return lines;\n    }\n    decodeText(bytes) {\n        if (bytes == null)\n            return '';\n        if (typeof bytes === 'string')\n            return bytes;\n        // Node:\n        if (typeof Buffer !== 'undefined') {\n            if (bytes instanceof Buffer) {\n                return bytes.toString();\n            }\n            if (bytes instanceof Uint8Array) {\n                return Buffer.from(bytes).toString();\n            }\n            throw new OpenAIError(`Unexpected: received non-Uint8Array (${bytes.constructor.name}) stream chunk in an environment with a global \"Buffer\" defined, which this library assumes to be Node. Please report this error.`);\n        }\n        // Browser\n        if (typeof TextDecoder !== 'undefined') {\n            if (bytes instanceof Uint8Array || bytes instanceof ArrayBuffer) {\n                this.textDecoder ?? (this.textDecoder = new TextDecoder('utf8'));\n                return this.textDecoder.decode(bytes);\n            }\n            throw new OpenAIError(`Unexpected: received non-Uint8Array/ArrayBuffer (${bytes.constructor.name}) in a web platform. Please report this error.`);\n        }\n        throw new OpenAIError(`Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.`);\n    }\n    flush() {\n        if (!this.buffer.length && !this.trailingCR) {\n            return [];\n        }\n        const lines = [this.buffer.join('')];\n        this.buffer = [];\n        this.trailingCR = false;\n        return lines;\n    }\n}\n// prettier-ignore\nLineDecoder.NEWLINE_CHARS = new Set(['\\n', '\\r']);\nLineDecoder.NEWLINE_REGEXP = /\\r\\n|[\\n\\r]/g;\n//# sourceMappingURL=line.mjs.map","import { ReadableStream } from \"./_shims/index.mjs\";\nimport { OpenAIError } from \"./error.mjs\";\nimport { LineDecoder } from \"./internal/decoders/line.mjs\";\nimport { APIError } from \"./error.mjs\";\nexport class Stream {\n    constructor(iterator, controller) {\n        this.iterator = iterator;\n        this.controller = controller;\n    }\n    static fromSSEResponse(response, controller) {\n        let consumed = false;\n        async function* iterator() {\n            if (consumed) {\n                throw new Error('Cannot iterate over a consumed stream, use `.tee()` to split the stream.');\n            }\n            consumed = true;\n            let done = false;\n            try {\n                for await (const sse of _iterSSEMessages(response, controller)) {\n                    if (done)\n                        continue;\n                    if (sse.data.startsWith('[DONE]')) {\n                        done = true;\n                        continue;\n                    }\n                    if (sse.event === null) {\n                        let data;\n                        try {\n                            data = JSON.parse(sse.data);\n                        }\n                        catch (e) {\n                            console.error(`Could not parse message into JSON:`, sse.data);\n                            console.error(`From chunk:`, sse.raw);\n                            throw e;\n                        }\n                        if (data && data.error) {\n                            throw new APIError(undefined, data.error, undefined, undefined);\n                        }\n                        yield data;\n                    }\n                    else {\n                        let data;\n                        try {\n                            data = JSON.parse(sse.data);\n                        }\n                        catch (e) {\n                            console.error(`Could not parse message into JSON:`, sse.data);\n                            console.error(`From chunk:`, sse.raw);\n                            throw e;\n                        }\n                        // TODO: Is this where the error should be thrown?\n                        if (sse.event == 'error') {\n                            throw new APIError(undefined, data.error, data.message, undefined);\n                        }\n                        yield { event: sse.event, data: data };\n                    }\n                }\n                done = true;\n            }\n            catch (e) {\n                // If the user calls `stream.controller.abort()`, we should exit without throwing.\n                if (e instanceof Error && e.name === 'AbortError')\n                    return;\n                throw e;\n            }\n            finally {\n                // If the user `break`s, abort the ongoing request.\n                if (!done)\n                    controller.abort();\n            }\n        }\n        return new Stream(iterator, controller);\n    }\n    /**\n     * Generates a Stream from a newline-separated ReadableStream\n     * where each item is a JSON value.\n     */\n    static fromReadableStream(readableStream, controller) {\n        let consumed = false;\n        async function* iterLines() {\n            const lineDecoder = new LineDecoder();\n            const iter = readableStreamAsyncIterable(readableStream);\n            for await (const chunk of iter) {\n                for (const line of lineDecoder.decode(chunk)) {\n                    yield line;\n                }\n            }\n            for (const line of lineDecoder.flush()) {\n                yield line;\n            }\n        }\n        async function* iterator() {\n            if (consumed) {\n                throw new Error('Cannot iterate over a consumed stream, use `.tee()` to split the stream.');\n            }\n            consumed = true;\n            let done = false;\n            try {\n                for await (const line of iterLines()) {\n                    if (done)\n                        continue;\n                    if (line)\n                        yield JSON.parse(line);\n                }\n                done = true;\n            }\n            catch (e) {\n                // If the user calls `stream.controller.abort()`, we should exit without throwing.\n                if (e instanceof Error && e.name === 'AbortError')\n                    return;\n                throw e;\n            }\n            finally {\n                // If the user `break`s, abort the ongoing request.\n                if (!done)\n                    controller.abort();\n            }\n        }\n        return new Stream(iterator, controller);\n    }\n    [Symbol.asyncIterator]() {\n        return this.iterator();\n    }\n    /**\n     * Splits the stream into two streams which can be\n     * independently read from at different speeds.\n     */\n    tee() {\n        const left = [];\n        const right = [];\n        const iterator = this.iterator();\n        const teeIterator = (queue) => {\n            return {\n                next: () => {\n                    if (queue.length === 0) {\n                        const result = iterator.next();\n                        left.push(result);\n                        right.push(result);\n                    }\n                    return queue.shift();\n                },\n            };\n        };\n        return [\n            new Stream(() => teeIterator(left), this.controller),\n            new Stream(() => teeIterator(right), this.controller),\n        ];\n    }\n    /**\n     * Converts this stream to a newline-separated ReadableStream of\n     * JSON stringified values in the stream\n     * which can be turned back into a Stream with `Stream.fromReadableStream()`.\n     */\n    toReadableStream() {\n        const self = this;\n        let iter;\n        const encoder = new TextEncoder();\n        return new ReadableStream({\n            async start() {\n                iter = self[Symbol.asyncIterator]();\n            },\n            async pull(ctrl) {\n                try {\n                    const { value, done } = await iter.next();\n                    if (done)\n                        return ctrl.close();\n                    const bytes = encoder.encode(JSON.stringify(value) + '\\n');\n                    ctrl.enqueue(bytes);\n                }\n                catch (err) {\n                    ctrl.error(err);\n                }\n            },\n            async cancel() {\n                await iter.return?.();\n            },\n        });\n    }\n}\nexport async function* _iterSSEMessages(response, controller) {\n    if (!response.body) {\n        controller.abort();\n        throw new OpenAIError(`Attempted to iterate over a response with no body`);\n    }\n    const sseDecoder = new SSEDecoder();\n    const lineDecoder = new LineDecoder();\n    const iter = readableStreamAsyncIterable(response.body);\n    for await (const sseChunk of iterSSEChunks(iter)) {\n        for (const line of lineDecoder.decode(sseChunk)) {\n            const sse = sseDecoder.decode(line);\n            if (sse)\n                yield sse;\n        }\n    }\n    for (const line of lineDecoder.flush()) {\n        const sse = sseDecoder.decode(line);\n        if (sse)\n            yield sse;\n    }\n}\n/**\n * Given an async iterable iterator, iterates over it and yields full\n * SSE chunks, i.e. yields when a double new-line is encountered.\n */\nasync function* iterSSEChunks(iterator) {\n    let data = new Uint8Array();\n    for await (const chunk of iterator) {\n        if (chunk == null) {\n            continue;\n        }\n        const binaryChunk = chunk instanceof ArrayBuffer ? new Uint8Array(chunk)\n            : typeof chunk === 'string' ? new TextEncoder().encode(chunk)\n                : chunk;\n        let newData = new Uint8Array(data.length + binaryChunk.length);\n        newData.set(data);\n        newData.set(binaryChunk, data.length);\n        data = newData;\n        let patternIndex;\n        while ((patternIndex = findDoubleNewlineIndex(data)) !== -1) {\n            yield data.slice(0, patternIndex);\n            data = data.slice(patternIndex);\n        }\n    }\n    if (data.length > 0) {\n        yield data;\n    }\n}\nfunction findDoubleNewlineIndex(buffer) {\n    // This function searches the buffer for the end patterns (\\r\\r, \\n\\n, \\r\\n\\r\\n)\n    // and returns the index right after the first occurrence of any pattern,\n    // or -1 if none of the patterns are found.\n    const newline = 0x0a; // \\n\n    const carriage = 0x0d; // \\r\n    for (let i = 0; i < buffer.length - 2; i++) {\n        if (buffer[i] === newline && buffer[i + 1] === newline) {\n            // \\n\\n\n            return i + 2;\n        }\n        if (buffer[i] === carriage && buffer[i + 1] === carriage) {\n            // \\r\\r\n            return i + 2;\n        }\n        if (buffer[i] === carriage &&\n            buffer[i + 1] === newline &&\n            i + 3 < buffer.length &&\n            buffer[i + 2] === carriage &&\n            buffer[i + 3] === newline) {\n            // \\r\\n\\r\\n\n            return i + 4;\n        }\n    }\n    return -1;\n}\nclass SSEDecoder {\n    constructor() {\n        this.event = null;\n        this.data = [];\n        this.chunks = [];\n    }\n    decode(line) {\n        if (line.endsWith('\\r')) {\n            line = line.substring(0, line.length - 1);\n        }\n        if (!line) {\n            // empty line and we didn't previously encounter any messages\n            if (!this.event && !this.data.length)\n                return null;\n            const sse = {\n                event: this.event,\n                data: this.data.join('\\n'),\n                raw: this.chunks,\n            };\n            this.event = null;\n            this.data = [];\n            this.chunks = [];\n            return sse;\n        }\n        this.chunks.push(line);\n        if (line.startsWith(':')) {\n            return null;\n        }\n        let [fieldname, _, value] = partition(line, ':');\n        if (value.startsWith(' ')) {\n            value = value.substring(1);\n        }\n        if (fieldname === 'event') {\n            this.event = value;\n        }\n        else if (fieldname === 'data') {\n            this.data.push(value);\n        }\n        return null;\n    }\n}\n/** This is an internal helper function that's just used for testing */\nexport function _decodeChunks(chunks) {\n    const decoder = new LineDecoder();\n    const lines = [];\n    for (const chunk of chunks) {\n        lines.push(...decoder.decode(chunk));\n    }\n    return lines;\n}\nfunction partition(str, delimiter) {\n    const index = str.indexOf(delimiter);\n    if (index !== -1) {\n        return [str.substring(0, index), delimiter, str.substring(index + delimiter.length)];\n    }\n    return [str, '', ''];\n}\n/**\n * Most browsers don't yet have async iterable support for ReadableStream,\n * and Node has a very different way of reading bytes from its \"ReadableStream\".\n *\n * This polyfill was pulled from https://github.com/MattiasBuelens/web-streams-polyfill/pull/122#issuecomment-1627354490\n */\nexport function readableStreamAsyncIterable(stream) {\n    if (stream[Symbol.asyncIterator])\n        return stream;\n    const reader = stream.getReader();\n    return {\n        async next() {\n            try {\n                const result = await reader.read();\n                if (result?.done)\n                    reader.releaseLock(); // release lock when stream becomes closed\n                return result;\n            }\n            catch (e) {\n                reader.releaseLock(); // release lock when stream becomes errored\n                throw e;\n            }\n        },\n        async return() {\n            const cancelPromise = reader.cancel();\n            reader.releaseLock();\n            await cancelPromise;\n            return { done: true, value: undefined };\n        },\n        [Symbol.asyncIterator]() {\n            return this;\n        },\n    };\n}\n//# sourceMappingURL=streaming.mjs.map","import { FormData, File, getMultipartRequestOptions, isFsReadStream, } from \"./_shims/index.mjs\";\nexport { fileFromPath } from \"./_shims/index.mjs\";\nexport const isResponseLike = (value) => value != null &&\n    typeof value === 'object' &&\n    typeof value.url === 'string' &&\n    typeof value.blob === 'function';\nexport const isFileLike = (value) => value != null &&\n    typeof value === 'object' &&\n    typeof value.name === 'string' &&\n    typeof value.lastModified === 'number' &&\n    isBlobLike(value);\n/**\n * The BlobLike type omits arrayBuffer() because @types/node-fetch@^2.6.4 lacks it; but this check\n * adds the arrayBuffer() method type because it is available and used at runtime\n */\nexport const isBlobLike = (value) => value != null &&\n    typeof value === 'object' &&\n    typeof value.size === 'number' &&\n    typeof value.type === 'string' &&\n    typeof value.text === 'function' &&\n    typeof value.slice === 'function' &&\n    typeof value.arrayBuffer === 'function';\nexport const isUploadable = (value) => {\n    return isFileLike(value) || isResponseLike(value) || isFsReadStream(value);\n};\n/**\n * Helper for creating a {@link File} to pass to an SDK upload method from a variety of different data formats\n * @param value the raw content of the file.  Can be an {@link Uploadable}, {@link BlobLikePart}, or {@link AsyncIterable} of {@link BlobLikePart}s\n * @param {string=} name the name of the file. If omitted, toFile will try to determine a file name from bits if possible\n * @param {Object=} options additional properties\n * @param {string=} options.type the MIME type of the content\n * @param {number=} options.lastModified the last modified timestamp\n * @returns a {@link File} with the given properties\n */\nexport async function toFile(value, name, options) {\n    // If it's a promise, resolve it.\n    value = await value;\n    // If we've been given a `File` we don't need to do anything\n    if (isFileLike(value)) {\n        return value;\n    }\n    if (isResponseLike(value)) {\n        const blob = await value.blob();\n        name || (name = new URL(value.url).pathname.split(/[\\\\/]/).pop() ?? 'unknown_file');\n        // we need to convert the `Blob` into an array buffer because the `Blob` class\n        // that `node-fetch` defines is incompatible with the web standard which results\n        // in `new File` interpreting it as a string instead of binary data.\n        const data = isBlobLike(blob) ? [(await blob.arrayBuffer())] : [blob];\n        return new File(data, name, options);\n    }\n    const bits = await getBytes(value);\n    name || (name = getName(value) ?? 'unknown_file');\n    if (!options?.type) {\n        const type = bits[0]?.type;\n        if (typeof type === 'string') {\n            options = { ...options, type };\n        }\n    }\n    return new File(bits, name, options);\n}\nasync function getBytes(value) {\n    let parts = [];\n    if (typeof value === 'string' ||\n        ArrayBuffer.isView(value) || // includes Uint8Array, Buffer, etc.\n        value instanceof ArrayBuffer) {\n        parts.push(value);\n    }\n    else if (isBlobLike(value)) {\n        parts.push(await value.arrayBuffer());\n    }\n    else if (isAsyncIterableIterator(value) // includes Readable, ReadableStream, etc.\n    ) {\n        for await (const chunk of value) {\n            parts.push(chunk); // TODO, consider validating?\n        }\n    }\n    else {\n        throw new Error(`Unexpected data type: ${typeof value}; constructor: ${value?.constructor\n            ?.name}; props: ${propsForError(value)}`);\n    }\n    return parts;\n}\nfunction propsForError(value) {\n    const props = Object.getOwnPropertyNames(value);\n    return `[${props.map((p) => `\"${p}\"`).join(', ')}]`;\n}\nfunction getName(value) {\n    return (getStringFromMaybeBuffer(value.name) ||\n        getStringFromMaybeBuffer(value.filename) ||\n        // For fs.ReadStream\n        getStringFromMaybeBuffer(value.path)?.split(/[\\\\/]/).pop());\n}\nconst getStringFromMaybeBuffer = (x) => {\n    if (typeof x === 'string')\n        return x;\n    if (typeof Buffer !== 'undefined' && x instanceof Buffer)\n        return String(x);\n    return undefined;\n};\nconst isAsyncIterableIterator = (value) => value != null && typeof value === 'object' && typeof value[Symbol.asyncIterator] === 'function';\nexport const isMultipartBody = (body) => body && typeof body === 'object' && body.body && body[Symbol.toStringTag] === 'MultipartBody';\n/**\n * Returns a multipart/form-data request if any part of the given request body contains a File / Blob value.\n * Otherwise returns the request as is.\n */\nexport const maybeMultipartFormRequestOptions = async (opts) => {\n    if (!hasUploadableValue(opts.body))\n        return opts;\n    const form = await createForm(opts.body);\n    return getMultipartRequestOptions(form, opts);\n};\nexport const multipartFormRequestOptions = async (opts) => {\n    const form = await createForm(opts.body);\n    return getMultipartRequestOptions(form, opts);\n};\nexport const createForm = async (body) => {\n    const form = new FormData();\n    await Promise.all(Object.entries(body || {}).map(([key, value]) => addFormValue(form, key, value)));\n    return form;\n};\nconst hasUploadableValue = (value) => {\n    if (isUploadable(value))\n        return true;\n    if (Array.isArray(value))\n        return value.some(hasUploadableValue);\n    if (value && typeof value === 'object') {\n        for (const k in value) {\n            if (hasUploadableValue(value[k]))\n                return true;\n        }\n    }\n    return false;\n};\nconst addFormValue = async (form, key, value) => {\n    if (value === undefined)\n        return;\n    if (value == null) {\n        throw new TypeError(`Received null for \"${key}\"; to pass null in FormData, you must use the string 'null'`);\n    }\n    // TODO: make nested formats configurable\n    if (typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean') {\n        form.append(key, String(value));\n    }\n    else if (isUploadable(value)) {\n        const file = await toFile(value);\n        form.append(key, file);\n    }\n    else if (Array.isArray(value)) {\n        await Promise.all(value.map((entry) => addFormValue(form, key + '[]', entry)));\n    }\n    else if (typeof value === 'object') {\n        await Promise.all(Object.entries(value).map(([name, prop]) => addFormValue(form, `${key}[${name}]`, prop)));\n    }\n    else {\n        throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${value} instead`);\n    }\n};\n//# sourceMappingURL=uploads.mjs.map","var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _AbstractPage_client;\nimport { VERSION } from \"./version.mjs\";\nimport { Stream } from \"./streaming.mjs\";\nimport { OpenAIError, APIError, APIConnectionError, APIConnectionTimeoutError, APIUserAbortError, } from \"./error.mjs\";\nimport { kind as shimsKind, getDefaultAgent, fetch, } from \"./_shims/index.mjs\";\nimport { isBlobLike, isMultipartBody } from \"./uploads.mjs\";\nexport { maybeMultipartFormRequestOptions, multipartFormRequestOptions, createForm, } from \"./uploads.mjs\";\nasync function defaultParseResponse(props) {\n    const { response } = props;\n    if (props.options.stream) {\n        debug('response', response.status, response.url, response.headers, response.body);\n        // Note: there is an invariant here that isn't represented in the type system\n        // that if you set `stream: true` the response type must also be `Stream<T>`\n        if (props.options.__streamClass) {\n            return props.options.__streamClass.fromSSEResponse(response, props.controller);\n        }\n        return Stream.fromSSEResponse(response, props.controller);\n    }\n    // fetch refuses to read the body when the status code is 204.\n    if (response.status === 204) {\n        return null;\n    }\n    if (props.options.__binaryResponse) {\n        return response;\n    }\n    const contentType = response.headers.get('content-type');\n    const isJSON = contentType?.includes('application/json') || contentType?.includes('application/vnd.api+json');\n    if (isJSON) {\n        const json = await response.json();\n        debug('response', response.status, response.url, response.headers, json);\n        return _addRequestID(json, response);\n    }\n    const text = await response.text();\n    debug('response', response.status, response.url, response.headers, text);\n    // TODO handle blob, arraybuffer, other content types, etc.\n    return text;\n}\nfunction _addRequestID(value, response) {\n    if (!value || typeof value !== 'object' || Array.isArray(value)) {\n        return value;\n    }\n    return Object.defineProperty(value, '_request_id', {\n        value: response.headers.get('x-request-id'),\n        enumerable: false,\n    });\n}\n/**\n * A subclass of `Promise` providing additional helper methods\n * for interacting with the SDK.\n */\nexport class APIPromise extends Promise {\n    constructor(responsePromise, parseResponse = defaultParseResponse) {\n        super((resolve) => {\n            // this is maybe a bit weird but this has to be a no-op to not implicitly\n            // parse the response body; instead .then, .catch, .finally are overridden\n            // to parse the response\n            resolve(null);\n        });\n        this.responsePromise = responsePromise;\n        this.parseResponse = parseResponse;\n    }\n    _thenUnwrap(transform) {\n        return new APIPromise(this.responsePromise, async (props) => _addRequestID(transform(await this.parseResponse(props), props), props.response));\n    }\n    /**\n     * Gets the raw `Response` instance instead of parsing the response\n     * data.\n     *\n     * If you want to parse the response body but still get the `Response`\n     * instance, you can use {@link withResponse()}.\n     *\n     *  Getting the wrong TypeScript type for `Response`?\n     * Try setting `\"moduleResolution\": \"NodeNext\"` if you can,\n     * or add one of these imports before your first `import  from 'openai'`:\n     * - `import 'openai/shims/node'` (if you're running on Node)\n     * - `import 'openai/shims/web'` (otherwise)\n     */\n    asResponse() {\n        return this.responsePromise.then((p) => p.response);\n    }\n    /**\n     * Gets the parsed response data, the raw `Response` instance and the ID of the request,\n     * returned via the X-Request-ID header which is useful for debugging requests and reporting\n     * issues to OpenAI.\n     *\n     * If you just want to get the raw `Response` instance without parsing it,\n     * you can use {@link asResponse()}.\n     *\n     *\n     *  Getting the wrong TypeScript type for `Response`?\n     * Try setting `\"moduleResolution\": \"NodeNext\"` if you can,\n     * or add one of these imports before your first `import  from 'openai'`:\n     * - `import 'openai/shims/node'` (if you're running on Node)\n     * - `import 'openai/shims/web'` (otherwise)\n     */\n    async withResponse() {\n        const [data, response] = await Promise.all([this.parse(), this.asResponse()]);\n        return { data, response, request_id: response.headers.get('x-request-id') };\n    }\n    parse() {\n        if (!this.parsedPromise) {\n            this.parsedPromise = this.responsePromise.then(this.parseResponse);\n        }\n        return this.parsedPromise;\n    }\n    then(onfulfilled, onrejected) {\n        return this.parse().then(onfulfilled, onrejected);\n    }\n    catch(onrejected) {\n        return this.parse().catch(onrejected);\n    }\n    finally(onfinally) {\n        return this.parse().finally(onfinally);\n    }\n}\nexport class APIClient {\n    constructor({ baseURL, maxRetries = 2, timeout = 600000, // 10 minutes\n    httpAgent, fetch: overridenFetch, }) {\n        this.baseURL = baseURL;\n        this.maxRetries = validatePositiveInteger('maxRetries', maxRetries);\n        this.timeout = validatePositiveInteger('timeout', timeout);\n        this.httpAgent = httpAgent;\n        this.fetch = overridenFetch ?? fetch;\n    }\n    authHeaders(opts) {\n        return {};\n    }\n    /**\n     * Override this to add your own default headers, for example:\n     *\n     *  {\n     *    ...super.defaultHeaders(),\n     *    Authorization: 'Bearer 123',\n     *  }\n     */\n    defaultHeaders(opts) {\n        return {\n            Accept: 'application/json',\n            'Content-Type': 'application/json',\n            'User-Agent': this.getUserAgent(),\n            ...getPlatformHeaders(),\n            ...this.authHeaders(opts),\n        };\n    }\n    /**\n     * Override this to add your own headers validation:\n     */\n    validateHeaders(headers, customHeaders) { }\n    defaultIdempotencyKey() {\n        return `stainless-node-retry-${uuid4()}`;\n    }\n    get(path, opts) {\n        return this.methodRequest('get', path, opts);\n    }\n    post(path, opts) {\n        return this.methodRequest('post', path, opts);\n    }\n    patch(path, opts) {\n        return this.methodRequest('patch', path, opts);\n    }\n    put(path, opts) {\n        return this.methodRequest('put', path, opts);\n    }\n    delete(path, opts) {\n        return this.methodRequest('delete', path, opts);\n    }\n    methodRequest(method, path, opts) {\n        return this.request(Promise.resolve(opts).then(async (opts) => {\n            const body = opts && isBlobLike(opts?.body) ? new DataView(await opts.body.arrayBuffer())\n                : opts?.body instanceof DataView ? opts.body\n                    : opts?.body instanceof ArrayBuffer ? new DataView(opts.body)\n                        : opts && ArrayBuffer.isView(opts?.body) ? new DataView(opts.body.buffer)\n                            : opts?.body;\n            return { method, path, ...opts, body };\n        }));\n    }\n    getAPIList(path, Page, opts) {\n        return this.requestAPIList(Page, { method: 'get', path, ...opts });\n    }\n    calculateContentLength(body) {\n        if (typeof body === 'string') {\n            if (typeof Buffer !== 'undefined') {\n                return Buffer.byteLength(body, 'utf8').toString();\n            }\n            if (typeof TextEncoder !== 'undefined') {\n                const encoder = new TextEncoder();\n                const encoded = encoder.encode(body);\n                return encoded.length.toString();\n            }\n        }\n        else if (ArrayBuffer.isView(body)) {\n            return body.byteLength.toString();\n        }\n        return null;\n    }\n    buildRequest(options, { retryCount = 0 } = {}) {\n        const { method, path, query, headers: headers = {} } = options;\n        const body = ArrayBuffer.isView(options.body) || (options.__binaryRequest && typeof options.body === 'string') ?\n            options.body\n            : isMultipartBody(options.body) ? options.body.body\n                : options.body ? JSON.stringify(options.body, null, 2)\n                    : null;\n        const contentLength = this.calculateContentLength(body);\n        const url = this.buildURL(path, query);\n        if ('timeout' in options)\n            validatePositiveInteger('timeout', options.timeout);\n        const timeout = options.timeout ?? this.timeout;\n        const httpAgent = options.httpAgent ?? this.httpAgent ?? getDefaultAgent(url);\n        const minAgentTimeout = timeout + 1000;\n        if (typeof httpAgent?.options?.timeout === 'number' &&\n            minAgentTimeout > (httpAgent.options.timeout ?? 0)) {\n            // Allow any given request to bump our agent active socket timeout.\n            // This may seem strange, but leaking active sockets should be rare and not particularly problematic,\n            // and without mutating agent we would need to create more of them.\n            // This tradeoff optimizes for performance.\n            httpAgent.options.timeout = minAgentTimeout;\n        }\n        if (this.idempotencyHeader && method !== 'get') {\n            if (!options.idempotencyKey)\n                options.idempotencyKey = this.defaultIdempotencyKey();\n            headers[this.idempotencyHeader] = options.idempotencyKey;\n        }\n        const reqHeaders = this.buildHeaders({ options, headers, contentLength, retryCount });\n        const req = {\n            method,\n            ...(body && { body: body }),\n            headers: reqHeaders,\n            ...(httpAgent && { agent: httpAgent }),\n            // @ts-ignore node-fetch uses a custom AbortSignal type that is\n            // not compatible with standard web types\n            signal: options.signal ?? null,\n        };\n        return { req, url, timeout };\n    }\n    buildHeaders({ options, headers, contentLength, retryCount, }) {\n        const reqHeaders = {};\n        if (contentLength) {\n            reqHeaders['content-length'] = contentLength;\n        }\n        const defaultHeaders = this.defaultHeaders(options);\n        applyHeadersMut(reqHeaders, defaultHeaders);\n        applyHeadersMut(reqHeaders, headers);\n        // let builtin fetch set the Content-Type for multipart bodies\n        if (isMultipartBody(options.body) && shimsKind !== 'node') {\n            delete reqHeaders['content-type'];\n        }\n        // Don't set the retry count header if it was already set or removed through default headers or by the\n        // caller. We check `defaultHeaders` and `headers`, which can contain nulls, instead of `reqHeaders` to\n        // account for the removal case.\n        if (getHeader(defaultHeaders, 'x-stainless-retry-count') === undefined &&\n            getHeader(headers, 'x-stainless-retry-count') === undefined) {\n            reqHeaders['x-stainless-retry-count'] = String(retryCount);\n        }\n        this.validateHeaders(reqHeaders, headers);\n        return reqHeaders;\n    }\n    /**\n     * Used as a callback for mutating the given `FinalRequestOptions` object.\n     */\n    async prepareOptions(options) { }\n    /**\n     * Used as a callback for mutating the given `RequestInit` object.\n     *\n     * This is useful for cases where you want to add certain headers based off of\n     * the request properties, e.g. `method` or `url`.\n     */\n    async prepareRequest(request, { url, options }) { }\n    parseHeaders(headers) {\n        return (!headers ? {}\n            : Symbol.iterator in headers ?\n                Object.fromEntries(Array.from(headers).map((header) => [...header]))\n                : { ...headers });\n    }\n    makeStatusError(status, error, message, headers) {\n        return APIError.generate(status, error, message, headers);\n    }\n    request(options, remainingRetries = null) {\n        return new APIPromise(this.makeRequest(options, remainingRetries));\n    }\n    async makeRequest(optionsInput, retriesRemaining) {\n        const options = await optionsInput;\n        const maxRetries = options.maxRetries ?? this.maxRetries;\n        if (retriesRemaining == null) {\n            retriesRemaining = maxRetries;\n        }\n        await this.prepareOptions(options);\n        const { req, url, timeout } = this.buildRequest(options, { retryCount: maxRetries - retriesRemaining });\n        await this.prepareRequest(req, { url, options });\n        debug('request', url, options, req.headers);\n        if (options.signal?.aborted) {\n            throw new APIUserAbortError();\n        }\n        const controller = new AbortController();\n        const response = await this.fetchWithTimeout(url, req, timeout, controller).catch(castToError);\n        if (response instanceof Error) {\n            if (options.signal?.aborted) {\n                throw new APIUserAbortError();\n            }\n            if (retriesRemaining) {\n                return this.retryRequest(options, retriesRemaining);\n            }\n            if (response.name === 'AbortError') {\n                throw new APIConnectionTimeoutError();\n            }\n            throw new APIConnectionError({ cause: response });\n        }\n        const responseHeaders = createResponseHeaders(response.headers);\n        if (!response.ok) {\n            if (retriesRemaining && this.shouldRetry(response)) {\n                const retryMessage = `retrying, ${retriesRemaining} attempts remaining`;\n                debug(`response (error; ${retryMessage})`, response.status, url, responseHeaders);\n                return this.retryRequest(options, retriesRemaining, responseHeaders);\n            }\n            const errText = await response.text().catch((e) => castToError(e).message);\n            const errJSON = safeJSON(errText);\n            const errMessage = errJSON ? undefined : errText;\n            const retryMessage = retriesRemaining ? `(error; no more retries left)` : `(error; not retryable)`;\n            debug(`response (error; ${retryMessage})`, response.status, url, responseHeaders, errMessage);\n            const err = this.makeStatusError(response.status, errJSON, errMessage, responseHeaders);\n            throw err;\n        }\n        return { response, options, controller };\n    }\n    requestAPIList(Page, options) {\n        const request = this.makeRequest(options, null);\n        return new PagePromise(this, request, Page);\n    }\n    buildURL(path, query) {\n        const url = isAbsoluteURL(path) ?\n            new URL(path)\n            : new URL(this.baseURL + (this.baseURL.endsWith('/') && path.startsWith('/') ? path.slice(1) : path));\n        const defaultQuery = this.defaultQuery();\n        if (!isEmptyObj(defaultQuery)) {\n            query = { ...defaultQuery, ...query };\n        }\n        if (typeof query === 'object' && query && !Array.isArray(query)) {\n            url.search = this.stringifyQuery(query);\n        }\n        return url.toString();\n    }\n    stringifyQuery(query) {\n        return Object.entries(query)\n            .filter(([_, value]) => typeof value !== 'undefined')\n            .map(([key, value]) => {\n            if (typeof value === 'string' || typeof value === 'number' || typeof value === 'boolean') {\n                return `${encodeURIComponent(key)}=${encodeURIComponent(value)}`;\n            }\n            if (value === null) {\n                return `${encodeURIComponent(key)}=`;\n            }\n            throw new OpenAIError(`Cannot stringify type ${typeof value}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`);\n        })\n            .join('&');\n    }\n    async fetchWithTimeout(url, init, ms, controller) {\n        const { signal, ...options } = init || {};\n        if (signal)\n            signal.addEventListener('abort', () => controller.abort());\n        const timeout = setTimeout(() => controller.abort(), ms);\n        return (this.getRequestClient()\n            // use undefined this binding; fetch errors if bound to something else in browser/cloudflare\n            .fetch.call(undefined, url, { signal: controller.signal, ...options })\n            .finally(() => {\n            clearTimeout(timeout);\n        }));\n    }\n    getRequestClient() {\n        return { fetch: this.fetch };\n    }\n    shouldRetry(response) {\n        // Note this is not a standard header.\n        const shouldRetryHeader = response.headers.get('x-should-retry');\n        // If the server explicitly says whether or not to retry, obey.\n        if (shouldRetryHeader === 'true')\n            return true;\n        if (shouldRetryHeader === 'false')\n            return false;\n        // Retry on request timeouts.\n        if (response.status === 408)\n            return true;\n        // Retry on lock timeouts.\n        if (response.status === 409)\n            return true;\n        // Retry on rate limits.\n        if (response.status === 429)\n            return true;\n        // Retry internal errors.\n        if (response.status >= 500)\n            return true;\n        return false;\n    }\n    async retryRequest(options, retriesRemaining, responseHeaders) {\n        let timeoutMillis;\n        // Note the `retry-after-ms` header may not be standard, but is a good idea and we'd like proactive support for it.\n        const retryAfterMillisHeader = responseHeaders?.['retry-after-ms'];\n        if (retryAfterMillisHeader) {\n            const timeoutMs = parseFloat(retryAfterMillisHeader);\n            if (!Number.isNaN(timeoutMs)) {\n                timeoutMillis = timeoutMs;\n            }\n        }\n        // About the Retry-After header: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Retry-After\n        const retryAfterHeader = responseHeaders?.['retry-after'];\n        if (retryAfterHeader && !timeoutMillis) {\n            const timeoutSeconds = parseFloat(retryAfterHeader);\n            if (!Number.isNaN(timeoutSeconds)) {\n                timeoutMillis = timeoutSeconds * 1000;\n            }\n            else {\n                timeoutMillis = Date.parse(retryAfterHeader) - Date.now();\n            }\n        }\n        // If the API asks us to wait a certain amount of time (and it's a reasonable amount),\n        // just do what it says, but otherwise calculate a default\n        if (!(timeoutMillis && 0 <= timeoutMillis && timeoutMillis < 60 * 1000)) {\n            const maxRetries = options.maxRetries ?? this.maxRetries;\n            timeoutMillis = this.calculateDefaultRetryTimeoutMillis(retriesRemaining, maxRetries);\n        }\n        await sleep(timeoutMillis);\n        return this.makeRequest(options, retriesRemaining - 1);\n    }\n    calculateDefaultRetryTimeoutMillis(retriesRemaining, maxRetries) {\n        const initialRetryDelay = 0.5;\n        const maxRetryDelay = 8.0;\n        const numRetries = maxRetries - retriesRemaining;\n        // Apply exponential backoff, but not more than the max.\n        const sleepSeconds = Math.min(initialRetryDelay * Math.pow(2, numRetries), maxRetryDelay);\n        // Apply some jitter, take up to at most 25 percent of the retry time.\n        const jitter = 1 - Math.random() * 0.25;\n        return sleepSeconds * jitter * 1000;\n    }\n    getUserAgent() {\n        return `${this.constructor.name}/JS ${VERSION}`;\n    }\n}\nexport class AbstractPage {\n    constructor(client, response, body, options) {\n        _AbstractPage_client.set(this, void 0);\n        __classPrivateFieldSet(this, _AbstractPage_client, client, \"f\");\n        this.options = options;\n        this.response = response;\n        this.body = body;\n    }\n    hasNextPage() {\n        const items = this.getPaginatedItems();\n        if (!items.length)\n            return false;\n        return this.nextPageInfo() != null;\n    }\n    async getNextPage() {\n        const nextInfo = this.nextPageInfo();\n        if (!nextInfo) {\n            throw new OpenAIError('No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.');\n        }\n        const nextOptions = { ...this.options };\n        if ('params' in nextInfo && typeof nextOptions.query === 'object') {\n            nextOptions.query = { ...nextOptions.query, ...nextInfo.params };\n        }\n        else if ('url' in nextInfo) {\n            const params = [...Object.entries(nextOptions.query || {}), ...nextInfo.url.searchParams.entries()];\n            for (const [key, value] of params) {\n                nextInfo.url.searchParams.set(key, value);\n            }\n            nextOptions.query = undefined;\n            nextOptions.path = nextInfo.url.toString();\n        }\n        return await __classPrivateFieldGet(this, _AbstractPage_client, \"f\").requestAPIList(this.constructor, nextOptions);\n    }\n    async *iterPages() {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        let page = this;\n        yield page;\n        while (page.hasNextPage()) {\n            page = await page.getNextPage();\n            yield page;\n        }\n    }\n    async *[(_AbstractPage_client = new WeakMap(), Symbol.asyncIterator)]() {\n        for await (const page of this.iterPages()) {\n            for (const item of page.getPaginatedItems()) {\n                yield item;\n            }\n        }\n    }\n}\n/**\n * This subclass of Promise will resolve to an instantiated Page once the request completes.\n *\n * It also implements AsyncIterable to allow auto-paginating iteration on an unawaited list call, eg:\n *\n *    for await (const item of client.items.list()) {\n *      console.log(item)\n *    }\n */\nexport class PagePromise extends APIPromise {\n    constructor(client, request, Page) {\n        super(request, async (props) => new Page(client, props.response, await defaultParseResponse(props), props.options));\n    }\n    /**\n     * Allow auto-paginating iteration on an unawaited list call, eg:\n     *\n     *    for await (const item of client.items.list()) {\n     *      console.log(item)\n     *    }\n     */\n    async *[Symbol.asyncIterator]() {\n        const page = await this;\n        for await (const item of page) {\n            yield item;\n        }\n    }\n}\nexport const createResponseHeaders = (headers) => {\n    return new Proxy(Object.fromEntries(\n    // @ts-ignore\n    headers.entries()), {\n        get(target, name) {\n            const key = name.toString();\n            return target[key.toLowerCase()] || target[key];\n        },\n    });\n};\n// This is required so that we can determine if a given object matches the RequestOptions\n// type at runtime. While this requires duplication, it is enforced by the TypeScript\n// compiler such that any missing / extraneous keys will cause an error.\nconst requestOptionsKeys = {\n    method: true,\n    path: true,\n    query: true,\n    body: true,\n    headers: true,\n    maxRetries: true,\n    stream: true,\n    timeout: true,\n    httpAgent: true,\n    signal: true,\n    idempotencyKey: true,\n    __binaryRequest: true,\n    __binaryResponse: true,\n    __streamClass: true,\n};\nexport const isRequestOptions = (obj) => {\n    return (typeof obj === 'object' &&\n        obj !== null &&\n        !isEmptyObj(obj) &&\n        Object.keys(obj).every((k) => hasOwn(requestOptionsKeys, k)));\n};\nconst getPlatformProperties = () => {\n    if (typeof Deno !== 'undefined' && Deno.build != null) {\n        return {\n            'X-Stainless-Lang': 'js',\n            'X-Stainless-Package-Version': VERSION,\n            'X-Stainless-OS': normalizePlatform(Deno.build.os),\n            'X-Stainless-Arch': normalizeArch(Deno.build.arch),\n            'X-Stainless-Runtime': 'deno',\n            'X-Stainless-Runtime-Version': typeof Deno.version === 'string' ? Deno.version : Deno.version?.deno ?? 'unknown',\n        };\n    }\n    if (typeof EdgeRuntime !== 'undefined') {\n        return {\n            'X-Stainless-Lang': 'js',\n            'X-Stainless-Package-Version': VERSION,\n            'X-Stainless-OS': 'Unknown',\n            'X-Stainless-Arch': `other:${EdgeRuntime}`,\n            'X-Stainless-Runtime': 'edge',\n            'X-Stainless-Runtime-Version': process.version,\n        };\n    }\n    // Check if Node.js\n    if (Object.prototype.toString.call(typeof process !== 'undefined' ? process : 0) === '[object process]') {\n        return {\n            'X-Stainless-Lang': 'js',\n            'X-Stainless-Package-Version': VERSION,\n            'X-Stainless-OS': normalizePlatform(process.platform),\n            'X-Stainless-Arch': normalizeArch(process.arch),\n            'X-Stainless-Runtime': 'node',\n            'X-Stainless-Runtime-Version': process.version,\n        };\n    }\n    const browserInfo = getBrowserInfo();\n    if (browserInfo) {\n        return {\n            'X-Stainless-Lang': 'js',\n            'X-Stainless-Package-Version': VERSION,\n            'X-Stainless-OS': 'Unknown',\n            'X-Stainless-Arch': 'unknown',\n            'X-Stainless-Runtime': `browser:${browserInfo.browser}`,\n            'X-Stainless-Runtime-Version': browserInfo.version,\n        };\n    }\n    // TODO add support for Cloudflare workers, etc.\n    return {\n        'X-Stainless-Lang': 'js',\n        'X-Stainless-Package-Version': VERSION,\n        'X-Stainless-OS': 'Unknown',\n        'X-Stainless-Arch': 'unknown',\n        'X-Stainless-Runtime': 'unknown',\n        'X-Stainless-Runtime-Version': 'unknown',\n    };\n};\n// Note: modified from https://github.com/JS-DevTools/host-environment/blob/b1ab79ecde37db5d6e163c050e54fe7d287d7c92/src/isomorphic.browser.ts\nfunction getBrowserInfo() {\n    if (typeof navigator === 'undefined' || !navigator) {\n        return null;\n    }\n    // NOTE: The order matters here!\n    const browserPatterns = [\n        { key: 'edge', pattern: /Edge(?:\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n        { key: 'ie', pattern: /MSIE(?:\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n        { key: 'ie', pattern: /Trident(?:.*rv\\:(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n        { key: 'chrome', pattern: /Chrome(?:\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n        { key: 'firefox', pattern: /Firefox(?:\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?/ },\n        { key: 'safari', pattern: /(?:Version\\W+(\\d+)\\.(\\d+)(?:\\.(\\d+))?)?(?:\\W+Mobile\\S*)?\\W+Safari/ },\n    ];\n    // Find the FIRST matching browser\n    for (const { key, pattern } of browserPatterns) {\n        const match = pattern.exec(navigator.userAgent);\n        if (match) {\n            const major = match[1] || 0;\n            const minor = match[2] || 0;\n            const patch = match[3] || 0;\n            return { browser: key, version: `${major}.${minor}.${patch}` };\n        }\n    }\n    return null;\n}\nconst normalizeArch = (arch) => {\n    // Node docs:\n    // - https://nodejs.org/api/process.html#processarch\n    // Deno docs:\n    // - https://doc.deno.land/deno/stable/~/Deno.build\n    if (arch === 'x32')\n        return 'x32';\n    if (arch === 'x86_64' || arch === 'x64')\n        return 'x64';\n    if (arch === 'arm')\n        return 'arm';\n    if (arch === 'aarch64' || arch === 'arm64')\n        return 'arm64';\n    if (arch)\n        return `other:${arch}`;\n    return 'unknown';\n};\nconst normalizePlatform = (platform) => {\n    // Node platforms:\n    // - https://nodejs.org/api/process.html#processplatform\n    // Deno platforms:\n    // - https://doc.deno.land/deno/stable/~/Deno.build\n    // - https://github.com/denoland/deno/issues/14799\n    platform = platform.toLowerCase();\n    // NOTE: this iOS check is untested and may not work\n    // Node does not work natively on IOS, there is a fork at\n    // https://github.com/nodejs-mobile/nodejs-mobile\n    // however it is unknown at the time of writing how to detect if it is running\n    if (platform.includes('ios'))\n        return 'iOS';\n    if (platform === 'android')\n        return 'Android';\n    if (platform === 'darwin')\n        return 'MacOS';\n    if (platform === 'win32')\n        return 'Windows';\n    if (platform === 'freebsd')\n        return 'FreeBSD';\n    if (platform === 'openbsd')\n        return 'OpenBSD';\n    if (platform === 'linux')\n        return 'Linux';\n    if (platform)\n        return `Other:${platform}`;\n    return 'Unknown';\n};\nlet _platformHeaders;\nconst getPlatformHeaders = () => {\n    return (_platformHeaders ?? (_platformHeaders = getPlatformProperties()));\n};\nexport const safeJSON = (text) => {\n    try {\n        return JSON.parse(text);\n    }\n    catch (err) {\n        return undefined;\n    }\n};\n// https://stackoverflow.com/a/19709846\nconst startsWithSchemeRegexp = new RegExp('^(?:[a-z]+:)?//', 'i');\nconst isAbsoluteURL = (url) => {\n    return startsWithSchemeRegexp.test(url);\n};\nexport const sleep = (ms) => new Promise((resolve) => setTimeout(resolve, ms));\nconst validatePositiveInteger = (name, n) => {\n    if (typeof n !== 'number' || !Number.isInteger(n)) {\n        throw new OpenAIError(`${name} must be an integer`);\n    }\n    if (n < 0) {\n        throw new OpenAIError(`${name} must be a positive integer`);\n    }\n    return n;\n};\nexport const castToError = (err) => {\n    if (err instanceof Error)\n        return err;\n    if (typeof err === 'object' && err !== null) {\n        try {\n            return new Error(JSON.stringify(err));\n        }\n        catch { }\n    }\n    return new Error(err);\n};\nexport const ensurePresent = (value) => {\n    if (value == null)\n        throw new OpenAIError(`Expected a value to be given but received ${value} instead.`);\n    return value;\n};\n/**\n * Read an environment variable.\n *\n * Trims beginning and trailing whitespace.\n *\n * Will return undefined if the environment variable doesn't exist or cannot be accessed.\n */\nexport const readEnv = (env) => {\n    if (typeof process !== 'undefined') {\n        return process.env?.[env]?.trim() ?? undefined;\n    }\n    if (typeof Deno !== 'undefined') {\n        return Deno.env?.get?.(env)?.trim();\n    }\n    return undefined;\n};\nexport const coerceInteger = (value) => {\n    if (typeof value === 'number')\n        return Math.round(value);\n    if (typeof value === 'string')\n        return parseInt(value, 10);\n    throw new OpenAIError(`Could not coerce ${value} (type: ${typeof value}) into a number`);\n};\nexport const coerceFloat = (value) => {\n    if (typeof value === 'number')\n        return value;\n    if (typeof value === 'string')\n        return parseFloat(value);\n    throw new OpenAIError(`Could not coerce ${value} (type: ${typeof value}) into a number`);\n};\nexport const coerceBoolean = (value) => {\n    if (typeof value === 'boolean')\n        return value;\n    if (typeof value === 'string')\n        return value === 'true';\n    return Boolean(value);\n};\nexport const maybeCoerceInteger = (value) => {\n    if (value === undefined) {\n        return undefined;\n    }\n    return coerceInteger(value);\n};\nexport const maybeCoerceFloat = (value) => {\n    if (value === undefined) {\n        return undefined;\n    }\n    return coerceFloat(value);\n};\nexport const maybeCoerceBoolean = (value) => {\n    if (value === undefined) {\n        return undefined;\n    }\n    return coerceBoolean(value);\n};\n// https://stackoverflow.com/a/34491287\nexport function isEmptyObj(obj) {\n    if (!obj)\n        return true;\n    for (const _k in obj)\n        return false;\n    return true;\n}\n// https://eslint.org/docs/latest/rules/no-prototype-builtins\nexport function hasOwn(obj, key) {\n    return Object.prototype.hasOwnProperty.call(obj, key);\n}\n/**\n * Copies headers from \"newHeaders\" onto \"targetHeaders\",\n * using lower-case for all properties,\n * ignoring any keys with undefined values,\n * and deleting any keys with null values.\n */\nfunction applyHeadersMut(targetHeaders, newHeaders) {\n    for (const k in newHeaders) {\n        if (!hasOwn(newHeaders, k))\n            continue;\n        const lowerKey = k.toLowerCase();\n        if (!lowerKey)\n            continue;\n        const val = newHeaders[k];\n        if (val === null) {\n            delete targetHeaders[lowerKey];\n        }\n        else if (val !== undefined) {\n            targetHeaders[lowerKey] = val;\n        }\n    }\n}\nexport function debug(action, ...args) {\n    if (typeof process !== 'undefined' && process?.env?.['DEBUG'] === 'true') {\n        console.log(`OpenAI:DEBUG:${action}`, ...args);\n    }\n}\n/**\n * https://stackoverflow.com/a/2117523\n */\nconst uuid4 = () => {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, (c) => {\n        const r = (Math.random() * 16) | 0;\n        const v = c === 'x' ? r : (r & 0x3) | 0x8;\n        return v.toString(16);\n    });\n};\nexport const isRunningInBrowser = () => {\n    return (\n    // @ts-ignore\n    typeof window !== 'undefined' &&\n        // @ts-ignore\n        typeof window.document !== 'undefined' &&\n        // @ts-ignore\n        typeof navigator !== 'undefined');\n};\nexport const isHeadersProtocol = (headers) => {\n    return typeof headers?.get === 'function';\n};\nexport const getRequiredHeader = (headers, header) => {\n    const foundHeader = getHeader(headers, header);\n    if (foundHeader === undefined) {\n        throw new Error(`Could not find ${header} header`);\n    }\n    return foundHeader;\n};\nexport const getHeader = (headers, header) => {\n    const lowerCasedHeader = header.toLowerCase();\n    if (isHeadersProtocol(headers)) {\n        // to deal with the case where the header looks like Stainless-Event-Id\n        const intercapsHeader = header[0]?.toUpperCase() +\n            header.substring(1).replace(/([^\\w])(\\w)/g, (_m, g1, g2) => g1 + g2.toUpperCase());\n        for (const key of [header, lowerCasedHeader, header.toUpperCase(), intercapsHeader]) {\n            const value = headers.get(key);\n            if (value) {\n                return value;\n            }\n        }\n    }\n    for (const [key, value] of Object.entries(headers)) {\n        if (key.toLowerCase() === lowerCasedHeader) {\n            if (Array.isArray(value)) {\n                if (value.length <= 1)\n                    return value[0];\n                console.warn(`Received ${value.length} entries for the ${header} header, using the first entry.`);\n                return value[0];\n            }\n            return value;\n        }\n    }\n    return undefined;\n};\n/**\n * Encodes a string to Base64 format.\n */\nexport const toBase64 = (str) => {\n    if (!str)\n        return '';\n    if (typeof Buffer !== 'undefined') {\n        return Buffer.from(str).toString('base64');\n    }\n    if (typeof btoa !== 'undefined') {\n        return btoa(str);\n    }\n    throw new OpenAIError('Cannot generate b64 string; Expected `Buffer` or `btoa` to be defined');\n};\nexport function isObj(obj) {\n    return obj != null && typeof obj === 'object' && !Array.isArray(obj);\n}\n//# sourceMappingURL=core.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { AbstractPage } from \"./core.mjs\";\n/**\n * Note: no pagination actually occurs yet, this is for forwards-compatibility.\n */\nexport class Page extends AbstractPage {\n    constructor(client, response, body, options) {\n        super(client, response, body, options);\n        this.data = body.data || [];\n        this.object = body.object;\n    }\n    getPaginatedItems() {\n        return this.data ?? [];\n    }\n    // @deprecated Please use `nextPageInfo()` instead\n    /**\n     * This page represents a response that isn't actually paginated at the API level\n     * so there will never be any next page params.\n     */\n    nextPageParams() {\n        return null;\n    }\n    nextPageInfo() {\n        return null;\n    }\n}\nexport class CursorPage extends AbstractPage {\n    constructor(client, response, body, options) {\n        super(client, response, body, options);\n        this.data = body.data || [];\n    }\n    getPaginatedItems() {\n        return this.data ?? [];\n    }\n    // @deprecated Please use `nextPageInfo()` instead\n    nextPageParams() {\n        const info = this.nextPageInfo();\n        if (!info)\n            return null;\n        if ('params' in info)\n            return info.params;\n        const params = Object.fromEntries(info.url.searchParams);\n        if (!Object.keys(params).length)\n            return null;\n        return params;\n    }\n    nextPageInfo() {\n        const data = this.getPaginatedItems();\n        if (!data.length) {\n            return null;\n        }\n        const id = data[data.length - 1]?.id;\n        if (!id) {\n            return null;\n        }\n        return { params: { after: id } };\n    }\n}\n//# sourceMappingURL=pagination.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nexport class APIResource {\n    constructor(client) {\n        this._client = client;\n    }\n}\n//# sourceMappingURL=resource.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nexport class Completions extends APIResource {\n    create(body, options) {\n        return this._client.post('/chat/completions', { body, ...options, stream: body.stream ?? false });\n    }\n}\n//# sourceMappingURL=completions.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as CompletionsAPI from \"./completions.mjs\";\nimport { Completions, } from \"./completions.mjs\";\nexport class Chat extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.completions = new CompletionsAPI.Completions(this._client);\n    }\n}\nChat.Completions = Completions;\n//# sourceMappingURL=chat.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nexport class Speech extends APIResource {\n    /**\n     * Generates audio from the input text.\n     */\n    create(body, options) {\n        return this._client.post('/audio/speech', { body, ...options, __binaryResponse: true });\n    }\n}\n//# sourceMappingURL=speech.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as Core from \"../../core.mjs\";\nexport class Transcriptions extends APIResource {\n    create(body, options) {\n        return this._client.post('/audio/transcriptions', Core.multipartFormRequestOptions({ body, ...options }));\n    }\n}\n//# sourceMappingURL=transcriptions.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as Core from \"../../core.mjs\";\nexport class Translations extends APIResource {\n    create(body, options) {\n        return this._client.post('/audio/translations', Core.multipartFormRequestOptions({ body, ...options }));\n    }\n}\n//# sourceMappingURL=translations.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as SpeechAPI from \"./speech.mjs\";\nimport { Speech } from \"./speech.mjs\";\nimport * as TranscriptionsAPI from \"./transcriptions.mjs\";\nimport { Transcriptions, } from \"./transcriptions.mjs\";\nimport * as TranslationsAPI from \"./translations.mjs\";\nimport { Translations, } from \"./translations.mjs\";\nexport class Audio extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.transcriptions = new TranscriptionsAPI.Transcriptions(this._client);\n        this.translations = new TranslationsAPI.Translations(this._client);\n        this.speech = new SpeechAPI.Speech(this._client);\n    }\n}\nAudio.Transcriptions = Transcriptions;\nAudio.Translations = Translations;\nAudio.Speech = Speech;\n//# sourceMappingURL=audio.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nimport { isRequestOptions } from \"../core.mjs\";\nimport { CursorPage } from \"../pagination.mjs\";\nexport class Batches extends APIResource {\n    /**\n     * Creates and executes a batch from an uploaded file of requests\n     */\n    create(body, options) {\n        return this._client.post('/batches', { body, ...options });\n    }\n    /**\n     * Retrieves a batch.\n     */\n    retrieve(batchId, options) {\n        return this._client.get(`/batches/${batchId}`, options);\n    }\n    list(query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list({}, query);\n        }\n        return this._client.getAPIList('/batches', BatchesPage, { query, ...options });\n    }\n    /**\n     * Cancels an in-progress batch. The batch will be in status `cancelling` for up to\n     * 10 minutes, before changing to `cancelled`, where it will have partial results\n     * (if any) available in the output file.\n     */\n    cancel(batchId, options) {\n        return this._client.post(`/batches/${batchId}/cancel`, options);\n    }\n}\nexport class BatchesPage extends CursorPage {\n}\nBatches.BatchesPage = BatchesPage;\n//# sourceMappingURL=batches.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport { isRequestOptions } from \"../../core.mjs\";\nimport { CursorPage } from \"../../pagination.mjs\";\nexport class Assistants extends APIResource {\n    /**\n     * Create an assistant with a model and instructions.\n     */\n    create(body, options) {\n        return this._client.post('/assistants', {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Retrieves an assistant.\n     */\n    retrieve(assistantId, options) {\n        return this._client.get(`/assistants/${assistantId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Modifies an assistant.\n     */\n    update(assistantId, body, options) {\n        return this._client.post(`/assistants/${assistantId}`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    list(query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list({}, query);\n        }\n        return this._client.getAPIList('/assistants', AssistantsPage, {\n            query,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Delete an assistant.\n     */\n    del(assistantId, options) {\n        return this._client.delete(`/assistants/${assistantId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n}\nexport class AssistantsPage extends CursorPage {\n}\nAssistants.AssistantsPage = AssistantsPage;\n//# sourceMappingURL=assistants.mjs.map","export function isRunnableFunctionWithParse(fn) {\n    return typeof fn.parse === 'function';\n}\n/**\n * This is helper class for passing a `function` and `parse` where the `function`\n * argument type matches the `parse` return type.\n *\n * @deprecated - please use ParsingToolFunction instead.\n */\nexport class ParsingFunction {\n    constructor(input) {\n        this.function = input.function;\n        this.parse = input.parse;\n        this.parameters = input.parameters;\n        this.description = input.description;\n        this.name = input.name;\n    }\n}\n/**\n * This is helper class for passing a `function` and `parse` where the `function`\n * argument type matches the `parse` return type.\n */\nexport class ParsingToolFunction {\n    constructor(input) {\n        this.type = 'function';\n        this.function = input;\n    }\n}\n//# sourceMappingURL=RunnableFunction.mjs.map","export const isAssistantMessage = (message) => {\n    return message?.role === 'assistant';\n};\nexport const isFunctionMessage = (message) => {\n    return message?.role === 'function';\n};\nexport const isToolMessage = (message) => {\n    return message?.role === 'tool';\n};\nexport function isPresent(obj) {\n    return obj != null;\n}\n//# sourceMappingURL=chatCompletionUtils.mjs.map","var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _EventStream_instances, _EventStream_connectedPromise, _EventStream_resolveConnectedPromise, _EventStream_rejectConnectedPromise, _EventStream_endPromise, _EventStream_resolveEndPromise, _EventStream_rejectEndPromise, _EventStream_listeners, _EventStream_ended, _EventStream_errored, _EventStream_aborted, _EventStream_catchingPromiseCreated, _EventStream_handleError;\nimport { APIUserAbortError, OpenAIError } from \"../error.mjs\";\nexport class EventStream {\n    constructor() {\n        _EventStream_instances.add(this);\n        this.controller = new AbortController();\n        _EventStream_connectedPromise.set(this, void 0);\n        _EventStream_resolveConnectedPromise.set(this, () => { });\n        _EventStream_rejectConnectedPromise.set(this, () => { });\n        _EventStream_endPromise.set(this, void 0);\n        _EventStream_resolveEndPromise.set(this, () => { });\n        _EventStream_rejectEndPromise.set(this, () => { });\n        _EventStream_listeners.set(this, {});\n        _EventStream_ended.set(this, false);\n        _EventStream_errored.set(this, false);\n        _EventStream_aborted.set(this, false);\n        _EventStream_catchingPromiseCreated.set(this, false);\n        __classPrivateFieldSet(this, _EventStream_connectedPromise, new Promise((resolve, reject) => {\n            __classPrivateFieldSet(this, _EventStream_resolveConnectedPromise, resolve, \"f\");\n            __classPrivateFieldSet(this, _EventStream_rejectConnectedPromise, reject, \"f\");\n        }), \"f\");\n        __classPrivateFieldSet(this, _EventStream_endPromise, new Promise((resolve, reject) => {\n            __classPrivateFieldSet(this, _EventStream_resolveEndPromise, resolve, \"f\");\n            __classPrivateFieldSet(this, _EventStream_rejectEndPromise, reject, \"f\");\n        }), \"f\");\n        // Don't let these promises cause unhandled rejection errors.\n        // we will manually cause an unhandled rejection error later\n        // if the user hasn't registered any error listener or called\n        // any promise-returning method.\n        __classPrivateFieldGet(this, _EventStream_connectedPromise, \"f\").catch(() => { });\n        __classPrivateFieldGet(this, _EventStream_endPromise, \"f\").catch(() => { });\n    }\n    _run(executor) {\n        // Unfortunately if we call `executor()` immediately we get runtime errors about\n        // references to `this` before the `super()` constructor call returns.\n        setTimeout(() => {\n            executor().then(() => {\n                this._emitFinal();\n                this._emit('end');\n            }, __classPrivateFieldGet(this, _EventStream_instances, \"m\", _EventStream_handleError).bind(this));\n        }, 0);\n    }\n    _connected() {\n        if (this.ended)\n            return;\n        __classPrivateFieldGet(this, _EventStream_resolveConnectedPromise, \"f\").call(this);\n        this._emit('connect');\n    }\n    get ended() {\n        return __classPrivateFieldGet(this, _EventStream_ended, \"f\");\n    }\n    get errored() {\n        return __classPrivateFieldGet(this, _EventStream_errored, \"f\");\n    }\n    get aborted() {\n        return __classPrivateFieldGet(this, _EventStream_aborted, \"f\");\n    }\n    abort() {\n        this.controller.abort();\n    }\n    /**\n     * Adds the listener function to the end of the listeners array for the event.\n     * No checks are made to see if the listener has already been added. Multiple calls passing\n     * the same combination of event and listener will result in the listener being added, and\n     * called, multiple times.\n     * @returns this ChatCompletionStream, so that calls can be chained\n     */\n    on(event, listener) {\n        const listeners = __classPrivateFieldGet(this, _EventStream_listeners, \"f\")[event] || (__classPrivateFieldGet(this, _EventStream_listeners, \"f\")[event] = []);\n        listeners.push({ listener });\n        return this;\n    }\n    /**\n     * Removes the specified listener from the listener array for the event.\n     * off() will remove, at most, one instance of a listener from the listener array. If any single\n     * listener has been added multiple times to the listener array for the specified event, then\n     * off() must be called multiple times to remove each instance.\n     * @returns this ChatCompletionStream, so that calls can be chained\n     */\n    off(event, listener) {\n        const listeners = __classPrivateFieldGet(this, _EventStream_listeners, \"f\")[event];\n        if (!listeners)\n            return this;\n        const index = listeners.findIndex((l) => l.listener === listener);\n        if (index >= 0)\n            listeners.splice(index, 1);\n        return this;\n    }\n    /**\n     * Adds a one-time listener function for the event. The next time the event is triggered,\n     * this listener is removed and then invoked.\n     * @returns this ChatCompletionStream, so that calls can be chained\n     */\n    once(event, listener) {\n        const listeners = __classPrivateFieldGet(this, _EventStream_listeners, \"f\")[event] || (__classPrivateFieldGet(this, _EventStream_listeners, \"f\")[event] = []);\n        listeners.push({ listener, once: true });\n        return this;\n    }\n    /**\n     * This is similar to `.once()`, but returns a Promise that resolves the next time\n     * the event is triggered, instead of calling a listener callback.\n     * @returns a Promise that resolves the next time given event is triggered,\n     * or rejects if an error is emitted.  (If you request the 'error' event,\n     * returns a promise that resolves with the error).\n     *\n     * Example:\n     *\n     *   const message = await stream.emitted('message') // rejects if the stream errors\n     */\n    emitted(event) {\n        return new Promise((resolve, reject) => {\n            __classPrivateFieldSet(this, _EventStream_catchingPromiseCreated, true, \"f\");\n            if (event !== 'error')\n                this.once('error', reject);\n            this.once(event, resolve);\n        });\n    }\n    async done() {\n        __classPrivateFieldSet(this, _EventStream_catchingPromiseCreated, true, \"f\");\n        await __classPrivateFieldGet(this, _EventStream_endPromise, \"f\");\n    }\n    _emit(event, ...args) {\n        // make sure we don't emit any events after end\n        if (__classPrivateFieldGet(this, _EventStream_ended, \"f\")) {\n            return;\n        }\n        if (event === 'end') {\n            __classPrivateFieldSet(this, _EventStream_ended, true, \"f\");\n            __classPrivateFieldGet(this, _EventStream_resolveEndPromise, \"f\").call(this);\n        }\n        const listeners = __classPrivateFieldGet(this, _EventStream_listeners, \"f\")[event];\n        if (listeners) {\n            __classPrivateFieldGet(this, _EventStream_listeners, \"f\")[event] = listeners.filter((l) => !l.once);\n            listeners.forEach(({ listener }) => listener(...args));\n        }\n        if (event === 'abort') {\n            const error = args[0];\n            if (!__classPrivateFieldGet(this, _EventStream_catchingPromiseCreated, \"f\") && !listeners?.length) {\n                Promise.reject(error);\n            }\n            __classPrivateFieldGet(this, _EventStream_rejectConnectedPromise, \"f\").call(this, error);\n            __classPrivateFieldGet(this, _EventStream_rejectEndPromise, \"f\").call(this, error);\n            this._emit('end');\n            return;\n        }\n        if (event === 'error') {\n            // NOTE: _emit('error', error) should only be called from #handleError().\n            const error = args[0];\n            if (!__classPrivateFieldGet(this, _EventStream_catchingPromiseCreated, \"f\") && !listeners?.length) {\n                // Trigger an unhandled rejection if the user hasn't registered any error handlers.\n                // If you are seeing stack traces here, make sure to handle errors via either:\n                // - runner.on('error', () => ...)\n                // - await runner.done()\n                // - await runner.finalChatCompletion()\n                // - etc.\n                Promise.reject(error);\n            }\n            __classPrivateFieldGet(this, _EventStream_rejectConnectedPromise, \"f\").call(this, error);\n            __classPrivateFieldGet(this, _EventStream_rejectEndPromise, \"f\").call(this, error);\n            this._emit('end');\n        }\n    }\n    _emitFinal() { }\n}\n_EventStream_connectedPromise = new WeakMap(), _EventStream_resolveConnectedPromise = new WeakMap(), _EventStream_rejectConnectedPromise = new WeakMap(), _EventStream_endPromise = new WeakMap(), _EventStream_resolveEndPromise = new WeakMap(), _EventStream_rejectEndPromise = new WeakMap(), _EventStream_listeners = new WeakMap(), _EventStream_ended = new WeakMap(), _EventStream_errored = new WeakMap(), _EventStream_aborted = new WeakMap(), _EventStream_catchingPromiseCreated = new WeakMap(), _EventStream_instances = new WeakSet(), _EventStream_handleError = function _EventStream_handleError(error) {\n    __classPrivateFieldSet(this, _EventStream_errored, true, \"f\");\n    if (error instanceof Error && error.name === 'AbortError') {\n        error = new APIUserAbortError();\n    }\n    if (error instanceof APIUserAbortError) {\n        __classPrivateFieldSet(this, _EventStream_aborted, true, \"f\");\n        return this._emit('abort', error);\n    }\n    if (error instanceof OpenAIError) {\n        return this._emit('error', error);\n    }\n    if (error instanceof Error) {\n        const openAIError = new OpenAIError(error.message);\n        // @ts-ignore\n        openAIError.cause = error;\n        return this._emit('error', openAIError);\n    }\n    return this._emit('error', new OpenAIError(String(error)));\n};\n//# sourceMappingURL=EventStream.mjs.map","import { ContentFilterFinishReasonError, LengthFinishReasonError, OpenAIError } from \"../error.mjs\";\nexport function makeParseableResponseFormat(response_format, parser) {\n    const obj = { ...response_format };\n    Object.defineProperties(obj, {\n        $brand: {\n            value: 'auto-parseable-response-format',\n            enumerable: false,\n        },\n        $parseRaw: {\n            value: parser,\n            enumerable: false,\n        },\n    });\n    return obj;\n}\nexport function isAutoParsableResponseFormat(response_format) {\n    return response_format?.['$brand'] === 'auto-parseable-response-format';\n}\nexport function makeParseableTool(tool, { parser, callback, }) {\n    const obj = { ...tool };\n    Object.defineProperties(obj, {\n        $brand: {\n            value: 'auto-parseable-tool',\n            enumerable: false,\n        },\n        $parseRaw: {\n            value: parser,\n            enumerable: false,\n        },\n        $callback: {\n            value: callback,\n            enumerable: false,\n        },\n    });\n    return obj;\n}\nexport function isAutoParsableTool(tool) {\n    return tool?.['$brand'] === 'auto-parseable-tool';\n}\nexport function maybeParseChatCompletion(completion, params) {\n    if (!params || !hasAutoParseableInput(params)) {\n        return {\n            ...completion,\n            choices: completion.choices.map((choice) => ({\n                ...choice,\n                message: { ...choice.message, parsed: null, tool_calls: choice.message.tool_calls ?? [] },\n            })),\n        };\n    }\n    return parseChatCompletion(completion, params);\n}\nexport function parseChatCompletion(completion, params) {\n    const choices = completion.choices.map((choice) => {\n        if (choice.finish_reason === 'length') {\n            throw new LengthFinishReasonError();\n        }\n        if (choice.finish_reason === 'content_filter') {\n            throw new ContentFilterFinishReasonError();\n        }\n        return {\n            ...choice,\n            message: {\n                ...choice.message,\n                tool_calls: choice.message.tool_calls?.map((toolCall) => parseToolCall(params, toolCall)) ?? [],\n                parsed: choice.message.content && !choice.message.refusal ?\n                    parseResponseFormat(params, choice.message.content)\n                    : null,\n            },\n        };\n    });\n    return { ...completion, choices };\n}\nfunction parseResponseFormat(params, content) {\n    if (params.response_format?.type !== 'json_schema') {\n        return null;\n    }\n    if (params.response_format?.type === 'json_schema') {\n        if ('$parseRaw' in params.response_format) {\n            const response_format = params.response_format;\n            return response_format.$parseRaw(content);\n        }\n        return JSON.parse(content);\n    }\n    return null;\n}\nfunction parseToolCall(params, toolCall) {\n    const inputTool = params.tools?.find((inputTool) => inputTool.function?.name === toolCall.function.name);\n    return {\n        ...toolCall,\n        function: {\n            ...toolCall.function,\n            parsed_arguments: isAutoParsableTool(inputTool) ? inputTool.$parseRaw(toolCall.function.arguments)\n                : inputTool?.function.strict ? JSON.parse(toolCall.function.arguments)\n                    : null,\n        },\n    };\n}\nexport function shouldParseToolCall(params, toolCall) {\n    if (!params) {\n        return false;\n    }\n    const inputTool = params.tools?.find((inputTool) => inputTool.function?.name === toolCall.function.name);\n    return isAutoParsableTool(inputTool) || inputTool?.function.strict || false;\n}\nexport function hasAutoParseableInput(params) {\n    if (isAutoParsableResponseFormat(params.response_format)) {\n        return true;\n    }\n    return (params.tools?.some((t) => isAutoParsableTool(t) || (t.type === 'function' && t.function.strict === true)) ?? false);\n}\nexport function validateInputTools(tools) {\n    for (const tool of tools ?? []) {\n        if (tool.type !== 'function') {\n            throw new OpenAIError(`Currently only \\`function\\` tool types support auto-parsing; Received \\`${tool.type}\\``);\n        }\n        if (tool.function.strict !== true) {\n            throw new OpenAIError(`The \\`${tool.function.name}\\` tool is not marked with \\`strict: true\\`. Only strict function tools can be auto-parsed`);\n        }\n    }\n}\n//# sourceMappingURL=parser.mjs.map","var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _AbstractChatCompletionRunner_instances, _AbstractChatCompletionRunner_getFinalContent, _AbstractChatCompletionRunner_getFinalMessage, _AbstractChatCompletionRunner_getFinalFunctionCall, _AbstractChatCompletionRunner_getFinalFunctionCallResult, _AbstractChatCompletionRunner_calculateTotalUsage, _AbstractChatCompletionRunner_validateParams, _AbstractChatCompletionRunner_stringifyFunctionCallResult;\nimport { OpenAIError } from \"../error.mjs\";\nimport { isRunnableFunctionWithParse, } from \"./RunnableFunction.mjs\";\nimport { isAssistantMessage, isFunctionMessage, isToolMessage } from \"./chatCompletionUtils.mjs\";\nimport { EventStream } from \"./EventStream.mjs\";\nimport { isAutoParsableTool, parseChatCompletion } from \"../lib/parser.mjs\";\nconst DEFAULT_MAX_CHAT_COMPLETIONS = 10;\nexport class AbstractChatCompletionRunner extends EventStream {\n    constructor() {\n        super(...arguments);\n        _AbstractChatCompletionRunner_instances.add(this);\n        this._chatCompletions = [];\n        this.messages = [];\n    }\n    _addChatCompletion(chatCompletion) {\n        this._chatCompletions.push(chatCompletion);\n        this._emit('chatCompletion', chatCompletion);\n        const message = chatCompletion.choices[0]?.message;\n        if (message)\n            this._addMessage(message);\n        return chatCompletion;\n    }\n    _addMessage(message, emit = true) {\n        if (!('content' in message))\n            message.content = null;\n        this.messages.push(message);\n        if (emit) {\n            this._emit('message', message);\n            if ((isFunctionMessage(message) || isToolMessage(message)) && message.content) {\n                // Note, this assumes that {role: 'tool', content: } is always the result of a call of tool of type=function.\n                this._emit('functionCallResult', message.content);\n            }\n            else if (isAssistantMessage(message) && message.function_call) {\n                this._emit('functionCall', message.function_call);\n            }\n            else if (isAssistantMessage(message) && message.tool_calls) {\n                for (const tool_call of message.tool_calls) {\n                    if (tool_call.type === 'function') {\n                        this._emit('functionCall', tool_call.function);\n                    }\n                }\n            }\n        }\n    }\n    /**\n     * @returns a promise that resolves with the final ChatCompletion, or rejects\n     * if an error occurred or the stream ended prematurely without producing a ChatCompletion.\n     */\n    async finalChatCompletion() {\n        await this.done();\n        const completion = this._chatCompletions[this._chatCompletions.length - 1];\n        if (!completion)\n            throw new OpenAIError('stream ended without producing a ChatCompletion');\n        return completion;\n    }\n    /**\n     * @returns a promise that resolves with the content of the final ChatCompletionMessage, or rejects\n     * if an error occurred or the stream ended prematurely without producing a ChatCompletionMessage.\n     */\n    async finalContent() {\n        await this.done();\n        return __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalContent).call(this);\n    }\n    /**\n     * @returns a promise that resolves with the the final assistant ChatCompletionMessage response,\n     * or rejects if an error occurred or the stream ended prematurely without producing a ChatCompletionMessage.\n     */\n    async finalMessage() {\n        await this.done();\n        return __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalMessage).call(this);\n    }\n    /**\n     * @returns a promise that resolves with the content of the final FunctionCall, or rejects\n     * if an error occurred or the stream ended prematurely without producing a ChatCompletionMessage.\n     */\n    async finalFunctionCall() {\n        await this.done();\n        return __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalFunctionCall).call(this);\n    }\n    async finalFunctionCallResult() {\n        await this.done();\n        return __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalFunctionCallResult).call(this);\n    }\n    async totalUsage() {\n        await this.done();\n        return __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_calculateTotalUsage).call(this);\n    }\n    allChatCompletions() {\n        return [...this._chatCompletions];\n    }\n    _emitFinal() {\n        const completion = this._chatCompletions[this._chatCompletions.length - 1];\n        if (completion)\n            this._emit('finalChatCompletion', completion);\n        const finalMessage = __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalMessage).call(this);\n        if (finalMessage)\n            this._emit('finalMessage', finalMessage);\n        const finalContent = __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalContent).call(this);\n        if (finalContent)\n            this._emit('finalContent', finalContent);\n        const finalFunctionCall = __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalFunctionCall).call(this);\n        if (finalFunctionCall)\n            this._emit('finalFunctionCall', finalFunctionCall);\n        const finalFunctionCallResult = __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalFunctionCallResult).call(this);\n        if (finalFunctionCallResult != null)\n            this._emit('finalFunctionCallResult', finalFunctionCallResult);\n        if (this._chatCompletions.some((c) => c.usage)) {\n            this._emit('totalUsage', __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_calculateTotalUsage).call(this));\n        }\n    }\n    async _createChatCompletion(client, params, options) {\n        const signal = options?.signal;\n        if (signal) {\n            if (signal.aborted)\n                this.controller.abort();\n            signal.addEventListener('abort', () => this.controller.abort());\n        }\n        __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_validateParams).call(this, params);\n        const chatCompletion = await client.chat.completions.create({ ...params, stream: false }, { ...options, signal: this.controller.signal });\n        this._connected();\n        return this._addChatCompletion(parseChatCompletion(chatCompletion, params));\n    }\n    async _runChatCompletion(client, params, options) {\n        for (const message of params.messages) {\n            this._addMessage(message, false);\n        }\n        return await this._createChatCompletion(client, params, options);\n    }\n    async _runFunctions(client, params, options) {\n        const role = 'function';\n        const { function_call = 'auto', stream, ...restParams } = params;\n        const singleFunctionToCall = typeof function_call !== 'string' && function_call?.name;\n        const { maxChatCompletions = DEFAULT_MAX_CHAT_COMPLETIONS } = options || {};\n        const functionsByName = {};\n        for (const f of params.functions) {\n            functionsByName[f.name || f.function.name] = f;\n        }\n        const functions = params.functions.map((f) => ({\n            name: f.name || f.function.name,\n            parameters: f.parameters,\n            description: f.description,\n        }));\n        for (const message of params.messages) {\n            this._addMessage(message, false);\n        }\n        for (let i = 0; i < maxChatCompletions; ++i) {\n            const chatCompletion = await this._createChatCompletion(client, {\n                ...restParams,\n                function_call,\n                functions,\n                messages: [...this.messages],\n            }, options);\n            const message = chatCompletion.choices[0]?.message;\n            if (!message) {\n                throw new OpenAIError(`missing message in ChatCompletion response`);\n            }\n            if (!message.function_call)\n                return;\n            const { name, arguments: args } = message.function_call;\n            const fn = functionsByName[name];\n            if (!fn) {\n                const content = `Invalid function_call: ${JSON.stringify(name)}. Available options are: ${functions\n                    .map((f) => JSON.stringify(f.name))\n                    .join(', ')}. Please try again`;\n                this._addMessage({ role, name, content });\n                continue;\n            }\n            else if (singleFunctionToCall && singleFunctionToCall !== name) {\n                const content = `Invalid function_call: ${JSON.stringify(name)}. ${JSON.stringify(singleFunctionToCall)} requested. Please try again`;\n                this._addMessage({ role, name, content });\n                continue;\n            }\n            let parsed;\n            try {\n                parsed = isRunnableFunctionWithParse(fn) ? await fn.parse(args) : args;\n            }\n            catch (error) {\n                this._addMessage({\n                    role,\n                    name,\n                    content: error instanceof Error ? error.message : String(error),\n                });\n                continue;\n            }\n            // @ts-expect-error it can't rule out `never` type.\n            const rawContent = await fn.function(parsed, this);\n            const content = __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_stringifyFunctionCallResult).call(this, rawContent);\n            this._addMessage({ role, name, content });\n            if (singleFunctionToCall)\n                return;\n        }\n    }\n    async _runTools(client, params, options) {\n        const role = 'tool';\n        const { tool_choice = 'auto', stream, ...restParams } = params;\n        const singleFunctionToCall = typeof tool_choice !== 'string' && tool_choice?.function?.name;\n        const { maxChatCompletions = DEFAULT_MAX_CHAT_COMPLETIONS } = options || {};\n        // TODO(someday): clean this logic up\n        const inputTools = params.tools.map((tool) => {\n            if (isAutoParsableTool(tool)) {\n                if (!tool.$callback) {\n                    throw new OpenAIError('Tool given to `.runTools()` that does not have an associated function');\n                }\n                return {\n                    type: 'function',\n                    function: {\n                        function: tool.$callback,\n                        name: tool.function.name,\n                        description: tool.function.description || '',\n                        parameters: tool.function.parameters,\n                        parse: tool.$parseRaw,\n                        strict: true,\n                    },\n                };\n            }\n            return tool;\n        });\n        const functionsByName = {};\n        for (const f of inputTools) {\n            if (f.type === 'function') {\n                functionsByName[f.function.name || f.function.function.name] = f.function;\n            }\n        }\n        const tools = 'tools' in params ?\n            inputTools.map((t) => t.type === 'function' ?\n                {\n                    type: 'function',\n                    function: {\n                        name: t.function.name || t.function.function.name,\n                        parameters: t.function.parameters,\n                        description: t.function.description,\n                        strict: t.function.strict,\n                    },\n                }\n                : t)\n            : undefined;\n        for (const message of params.messages) {\n            this._addMessage(message, false);\n        }\n        for (let i = 0; i < maxChatCompletions; ++i) {\n            const chatCompletion = await this._createChatCompletion(client, {\n                ...restParams,\n                tool_choice,\n                tools,\n                messages: [...this.messages],\n            }, options);\n            const message = chatCompletion.choices[0]?.message;\n            if (!message) {\n                throw new OpenAIError(`missing message in ChatCompletion response`);\n            }\n            if (!message.tool_calls?.length) {\n                return;\n            }\n            for (const tool_call of message.tool_calls) {\n                if (tool_call.type !== 'function')\n                    continue;\n                const tool_call_id = tool_call.id;\n                const { name, arguments: args } = tool_call.function;\n                const fn = functionsByName[name];\n                if (!fn) {\n                    const content = `Invalid tool_call: ${JSON.stringify(name)}. Available options are: ${Object.keys(functionsByName)\n                        .map((name) => JSON.stringify(name))\n                        .join(', ')}. Please try again`;\n                    this._addMessage({ role, tool_call_id, content });\n                    continue;\n                }\n                else if (singleFunctionToCall && singleFunctionToCall !== name) {\n                    const content = `Invalid tool_call: ${JSON.stringify(name)}. ${JSON.stringify(singleFunctionToCall)} requested. Please try again`;\n                    this._addMessage({ role, tool_call_id, content });\n                    continue;\n                }\n                let parsed;\n                try {\n                    parsed = isRunnableFunctionWithParse(fn) ? await fn.parse(args) : args;\n                }\n                catch (error) {\n                    const content = error instanceof Error ? error.message : String(error);\n                    this._addMessage({ role, tool_call_id, content });\n                    continue;\n                }\n                // @ts-expect-error it can't rule out `never` type.\n                const rawContent = await fn.function(parsed, this);\n                const content = __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_stringifyFunctionCallResult).call(this, rawContent);\n                this._addMessage({ role, tool_call_id, content });\n                if (singleFunctionToCall) {\n                    return;\n                }\n            }\n        }\n        return;\n    }\n}\n_AbstractChatCompletionRunner_instances = new WeakSet(), _AbstractChatCompletionRunner_getFinalContent = function _AbstractChatCompletionRunner_getFinalContent() {\n    return __classPrivateFieldGet(this, _AbstractChatCompletionRunner_instances, \"m\", _AbstractChatCompletionRunner_getFinalMessage).call(this).content ?? null;\n}, _AbstractChatCompletionRunner_getFinalMessage = function _AbstractChatCompletionRunner_getFinalMessage() {\n    let i = this.messages.length;\n    while (i-- > 0) {\n        const message = this.messages[i];\n        if (isAssistantMessage(message)) {\n            const { function_call, ...rest } = message;\n            // TODO: support audio here\n            const ret = {\n                ...rest,\n                content: message.content ?? null,\n                refusal: message.refusal ?? null,\n            };\n            if (function_call) {\n                ret.function_call = function_call;\n            }\n            return ret;\n        }\n    }\n    throw new OpenAIError('stream ended without producing a ChatCompletionMessage with role=assistant');\n}, _AbstractChatCompletionRunner_getFinalFunctionCall = function _AbstractChatCompletionRunner_getFinalFunctionCall() {\n    for (let i = this.messages.length - 1; i >= 0; i--) {\n        const message = this.messages[i];\n        if (isAssistantMessage(message) && message?.function_call) {\n            return message.function_call;\n        }\n        if (isAssistantMessage(message) && message?.tool_calls?.length) {\n            return message.tool_calls.at(-1)?.function;\n        }\n    }\n    return;\n}, _AbstractChatCompletionRunner_getFinalFunctionCallResult = function _AbstractChatCompletionRunner_getFinalFunctionCallResult() {\n    for (let i = this.messages.length - 1; i >= 0; i--) {\n        const message = this.messages[i];\n        if (isFunctionMessage(message) && message.content != null) {\n            return message.content;\n        }\n        if (isToolMessage(message) &&\n            message.content != null &&\n            typeof message.content === 'string' &&\n            this.messages.some((x) => x.role === 'assistant' &&\n                x.tool_calls?.some((y) => y.type === 'function' && y.id === message.tool_call_id))) {\n            return message.content;\n        }\n    }\n    return;\n}, _AbstractChatCompletionRunner_calculateTotalUsage = function _AbstractChatCompletionRunner_calculateTotalUsage() {\n    const total = {\n        completion_tokens: 0,\n        prompt_tokens: 0,\n        total_tokens: 0,\n    };\n    for (const { usage } of this._chatCompletions) {\n        if (usage) {\n            total.completion_tokens += usage.completion_tokens;\n            total.prompt_tokens += usage.prompt_tokens;\n            total.total_tokens += usage.total_tokens;\n        }\n    }\n    return total;\n}, _AbstractChatCompletionRunner_validateParams = function _AbstractChatCompletionRunner_validateParams(params) {\n    if (params.n != null && params.n > 1) {\n        throw new OpenAIError('ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.');\n    }\n}, _AbstractChatCompletionRunner_stringifyFunctionCallResult = function _AbstractChatCompletionRunner_stringifyFunctionCallResult(rawContent) {\n    return (typeof rawContent === 'string' ? rawContent\n        : rawContent === undefined ? 'undefined'\n            : JSON.stringify(rawContent));\n};\n//# sourceMappingURL=AbstractChatCompletionRunner.mjs.map","import { AbstractChatCompletionRunner, } from \"./AbstractChatCompletionRunner.mjs\";\nimport { isAssistantMessage } from \"./chatCompletionUtils.mjs\";\nexport class ChatCompletionRunner extends AbstractChatCompletionRunner {\n    /** @deprecated - please use `runTools` instead. */\n    static runFunctions(client, params, options) {\n        const runner = new ChatCompletionRunner();\n        const opts = {\n            ...options,\n            headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'runFunctions' },\n        };\n        runner._run(() => runner._runFunctions(client, params, opts));\n        return runner;\n    }\n    static runTools(client, params, options) {\n        const runner = new ChatCompletionRunner();\n        const opts = {\n            ...options,\n            headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'runTools' },\n        };\n        runner._run(() => runner._runTools(client, params, opts));\n        return runner;\n    }\n    _addMessage(message, emit = true) {\n        super._addMessage(message, emit);\n        if (isAssistantMessage(message) && message.content) {\n            this._emit('content', message.content);\n        }\n    }\n}\n//# sourceMappingURL=ChatCompletionRunner.mjs.map","const STR = 0b000000001;\nconst NUM = 0b000000010;\nconst ARR = 0b000000100;\nconst OBJ = 0b000001000;\nconst NULL = 0b000010000;\nconst BOOL = 0b000100000;\nconst NAN = 0b001000000;\nconst INFINITY = 0b010000000;\nconst MINUS_INFINITY = 0b100000000;\nconst INF = INFINITY | MINUS_INFINITY;\nconst SPECIAL = NULL | BOOL | INF | NAN;\nconst ATOM = STR | NUM | SPECIAL;\nconst COLLECTION = ARR | OBJ;\nconst ALL = ATOM | COLLECTION;\nconst Allow = {\n    STR,\n    NUM,\n    ARR,\n    OBJ,\n    NULL,\n    BOOL,\n    NAN,\n    INFINITY,\n    MINUS_INFINITY,\n    INF,\n    SPECIAL,\n    ATOM,\n    COLLECTION,\n    ALL,\n};\n// The JSON string segment was unable to be parsed completely\nclass PartialJSON extends Error {\n}\nclass MalformedJSON extends Error {\n}\n/**\n * Parse incomplete JSON\n * @param {string} jsonString Partial JSON to be parsed\n * @param {number} allowPartial Specify what types are allowed to be partial, see {@link Allow} for details\n * @returns The parsed JSON\n * @throws {PartialJSON} If the JSON is incomplete (related to the `allow` parameter)\n * @throws {MalformedJSON} If the JSON is malformed\n */\nfunction parseJSON(jsonString, allowPartial = Allow.ALL) {\n    if (typeof jsonString !== 'string') {\n        throw new TypeError(`expecting str, got ${typeof jsonString}`);\n    }\n    if (!jsonString.trim()) {\n        throw new Error(`${jsonString} is empty`);\n    }\n    return _parseJSON(jsonString.trim(), allowPartial);\n}\nconst _parseJSON = (jsonString, allow) => {\n    const length = jsonString.length;\n    let index = 0;\n    const markPartialJSON = (msg) => {\n        throw new PartialJSON(`${msg} at position ${index}`);\n    };\n    const throwMalformedError = (msg) => {\n        throw new MalformedJSON(`${msg} at position ${index}`);\n    };\n    const parseAny = () => {\n        skipBlank();\n        if (index >= length)\n            markPartialJSON('Unexpected end of input');\n        if (jsonString[index] === '\"')\n            return parseStr();\n        if (jsonString[index] === '{')\n            return parseObj();\n        if (jsonString[index] === '[')\n            return parseArr();\n        if (jsonString.substring(index, index + 4) === 'null' ||\n            (Allow.NULL & allow && length - index < 4 && 'null'.startsWith(jsonString.substring(index)))) {\n            index += 4;\n            return null;\n        }\n        if (jsonString.substring(index, index + 4) === 'true' ||\n            (Allow.BOOL & allow && length - index < 4 && 'true'.startsWith(jsonString.substring(index)))) {\n            index += 4;\n            return true;\n        }\n        if (jsonString.substring(index, index + 5) === 'false' ||\n            (Allow.BOOL & allow && length - index < 5 && 'false'.startsWith(jsonString.substring(index)))) {\n            index += 5;\n            return false;\n        }\n        if (jsonString.substring(index, index + 8) === 'Infinity' ||\n            (Allow.INFINITY & allow && length - index < 8 && 'Infinity'.startsWith(jsonString.substring(index)))) {\n            index += 8;\n            return Infinity;\n        }\n        if (jsonString.substring(index, index + 9) === '-Infinity' ||\n            (Allow.MINUS_INFINITY & allow &&\n                1 < length - index &&\n                length - index < 9 &&\n                '-Infinity'.startsWith(jsonString.substring(index)))) {\n            index += 9;\n            return -Infinity;\n        }\n        if (jsonString.substring(index, index + 3) === 'NaN' ||\n            (Allow.NAN & allow && length - index < 3 && 'NaN'.startsWith(jsonString.substring(index)))) {\n            index += 3;\n            return NaN;\n        }\n        return parseNum();\n    };\n    const parseStr = () => {\n        const start = index;\n        let escape = false;\n        index++; // skip initial quote\n        while (index < length && (jsonString[index] !== '\"' || (escape && jsonString[index - 1] === '\\\\'))) {\n            escape = jsonString[index] === '\\\\' ? !escape : false;\n            index++;\n        }\n        if (jsonString.charAt(index) == '\"') {\n            try {\n                return JSON.parse(jsonString.substring(start, ++index - Number(escape)));\n            }\n            catch (e) {\n                throwMalformedError(String(e));\n            }\n        }\n        else if (Allow.STR & allow) {\n            try {\n                return JSON.parse(jsonString.substring(start, index - Number(escape)) + '\"');\n            }\n            catch (e) {\n                // SyntaxError: Invalid escape sequence\n                return JSON.parse(jsonString.substring(start, jsonString.lastIndexOf('\\\\')) + '\"');\n            }\n        }\n        markPartialJSON('Unterminated string literal');\n    };\n    const parseObj = () => {\n        index++; // skip initial brace\n        skipBlank();\n        const obj = {};\n        try {\n            while (jsonString[index] !== '}') {\n                skipBlank();\n                if (index >= length && Allow.OBJ & allow)\n                    return obj;\n                const key = parseStr();\n                skipBlank();\n                index++; // skip colon\n                try {\n                    const value = parseAny();\n                    Object.defineProperty(obj, key, { value, writable: true, enumerable: true, configurable: true });\n                }\n                catch (e) {\n                    if (Allow.OBJ & allow)\n                        return obj;\n                    else\n                        throw e;\n                }\n                skipBlank();\n                if (jsonString[index] === ',')\n                    index++; // skip comma\n            }\n        }\n        catch (e) {\n            if (Allow.OBJ & allow)\n                return obj;\n            else\n                markPartialJSON(\"Expected '}' at end of object\");\n        }\n        index++; // skip final brace\n        return obj;\n    };\n    const parseArr = () => {\n        index++; // skip initial bracket\n        const arr = [];\n        try {\n            while (jsonString[index] !== ']') {\n                arr.push(parseAny());\n                skipBlank();\n                if (jsonString[index] === ',') {\n                    index++; // skip comma\n                }\n            }\n        }\n        catch (e) {\n            if (Allow.ARR & allow) {\n                return arr;\n            }\n            markPartialJSON(\"Expected ']' at end of array\");\n        }\n        index++; // skip final bracket\n        return arr;\n    };\n    const parseNum = () => {\n        if (index === 0) {\n            if (jsonString === '-' && Allow.NUM & allow)\n                markPartialJSON(\"Not sure what '-' is\");\n            try {\n                return JSON.parse(jsonString);\n            }\n            catch (e) {\n                if (Allow.NUM & allow) {\n                    try {\n                        if ('.' === jsonString[jsonString.length - 1])\n                            return JSON.parse(jsonString.substring(0, jsonString.lastIndexOf('.')));\n                        return JSON.parse(jsonString.substring(0, jsonString.lastIndexOf('e')));\n                    }\n                    catch (e) { }\n                }\n                throwMalformedError(String(e));\n            }\n        }\n        const start = index;\n        if (jsonString[index] === '-')\n            index++;\n        while (jsonString[index] && !',]}'.includes(jsonString[index]))\n            index++;\n        if (index == length && !(Allow.NUM & allow))\n            markPartialJSON('Unterminated number literal');\n        try {\n            return JSON.parse(jsonString.substring(start, index));\n        }\n        catch (e) {\n            if (jsonString.substring(start, index) === '-' && Allow.NUM & allow)\n                markPartialJSON(\"Not sure what '-' is\");\n            try {\n                return JSON.parse(jsonString.substring(start, jsonString.lastIndexOf('e')));\n            }\n            catch (e) {\n                throwMalformedError(String(e));\n            }\n        }\n    };\n    const skipBlank = () => {\n        while (index < length && ' \\n\\r\\t'.includes(jsonString[index])) {\n            index++;\n        }\n    };\n    return parseAny();\n};\n// using this function with malformed JSON is undefined behavior\nconst partialParse = (input) => parseJSON(input, Allow.ALL ^ Allow.NUM);\nexport { partialParse, PartialJSON, MalformedJSON };\n//# sourceMappingURL=parser.mjs.map","var __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar _ChatCompletionStream_instances, _ChatCompletionStream_params, _ChatCompletionStream_choiceEventStates, _ChatCompletionStream_currentChatCompletionSnapshot, _ChatCompletionStream_beginRequest, _ChatCompletionStream_getChoiceEventState, _ChatCompletionStream_addChunk, _ChatCompletionStream_emitToolCallDoneEvent, _ChatCompletionStream_emitContentDoneEvents, _ChatCompletionStream_endRequest, _ChatCompletionStream_getAutoParseableResponseFormat, _ChatCompletionStream_accumulateChatCompletion;\nimport { OpenAIError, APIUserAbortError, LengthFinishReasonError, ContentFilterFinishReasonError, } from \"../error.mjs\";\nimport { AbstractChatCompletionRunner, } from \"./AbstractChatCompletionRunner.mjs\";\nimport { Stream } from \"../streaming.mjs\";\nimport { hasAutoParseableInput, isAutoParsableResponseFormat, isAutoParsableTool, maybeParseChatCompletion, shouldParseToolCall, } from \"../lib/parser.mjs\";\nimport { partialParse } from \"../_vendor/partial-json-parser/parser.mjs\";\nexport class ChatCompletionStream extends AbstractChatCompletionRunner {\n    constructor(params) {\n        super();\n        _ChatCompletionStream_instances.add(this);\n        _ChatCompletionStream_params.set(this, void 0);\n        _ChatCompletionStream_choiceEventStates.set(this, void 0);\n        _ChatCompletionStream_currentChatCompletionSnapshot.set(this, void 0);\n        __classPrivateFieldSet(this, _ChatCompletionStream_params, params, \"f\");\n        __classPrivateFieldSet(this, _ChatCompletionStream_choiceEventStates, [], \"f\");\n    }\n    get currentChatCompletionSnapshot() {\n        return __classPrivateFieldGet(this, _ChatCompletionStream_currentChatCompletionSnapshot, \"f\");\n    }\n    /**\n     * Intended for use on the frontend, consuming a stream produced with\n     * `.toReadableStream()` on the backend.\n     *\n     * Note that messages sent to the model do not appear in `.on('message')`\n     * in this context.\n     */\n    static fromReadableStream(stream) {\n        const runner = new ChatCompletionStream(null);\n        runner._run(() => runner._fromReadableStream(stream));\n        return runner;\n    }\n    static createChatCompletion(client, params, options) {\n        const runner = new ChatCompletionStream(params);\n        runner._run(() => runner._runChatCompletion(client, { ...params, stream: true }, { ...options, headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'stream' } }));\n        return runner;\n    }\n    async _createChatCompletion(client, params, options) {\n        super._createChatCompletion;\n        const signal = options?.signal;\n        if (signal) {\n            if (signal.aborted)\n                this.controller.abort();\n            signal.addEventListener('abort', () => this.controller.abort());\n        }\n        __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_beginRequest).call(this);\n        const stream = await client.chat.completions.create({ ...params, stream: true }, { ...options, signal: this.controller.signal });\n        this._connected();\n        for await (const chunk of stream) {\n            __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_addChunk).call(this, chunk);\n        }\n        if (stream.controller.signal?.aborted) {\n            throw new APIUserAbortError();\n        }\n        return this._addChatCompletion(__classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_endRequest).call(this));\n    }\n    async _fromReadableStream(readableStream, options) {\n        const signal = options?.signal;\n        if (signal) {\n            if (signal.aborted)\n                this.controller.abort();\n            signal.addEventListener('abort', () => this.controller.abort());\n        }\n        __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_beginRequest).call(this);\n        this._connected();\n        const stream = Stream.fromReadableStream(readableStream, this.controller);\n        let chatId;\n        for await (const chunk of stream) {\n            if (chatId && chatId !== chunk.id) {\n                // A new request has been made.\n                this._addChatCompletion(__classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_endRequest).call(this));\n            }\n            __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_addChunk).call(this, chunk);\n            chatId = chunk.id;\n        }\n        if (stream.controller.signal?.aborted) {\n            throw new APIUserAbortError();\n        }\n        return this._addChatCompletion(__classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_endRequest).call(this));\n    }\n    [(_ChatCompletionStream_params = new WeakMap(), _ChatCompletionStream_choiceEventStates = new WeakMap(), _ChatCompletionStream_currentChatCompletionSnapshot = new WeakMap(), _ChatCompletionStream_instances = new WeakSet(), _ChatCompletionStream_beginRequest = function _ChatCompletionStream_beginRequest() {\n        if (this.ended)\n            return;\n        __classPrivateFieldSet(this, _ChatCompletionStream_currentChatCompletionSnapshot, undefined, \"f\");\n    }, _ChatCompletionStream_getChoiceEventState = function _ChatCompletionStream_getChoiceEventState(choice) {\n        let state = __classPrivateFieldGet(this, _ChatCompletionStream_choiceEventStates, \"f\")[choice.index];\n        if (state) {\n            return state;\n        }\n        state = {\n            content_done: false,\n            refusal_done: false,\n            logprobs_content_done: false,\n            logprobs_refusal_done: false,\n            done_tool_calls: new Set(),\n            current_tool_call_index: null,\n        };\n        __classPrivateFieldGet(this, _ChatCompletionStream_choiceEventStates, \"f\")[choice.index] = state;\n        return state;\n    }, _ChatCompletionStream_addChunk = function _ChatCompletionStream_addChunk(chunk) {\n        if (this.ended)\n            return;\n        const completion = __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_accumulateChatCompletion).call(this, chunk);\n        this._emit('chunk', chunk, completion);\n        for (const choice of chunk.choices) {\n            const choiceSnapshot = completion.choices[choice.index];\n            if (choice.delta.content != null &&\n                choiceSnapshot.message?.role === 'assistant' &&\n                choiceSnapshot.message?.content) {\n                this._emit('content', choice.delta.content, choiceSnapshot.message.content);\n                this._emit('content.delta', {\n                    delta: choice.delta.content,\n                    snapshot: choiceSnapshot.message.content,\n                    parsed: choiceSnapshot.message.parsed,\n                });\n            }\n            if (choice.delta.refusal != null &&\n                choiceSnapshot.message?.role === 'assistant' &&\n                choiceSnapshot.message?.refusal) {\n                this._emit('refusal.delta', {\n                    delta: choice.delta.refusal,\n                    snapshot: choiceSnapshot.message.refusal,\n                });\n            }\n            if (choice.logprobs?.content != null && choiceSnapshot.message?.role === 'assistant') {\n                this._emit('logprobs.content.delta', {\n                    content: choice.logprobs?.content,\n                    snapshot: choiceSnapshot.logprobs?.content ?? [],\n                });\n            }\n            if (choice.logprobs?.refusal != null && choiceSnapshot.message?.role === 'assistant') {\n                this._emit('logprobs.refusal.delta', {\n                    refusal: choice.logprobs?.refusal,\n                    snapshot: choiceSnapshot.logprobs?.refusal ?? [],\n                });\n            }\n            const state = __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_getChoiceEventState).call(this, choiceSnapshot);\n            if (choiceSnapshot.finish_reason) {\n                __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_emitContentDoneEvents).call(this, choiceSnapshot);\n                if (state.current_tool_call_index != null) {\n                    __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_emitToolCallDoneEvent).call(this, choiceSnapshot, state.current_tool_call_index);\n                }\n            }\n            for (const toolCall of choice.delta.tool_calls ?? []) {\n                if (state.current_tool_call_index !== toolCall.index) {\n                    __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_emitContentDoneEvents).call(this, choiceSnapshot);\n                    // new tool call started, the previous one is done\n                    if (state.current_tool_call_index != null) {\n                        __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_emitToolCallDoneEvent).call(this, choiceSnapshot, state.current_tool_call_index);\n                    }\n                }\n                state.current_tool_call_index = toolCall.index;\n            }\n            for (const toolCallDelta of choice.delta.tool_calls ?? []) {\n                const toolCallSnapshot = choiceSnapshot.message.tool_calls?.[toolCallDelta.index];\n                if (!toolCallSnapshot?.type) {\n                    continue;\n                }\n                if (toolCallSnapshot?.type === 'function') {\n                    this._emit('tool_calls.function.arguments.delta', {\n                        name: toolCallSnapshot.function?.name,\n                        index: toolCallDelta.index,\n                        arguments: toolCallSnapshot.function.arguments,\n                        parsed_arguments: toolCallSnapshot.function.parsed_arguments,\n                        arguments_delta: toolCallDelta.function?.arguments ?? '',\n                    });\n                }\n                else {\n                    assertNever(toolCallSnapshot?.type);\n                }\n            }\n        }\n    }, _ChatCompletionStream_emitToolCallDoneEvent = function _ChatCompletionStream_emitToolCallDoneEvent(choiceSnapshot, toolCallIndex) {\n        const state = __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_getChoiceEventState).call(this, choiceSnapshot);\n        if (state.done_tool_calls.has(toolCallIndex)) {\n            // we've already fired the done event\n            return;\n        }\n        const toolCallSnapshot = choiceSnapshot.message.tool_calls?.[toolCallIndex];\n        if (!toolCallSnapshot) {\n            throw new Error('no tool call snapshot');\n        }\n        if (!toolCallSnapshot.type) {\n            throw new Error('tool call snapshot missing `type`');\n        }\n        if (toolCallSnapshot.type === 'function') {\n            const inputTool = __classPrivateFieldGet(this, _ChatCompletionStream_params, \"f\")?.tools?.find((tool) => tool.type === 'function' && tool.function.name === toolCallSnapshot.function.name);\n            this._emit('tool_calls.function.arguments.done', {\n                name: toolCallSnapshot.function.name,\n                index: toolCallIndex,\n                arguments: toolCallSnapshot.function.arguments,\n                parsed_arguments: isAutoParsableTool(inputTool) ? inputTool.$parseRaw(toolCallSnapshot.function.arguments)\n                    : inputTool?.function.strict ? JSON.parse(toolCallSnapshot.function.arguments)\n                        : null,\n            });\n        }\n        else {\n            assertNever(toolCallSnapshot.type);\n        }\n    }, _ChatCompletionStream_emitContentDoneEvents = function _ChatCompletionStream_emitContentDoneEvents(choiceSnapshot) {\n        const state = __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_getChoiceEventState).call(this, choiceSnapshot);\n        if (choiceSnapshot.message.content && !state.content_done) {\n            state.content_done = true;\n            const responseFormat = __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_getAutoParseableResponseFormat).call(this);\n            this._emit('content.done', {\n                content: choiceSnapshot.message.content,\n                parsed: responseFormat ? responseFormat.$parseRaw(choiceSnapshot.message.content) : null,\n            });\n        }\n        if (choiceSnapshot.message.refusal && !state.refusal_done) {\n            state.refusal_done = true;\n            this._emit('refusal.done', { refusal: choiceSnapshot.message.refusal });\n        }\n        if (choiceSnapshot.logprobs?.content && !state.logprobs_content_done) {\n            state.logprobs_content_done = true;\n            this._emit('logprobs.content.done', { content: choiceSnapshot.logprobs.content });\n        }\n        if (choiceSnapshot.logprobs?.refusal && !state.logprobs_refusal_done) {\n            state.logprobs_refusal_done = true;\n            this._emit('logprobs.refusal.done', { refusal: choiceSnapshot.logprobs.refusal });\n        }\n    }, _ChatCompletionStream_endRequest = function _ChatCompletionStream_endRequest() {\n        if (this.ended) {\n            throw new OpenAIError(`stream has ended, this shouldn't happen`);\n        }\n        const snapshot = __classPrivateFieldGet(this, _ChatCompletionStream_currentChatCompletionSnapshot, \"f\");\n        if (!snapshot) {\n            throw new OpenAIError(`request ended without sending any chunks`);\n        }\n        __classPrivateFieldSet(this, _ChatCompletionStream_currentChatCompletionSnapshot, undefined, \"f\");\n        __classPrivateFieldSet(this, _ChatCompletionStream_choiceEventStates, [], \"f\");\n        return finalizeChatCompletion(snapshot, __classPrivateFieldGet(this, _ChatCompletionStream_params, \"f\"));\n    }, _ChatCompletionStream_getAutoParseableResponseFormat = function _ChatCompletionStream_getAutoParseableResponseFormat() {\n        const responseFormat = __classPrivateFieldGet(this, _ChatCompletionStream_params, \"f\")?.response_format;\n        if (isAutoParsableResponseFormat(responseFormat)) {\n            return responseFormat;\n        }\n        return null;\n    }, _ChatCompletionStream_accumulateChatCompletion = function _ChatCompletionStream_accumulateChatCompletion(chunk) {\n        var _a, _b, _c, _d;\n        let snapshot = __classPrivateFieldGet(this, _ChatCompletionStream_currentChatCompletionSnapshot, \"f\");\n        const { choices, ...rest } = chunk;\n        if (!snapshot) {\n            snapshot = __classPrivateFieldSet(this, _ChatCompletionStream_currentChatCompletionSnapshot, {\n                ...rest,\n                choices: [],\n            }, \"f\");\n        }\n        else {\n            Object.assign(snapshot, rest);\n        }\n        for (const { delta, finish_reason, index, logprobs = null, ...other } of chunk.choices) {\n            let choice = snapshot.choices[index];\n            if (!choice) {\n                choice = snapshot.choices[index] = { finish_reason, index, message: {}, logprobs, ...other };\n            }\n            if (logprobs) {\n                if (!choice.logprobs) {\n                    choice.logprobs = Object.assign({}, logprobs);\n                }\n                else {\n                    const { content, refusal, ...rest } = logprobs;\n                    assertIsEmpty(rest);\n                    Object.assign(choice.logprobs, rest);\n                    if (content) {\n                        (_a = choice.logprobs).content ?? (_a.content = []);\n                        choice.logprobs.content.push(...content);\n                    }\n                    if (refusal) {\n                        (_b = choice.logprobs).refusal ?? (_b.refusal = []);\n                        choice.logprobs.refusal.push(...refusal);\n                    }\n                }\n            }\n            if (finish_reason) {\n                choice.finish_reason = finish_reason;\n                if (__classPrivateFieldGet(this, _ChatCompletionStream_params, \"f\") && hasAutoParseableInput(__classPrivateFieldGet(this, _ChatCompletionStream_params, \"f\"))) {\n                    if (finish_reason === 'length') {\n                        throw new LengthFinishReasonError();\n                    }\n                    if (finish_reason === 'content_filter') {\n                        throw new ContentFilterFinishReasonError();\n                    }\n                }\n            }\n            Object.assign(choice, other);\n            if (!delta)\n                continue; // Shouldn't happen; just in case.\n            const { content, refusal, function_call, role, tool_calls, ...rest } = delta;\n            assertIsEmpty(rest);\n            Object.assign(choice.message, rest);\n            if (refusal) {\n                choice.message.refusal = (choice.message.refusal || '') + refusal;\n            }\n            if (role)\n                choice.message.role = role;\n            if (function_call) {\n                if (!choice.message.function_call) {\n                    choice.message.function_call = function_call;\n                }\n                else {\n                    if (function_call.name)\n                        choice.message.function_call.name = function_call.name;\n                    if (function_call.arguments) {\n                        (_c = choice.message.function_call).arguments ?? (_c.arguments = '');\n                        choice.message.function_call.arguments += function_call.arguments;\n                    }\n                }\n            }\n            if (content) {\n                choice.message.content = (choice.message.content || '') + content;\n                if (!choice.message.refusal && __classPrivateFieldGet(this, _ChatCompletionStream_instances, \"m\", _ChatCompletionStream_getAutoParseableResponseFormat).call(this)) {\n                    choice.message.parsed = partialParse(choice.message.content);\n                }\n            }\n            if (tool_calls) {\n                if (!choice.message.tool_calls)\n                    choice.message.tool_calls = [];\n                for (const { index, id, type, function: fn, ...rest } of tool_calls) {\n                    const tool_call = ((_d = choice.message.tool_calls)[index] ?? (_d[index] = {}));\n                    Object.assign(tool_call, rest);\n                    if (id)\n                        tool_call.id = id;\n                    if (type)\n                        tool_call.type = type;\n                    if (fn)\n                        tool_call.function ?? (tool_call.function = { name: fn.name ?? '', arguments: '' });\n                    if (fn?.name)\n                        tool_call.function.name = fn.name;\n                    if (fn?.arguments) {\n                        tool_call.function.arguments += fn.arguments;\n                        if (shouldParseToolCall(__classPrivateFieldGet(this, _ChatCompletionStream_params, \"f\"), tool_call)) {\n                            tool_call.function.parsed_arguments = partialParse(tool_call.function.arguments);\n                        }\n                    }\n                }\n            }\n        }\n        return snapshot;\n    }, Symbol.asyncIterator)]() {\n        const pushQueue = [];\n        const readQueue = [];\n        let done = false;\n        this.on('chunk', (chunk) => {\n            const reader = readQueue.shift();\n            if (reader) {\n                reader.resolve(chunk);\n            }\n            else {\n                pushQueue.push(chunk);\n            }\n        });\n        this.on('end', () => {\n            done = true;\n            for (const reader of readQueue) {\n                reader.resolve(undefined);\n            }\n            readQueue.length = 0;\n        });\n        this.on('abort', (err) => {\n            done = true;\n            for (const reader of readQueue) {\n                reader.reject(err);\n            }\n            readQueue.length = 0;\n        });\n        this.on('error', (err) => {\n            done = true;\n            for (const reader of readQueue) {\n                reader.reject(err);\n            }\n            readQueue.length = 0;\n        });\n        return {\n            next: async () => {\n                if (!pushQueue.length) {\n                    if (done) {\n                        return { value: undefined, done: true };\n                    }\n                    return new Promise((resolve, reject) => readQueue.push({ resolve, reject })).then((chunk) => (chunk ? { value: chunk, done: false } : { value: undefined, done: true }));\n                }\n                const chunk = pushQueue.shift();\n                return { value: chunk, done: false };\n            },\n            return: async () => {\n                this.abort();\n                return { value: undefined, done: true };\n            },\n        };\n    }\n    toReadableStream() {\n        const stream = new Stream(this[Symbol.asyncIterator].bind(this), this.controller);\n        return stream.toReadableStream();\n    }\n}\nfunction finalizeChatCompletion(snapshot, params) {\n    const { id, choices, created, model, system_fingerprint, ...rest } = snapshot;\n    const completion = {\n        ...rest,\n        id,\n        choices: choices.map(({ message, finish_reason, index, logprobs, ...choiceRest }) => {\n            if (!finish_reason) {\n                throw new OpenAIError(`missing finish_reason for choice ${index}`);\n            }\n            const { content = null, function_call, tool_calls, ...messageRest } = message;\n            const role = message.role; // this is what we expect; in theory it could be different which would make our types a slight lie but would be fine.\n            if (!role) {\n                throw new OpenAIError(`missing role for choice ${index}`);\n            }\n            if (function_call) {\n                const { arguments: args, name } = function_call;\n                if (args == null) {\n                    throw new OpenAIError(`missing function_call.arguments for choice ${index}`);\n                }\n                if (!name) {\n                    throw new OpenAIError(`missing function_call.name for choice ${index}`);\n                }\n                return {\n                    ...choiceRest,\n                    message: {\n                        content,\n                        function_call: { arguments: args, name },\n                        role,\n                        refusal: message.refusal ?? null,\n                    },\n                    finish_reason,\n                    index,\n                    logprobs,\n                };\n            }\n            if (tool_calls) {\n                return {\n                    ...choiceRest,\n                    index,\n                    finish_reason,\n                    logprobs,\n                    message: {\n                        ...messageRest,\n                        role,\n                        content,\n                        refusal: message.refusal ?? null,\n                        tool_calls: tool_calls.map((tool_call, i) => {\n                            const { function: fn, type, id, ...toolRest } = tool_call;\n                            const { arguments: args, name, ...fnRest } = fn || {};\n                            if (id == null) {\n                                throw new OpenAIError(`missing choices[${index}].tool_calls[${i}].id\\n${str(snapshot)}`);\n                            }\n                            if (type == null) {\n                                throw new OpenAIError(`missing choices[${index}].tool_calls[${i}].type\\n${str(snapshot)}`);\n                            }\n                            if (name == null) {\n                                throw new OpenAIError(`missing choices[${index}].tool_calls[${i}].function.name\\n${str(snapshot)}`);\n                            }\n                            if (args == null) {\n                                throw new OpenAIError(`missing choices[${index}].tool_calls[${i}].function.arguments\\n${str(snapshot)}`);\n                            }\n                            return { ...toolRest, id, type, function: { ...fnRest, name, arguments: args } };\n                        }),\n                    },\n                };\n            }\n            return {\n                ...choiceRest,\n                message: { ...messageRest, content, role, refusal: message.refusal ?? null },\n                finish_reason,\n                index,\n                logprobs,\n            };\n        }),\n        created,\n        model,\n        object: 'chat.completion',\n        ...(system_fingerprint ? { system_fingerprint } : {}),\n    };\n    return maybeParseChatCompletion(completion, params);\n}\nfunction str(x) {\n    return JSON.stringify(x);\n}\n/**\n * Ensures the given argument is an empty object, useful for\n * asserting that all known properties on an object have been\n * destructured.\n */\nfunction assertIsEmpty(obj) {\n    return;\n}\nfunction assertNever(_x) { }\n//# sourceMappingURL=ChatCompletionStream.mjs.map","import { ChatCompletionStream } from \"./ChatCompletionStream.mjs\";\nexport class ChatCompletionStreamingRunner extends ChatCompletionStream {\n    static fromReadableStream(stream) {\n        const runner = new ChatCompletionStreamingRunner(null);\n        runner._run(() => runner._fromReadableStream(stream));\n        return runner;\n    }\n    /** @deprecated - please use `runTools` instead. */\n    static runFunctions(client, params, options) {\n        const runner = new ChatCompletionStreamingRunner(null);\n        const opts = {\n            ...options,\n            headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'runFunctions' },\n        };\n        runner._run(() => runner._runFunctions(client, params, opts));\n        return runner;\n    }\n    static runTools(client, params, options) {\n        const runner = new ChatCompletionStreamingRunner(\n        // @ts-expect-error TODO these types are incompatible\n        params);\n        const opts = {\n            ...options,\n            headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'runTools' },\n        };\n        runner._run(() => runner._runTools(client, params, opts));\n        return runner;\n    }\n}\n//# sourceMappingURL=ChatCompletionStreamingRunner.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { ChatCompletionRunner } from \"../../../lib/ChatCompletionRunner.mjs\";\nimport { ChatCompletionStreamingRunner, } from \"../../../lib/ChatCompletionStreamingRunner.mjs\";\nimport { ChatCompletionStream } from \"../../../lib/ChatCompletionStream.mjs\";\nimport { parseChatCompletion, validateInputTools } from \"../../../lib/parser.mjs\";\nexport { ChatCompletionStreamingRunner, } from \"../../../lib/ChatCompletionStreamingRunner.mjs\";\nexport { ParsingFunction, ParsingToolFunction, } from \"../../../lib/RunnableFunction.mjs\";\nexport { ChatCompletionStream } from \"../../../lib/ChatCompletionStream.mjs\";\nexport { ChatCompletionRunner, } from \"../../../lib/ChatCompletionRunner.mjs\";\nexport class Completions extends APIResource {\n    parse(body, options) {\n        validateInputTools(body.tools);\n        return this._client.chat.completions\n            .create(body, {\n            ...options,\n            headers: {\n                ...options?.headers,\n                'X-Stainless-Helper-Method': 'beta.chat.completions.parse',\n            },\n        })\n            ._thenUnwrap((completion) => parseChatCompletion(completion, body));\n    }\n    runFunctions(body, options) {\n        if (body.stream) {\n            return ChatCompletionStreamingRunner.runFunctions(this._client, body, options);\n        }\n        return ChatCompletionRunner.runFunctions(this._client, body, options);\n    }\n    runTools(body, options) {\n        if (body.stream) {\n            return ChatCompletionStreamingRunner.runTools(this._client, body, options);\n        }\n        return ChatCompletionRunner.runTools(this._client, body, options);\n    }\n    /**\n     * Creates a chat completion stream\n     */\n    stream(body, options) {\n        return ChatCompletionStream.createChatCompletion(this._client, body, options);\n    }\n}\n//# sourceMappingURL=completions.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport * as CompletionsAPI from \"./completions.mjs\";\nexport class Chat extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.completions = new CompletionsAPI.Completions(this._client);\n    }\n}\n(function (Chat) {\n    Chat.Completions = CompletionsAPI.Completions;\n})(Chat || (Chat = {}));\n//# sourceMappingURL=chat.mjs.map","var __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar _AssistantStream_instances, _AssistantStream_events, _AssistantStream_runStepSnapshots, _AssistantStream_messageSnapshots, _AssistantStream_messageSnapshot, _AssistantStream_finalRun, _AssistantStream_currentContentIndex, _AssistantStream_currentContent, _AssistantStream_currentToolCallIndex, _AssistantStream_currentToolCall, _AssistantStream_currentEvent, _AssistantStream_currentRunSnapshot, _AssistantStream_currentRunStepSnapshot, _AssistantStream_addEvent, _AssistantStream_endRequest, _AssistantStream_handleMessage, _AssistantStream_handleRunStep, _AssistantStream_handleEvent, _AssistantStream_accumulateRunStep, _AssistantStream_accumulateMessage, _AssistantStream_accumulateContent, _AssistantStream_handleRun;\nimport * as Core from \"../core.mjs\";\nimport { Stream } from \"../streaming.mjs\";\nimport { APIUserAbortError, OpenAIError } from \"../error.mjs\";\nimport { EventStream } from \"./EventStream.mjs\";\nexport class AssistantStream extends EventStream {\n    constructor() {\n        super(...arguments);\n        _AssistantStream_instances.add(this);\n        //Track all events in a single list for reference\n        _AssistantStream_events.set(this, []);\n        //Used to accumulate deltas\n        //We are accumulating many types so the value here is not strict\n        _AssistantStream_runStepSnapshots.set(this, {});\n        _AssistantStream_messageSnapshots.set(this, {});\n        _AssistantStream_messageSnapshot.set(this, void 0);\n        _AssistantStream_finalRun.set(this, void 0);\n        _AssistantStream_currentContentIndex.set(this, void 0);\n        _AssistantStream_currentContent.set(this, void 0);\n        _AssistantStream_currentToolCallIndex.set(this, void 0);\n        _AssistantStream_currentToolCall.set(this, void 0);\n        //For current snapshot methods\n        _AssistantStream_currentEvent.set(this, void 0);\n        _AssistantStream_currentRunSnapshot.set(this, void 0);\n        _AssistantStream_currentRunStepSnapshot.set(this, void 0);\n    }\n    [(_AssistantStream_events = new WeakMap(), _AssistantStream_runStepSnapshots = new WeakMap(), _AssistantStream_messageSnapshots = new WeakMap(), _AssistantStream_messageSnapshot = new WeakMap(), _AssistantStream_finalRun = new WeakMap(), _AssistantStream_currentContentIndex = new WeakMap(), _AssistantStream_currentContent = new WeakMap(), _AssistantStream_currentToolCallIndex = new WeakMap(), _AssistantStream_currentToolCall = new WeakMap(), _AssistantStream_currentEvent = new WeakMap(), _AssistantStream_currentRunSnapshot = new WeakMap(), _AssistantStream_currentRunStepSnapshot = new WeakMap(), _AssistantStream_instances = new WeakSet(), Symbol.asyncIterator)]() {\n        const pushQueue = [];\n        const readQueue = [];\n        let done = false;\n        //Catch all for passing along all events\n        this.on('event', (event) => {\n            const reader = readQueue.shift();\n            if (reader) {\n                reader.resolve(event);\n            }\n            else {\n                pushQueue.push(event);\n            }\n        });\n        this.on('end', () => {\n            done = true;\n            for (const reader of readQueue) {\n                reader.resolve(undefined);\n            }\n            readQueue.length = 0;\n        });\n        this.on('abort', (err) => {\n            done = true;\n            for (const reader of readQueue) {\n                reader.reject(err);\n            }\n            readQueue.length = 0;\n        });\n        this.on('error', (err) => {\n            done = true;\n            for (const reader of readQueue) {\n                reader.reject(err);\n            }\n            readQueue.length = 0;\n        });\n        return {\n            next: async () => {\n                if (!pushQueue.length) {\n                    if (done) {\n                        return { value: undefined, done: true };\n                    }\n                    return new Promise((resolve, reject) => readQueue.push({ resolve, reject })).then((chunk) => (chunk ? { value: chunk, done: false } : { value: undefined, done: true }));\n                }\n                const chunk = pushQueue.shift();\n                return { value: chunk, done: false };\n            },\n            return: async () => {\n                this.abort();\n                return { value: undefined, done: true };\n            },\n        };\n    }\n    static fromReadableStream(stream) {\n        const runner = new AssistantStream();\n        runner._run(() => runner._fromReadableStream(stream));\n        return runner;\n    }\n    async _fromReadableStream(readableStream, options) {\n        const signal = options?.signal;\n        if (signal) {\n            if (signal.aborted)\n                this.controller.abort();\n            signal.addEventListener('abort', () => this.controller.abort());\n        }\n        this._connected();\n        const stream = Stream.fromReadableStream(readableStream, this.controller);\n        for await (const event of stream) {\n            __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_addEvent).call(this, event);\n        }\n        if (stream.controller.signal?.aborted) {\n            throw new APIUserAbortError();\n        }\n        return this._addRun(__classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_endRequest).call(this));\n    }\n    toReadableStream() {\n        const stream = new Stream(this[Symbol.asyncIterator].bind(this), this.controller);\n        return stream.toReadableStream();\n    }\n    static createToolAssistantStream(threadId, runId, runs, params, options) {\n        const runner = new AssistantStream();\n        runner._run(() => runner._runToolAssistantStream(threadId, runId, runs, params, {\n            ...options,\n            headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'stream' },\n        }));\n        return runner;\n    }\n    async _createToolAssistantStream(run, threadId, runId, params, options) {\n        const signal = options?.signal;\n        if (signal) {\n            if (signal.aborted)\n                this.controller.abort();\n            signal.addEventListener('abort', () => this.controller.abort());\n        }\n        const body = { ...params, stream: true };\n        const stream = await run.submitToolOutputs(threadId, runId, body, {\n            ...options,\n            signal: this.controller.signal,\n        });\n        this._connected();\n        for await (const event of stream) {\n            __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_addEvent).call(this, event);\n        }\n        if (stream.controller.signal?.aborted) {\n            throw new APIUserAbortError();\n        }\n        return this._addRun(__classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_endRequest).call(this));\n    }\n    static createThreadAssistantStream(params, thread, options) {\n        const runner = new AssistantStream();\n        runner._run(() => runner._threadAssistantStream(params, thread, {\n            ...options,\n            headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'stream' },\n        }));\n        return runner;\n    }\n    static createAssistantStream(threadId, runs, params, options) {\n        const runner = new AssistantStream();\n        runner._run(() => runner._runAssistantStream(threadId, runs, params, {\n            ...options,\n            headers: { ...options?.headers, 'X-Stainless-Helper-Method': 'stream' },\n        }));\n        return runner;\n    }\n    currentEvent() {\n        return __classPrivateFieldGet(this, _AssistantStream_currentEvent, \"f\");\n    }\n    currentRun() {\n        return __classPrivateFieldGet(this, _AssistantStream_currentRunSnapshot, \"f\");\n    }\n    currentMessageSnapshot() {\n        return __classPrivateFieldGet(this, _AssistantStream_messageSnapshot, \"f\");\n    }\n    currentRunStepSnapshot() {\n        return __classPrivateFieldGet(this, _AssistantStream_currentRunStepSnapshot, \"f\");\n    }\n    async finalRunSteps() {\n        await this.done();\n        return Object.values(__classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\"));\n    }\n    async finalMessages() {\n        await this.done();\n        return Object.values(__classPrivateFieldGet(this, _AssistantStream_messageSnapshots, \"f\"));\n    }\n    async finalRun() {\n        await this.done();\n        if (!__classPrivateFieldGet(this, _AssistantStream_finalRun, \"f\"))\n            throw Error('Final run was not received.');\n        return __classPrivateFieldGet(this, _AssistantStream_finalRun, \"f\");\n    }\n    async _createThreadAssistantStream(thread, params, options) {\n        const signal = options?.signal;\n        if (signal) {\n            if (signal.aborted)\n                this.controller.abort();\n            signal.addEventListener('abort', () => this.controller.abort());\n        }\n        const body = { ...params, stream: true };\n        const stream = await thread.createAndRun(body, { ...options, signal: this.controller.signal });\n        this._connected();\n        for await (const event of stream) {\n            __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_addEvent).call(this, event);\n        }\n        if (stream.controller.signal?.aborted) {\n            throw new APIUserAbortError();\n        }\n        return this._addRun(__classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_endRequest).call(this));\n    }\n    async _createAssistantStream(run, threadId, params, options) {\n        const signal = options?.signal;\n        if (signal) {\n            if (signal.aborted)\n                this.controller.abort();\n            signal.addEventListener('abort', () => this.controller.abort());\n        }\n        const body = { ...params, stream: true };\n        const stream = await run.create(threadId, body, { ...options, signal: this.controller.signal });\n        this._connected();\n        for await (const event of stream) {\n            __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_addEvent).call(this, event);\n        }\n        if (stream.controller.signal?.aborted) {\n            throw new APIUserAbortError();\n        }\n        return this._addRun(__classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_endRequest).call(this));\n    }\n    static accumulateDelta(acc, delta) {\n        for (const [key, deltaValue] of Object.entries(delta)) {\n            if (!acc.hasOwnProperty(key)) {\n                acc[key] = deltaValue;\n                continue;\n            }\n            let accValue = acc[key];\n            if (accValue === null || accValue === undefined) {\n                acc[key] = deltaValue;\n                continue;\n            }\n            // We don't accumulate these special properties\n            if (key === 'index' || key === 'type') {\n                acc[key] = deltaValue;\n                continue;\n            }\n            // Type-specific accumulation logic\n            if (typeof accValue === 'string' && typeof deltaValue === 'string') {\n                accValue += deltaValue;\n            }\n            else if (typeof accValue === 'number' && typeof deltaValue === 'number') {\n                accValue += deltaValue;\n            }\n            else if (Core.isObj(accValue) && Core.isObj(deltaValue)) {\n                accValue = this.accumulateDelta(accValue, deltaValue);\n            }\n            else if (Array.isArray(accValue) && Array.isArray(deltaValue)) {\n                if (accValue.every((x) => typeof x === 'string' || typeof x === 'number')) {\n                    accValue.push(...deltaValue); // Use spread syntax for efficient addition\n                    continue;\n                }\n                for (const deltaEntry of deltaValue) {\n                    if (!Core.isObj(deltaEntry)) {\n                        throw new Error(`Expected array delta entry to be an object but got: ${deltaEntry}`);\n                    }\n                    const index = deltaEntry['index'];\n                    if (index == null) {\n                        console.error(deltaEntry);\n                        throw new Error('Expected array delta entry to have an `index` property');\n                    }\n                    if (typeof index !== 'number') {\n                        throw new Error(`Expected array delta entry \\`index\\` property to be a number but got ${index}`);\n                    }\n                    const accEntry = accValue[index];\n                    if (accEntry == null) {\n                        accValue.push(deltaEntry);\n                    }\n                    else {\n                        accValue[index] = this.accumulateDelta(accEntry, deltaEntry);\n                    }\n                }\n                continue;\n            }\n            else {\n                throw Error(`Unhandled record type: ${key}, deltaValue: ${deltaValue}, accValue: ${accValue}`);\n            }\n            acc[key] = accValue;\n        }\n        return acc;\n    }\n    _addRun(run) {\n        return run;\n    }\n    async _threadAssistantStream(params, thread, options) {\n        return await this._createThreadAssistantStream(thread, params, options);\n    }\n    async _runAssistantStream(threadId, runs, params, options) {\n        return await this._createAssistantStream(runs, threadId, params, options);\n    }\n    async _runToolAssistantStream(threadId, runId, runs, params, options) {\n        return await this._createToolAssistantStream(runs, threadId, runId, params, options);\n    }\n}\n_AssistantStream_addEvent = function _AssistantStream_addEvent(event) {\n    if (this.ended)\n        return;\n    __classPrivateFieldSet(this, _AssistantStream_currentEvent, event, \"f\");\n    __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_handleEvent).call(this, event);\n    switch (event.event) {\n        case 'thread.created':\n            //No action on this event.\n            break;\n        case 'thread.run.created':\n        case 'thread.run.queued':\n        case 'thread.run.in_progress':\n        case 'thread.run.requires_action':\n        case 'thread.run.completed':\n        case 'thread.run.failed':\n        case 'thread.run.cancelling':\n        case 'thread.run.cancelled':\n        case 'thread.run.expired':\n            __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_handleRun).call(this, event);\n            break;\n        case 'thread.run.step.created':\n        case 'thread.run.step.in_progress':\n        case 'thread.run.step.delta':\n        case 'thread.run.step.completed':\n        case 'thread.run.step.failed':\n        case 'thread.run.step.cancelled':\n        case 'thread.run.step.expired':\n            __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_handleRunStep).call(this, event);\n            break;\n        case 'thread.message.created':\n        case 'thread.message.in_progress':\n        case 'thread.message.delta':\n        case 'thread.message.completed':\n        case 'thread.message.incomplete':\n            __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_handleMessage).call(this, event);\n            break;\n        case 'error':\n            //This is included for completeness, but errors are processed in the SSE event processing so this should not occur\n            throw new Error('Encountered an error event in event processing - errors should be processed earlier');\n    }\n}, _AssistantStream_endRequest = function _AssistantStream_endRequest() {\n    if (this.ended) {\n        throw new OpenAIError(`stream has ended, this shouldn't happen`);\n    }\n    if (!__classPrivateFieldGet(this, _AssistantStream_finalRun, \"f\"))\n        throw Error('Final run has not been received');\n    return __classPrivateFieldGet(this, _AssistantStream_finalRun, \"f\");\n}, _AssistantStream_handleMessage = function _AssistantStream_handleMessage(event) {\n    const [accumulatedMessage, newContent] = __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_accumulateMessage).call(this, event, __classPrivateFieldGet(this, _AssistantStream_messageSnapshot, \"f\"));\n    __classPrivateFieldSet(this, _AssistantStream_messageSnapshot, accumulatedMessage, \"f\");\n    __classPrivateFieldGet(this, _AssistantStream_messageSnapshots, \"f\")[accumulatedMessage.id] = accumulatedMessage;\n    for (const content of newContent) {\n        const snapshotContent = accumulatedMessage.content[content.index];\n        if (snapshotContent?.type == 'text') {\n            this._emit('textCreated', snapshotContent.text);\n        }\n    }\n    switch (event.event) {\n        case 'thread.message.created':\n            this._emit('messageCreated', event.data);\n            break;\n        case 'thread.message.in_progress':\n            break;\n        case 'thread.message.delta':\n            this._emit('messageDelta', event.data.delta, accumulatedMessage);\n            if (event.data.delta.content) {\n                for (const content of event.data.delta.content) {\n                    //If it is text delta, emit a text delta event\n                    if (content.type == 'text' && content.text) {\n                        let textDelta = content.text;\n                        let snapshot = accumulatedMessage.content[content.index];\n                        if (snapshot && snapshot.type == 'text') {\n                            this._emit('textDelta', textDelta, snapshot.text);\n                        }\n                        else {\n                            throw Error('The snapshot associated with this text delta is not text or missing');\n                        }\n                    }\n                    if (content.index != __classPrivateFieldGet(this, _AssistantStream_currentContentIndex, \"f\")) {\n                        //See if we have in progress content\n                        if (__classPrivateFieldGet(this, _AssistantStream_currentContent, \"f\")) {\n                            switch (__classPrivateFieldGet(this, _AssistantStream_currentContent, \"f\").type) {\n                                case 'text':\n                                    this._emit('textDone', __classPrivateFieldGet(this, _AssistantStream_currentContent, \"f\").text, __classPrivateFieldGet(this, _AssistantStream_messageSnapshot, \"f\"));\n                                    break;\n                                case 'image_file':\n                                    this._emit('imageFileDone', __classPrivateFieldGet(this, _AssistantStream_currentContent, \"f\").image_file, __classPrivateFieldGet(this, _AssistantStream_messageSnapshot, \"f\"));\n                                    break;\n                            }\n                        }\n                        __classPrivateFieldSet(this, _AssistantStream_currentContentIndex, content.index, \"f\");\n                    }\n                    __classPrivateFieldSet(this, _AssistantStream_currentContent, accumulatedMessage.content[content.index], \"f\");\n                }\n            }\n            break;\n        case 'thread.message.completed':\n        case 'thread.message.incomplete':\n            //We emit the latest content we were working on on completion (including incomplete)\n            if (__classPrivateFieldGet(this, _AssistantStream_currentContentIndex, \"f\") !== undefined) {\n                const currentContent = event.data.content[__classPrivateFieldGet(this, _AssistantStream_currentContentIndex, \"f\")];\n                if (currentContent) {\n                    switch (currentContent.type) {\n                        case 'image_file':\n                            this._emit('imageFileDone', currentContent.image_file, __classPrivateFieldGet(this, _AssistantStream_messageSnapshot, \"f\"));\n                            break;\n                        case 'text':\n                            this._emit('textDone', currentContent.text, __classPrivateFieldGet(this, _AssistantStream_messageSnapshot, \"f\"));\n                            break;\n                    }\n                }\n            }\n            if (__classPrivateFieldGet(this, _AssistantStream_messageSnapshot, \"f\")) {\n                this._emit('messageDone', event.data);\n            }\n            __classPrivateFieldSet(this, _AssistantStream_messageSnapshot, undefined, \"f\");\n    }\n}, _AssistantStream_handleRunStep = function _AssistantStream_handleRunStep(event) {\n    const accumulatedRunStep = __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_accumulateRunStep).call(this, event);\n    __classPrivateFieldSet(this, _AssistantStream_currentRunStepSnapshot, accumulatedRunStep, \"f\");\n    switch (event.event) {\n        case 'thread.run.step.created':\n            this._emit('runStepCreated', event.data);\n            break;\n        case 'thread.run.step.delta':\n            const delta = event.data.delta;\n            if (delta.step_details &&\n                delta.step_details.type == 'tool_calls' &&\n                delta.step_details.tool_calls &&\n                accumulatedRunStep.step_details.type == 'tool_calls') {\n                for (const toolCall of delta.step_details.tool_calls) {\n                    if (toolCall.index == __classPrivateFieldGet(this, _AssistantStream_currentToolCallIndex, \"f\")) {\n                        this._emit('toolCallDelta', toolCall, accumulatedRunStep.step_details.tool_calls[toolCall.index]);\n                    }\n                    else {\n                        if (__classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\")) {\n                            this._emit('toolCallDone', __classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\"));\n                        }\n                        __classPrivateFieldSet(this, _AssistantStream_currentToolCallIndex, toolCall.index, \"f\");\n                        __classPrivateFieldSet(this, _AssistantStream_currentToolCall, accumulatedRunStep.step_details.tool_calls[toolCall.index], \"f\");\n                        if (__classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\"))\n                            this._emit('toolCallCreated', __classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\"));\n                    }\n                }\n            }\n            this._emit('runStepDelta', event.data.delta, accumulatedRunStep);\n            break;\n        case 'thread.run.step.completed':\n        case 'thread.run.step.failed':\n        case 'thread.run.step.cancelled':\n        case 'thread.run.step.expired':\n            __classPrivateFieldSet(this, _AssistantStream_currentRunStepSnapshot, undefined, \"f\");\n            const details = event.data.step_details;\n            if (details.type == 'tool_calls') {\n                if (__classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\")) {\n                    this._emit('toolCallDone', __classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\"));\n                    __classPrivateFieldSet(this, _AssistantStream_currentToolCall, undefined, \"f\");\n                }\n            }\n            this._emit('runStepDone', event.data, accumulatedRunStep);\n            break;\n        case 'thread.run.step.in_progress':\n            break;\n    }\n}, _AssistantStream_handleEvent = function _AssistantStream_handleEvent(event) {\n    __classPrivateFieldGet(this, _AssistantStream_events, \"f\").push(event);\n    this._emit('event', event);\n}, _AssistantStream_accumulateRunStep = function _AssistantStream_accumulateRunStep(event) {\n    switch (event.event) {\n        case 'thread.run.step.created':\n            __classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\")[event.data.id] = event.data;\n            return event.data;\n        case 'thread.run.step.delta':\n            let snapshot = __classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\")[event.data.id];\n            if (!snapshot) {\n                throw Error('Received a RunStepDelta before creation of a snapshot');\n            }\n            let data = event.data;\n            if (data.delta) {\n                const accumulated = AssistantStream.accumulateDelta(snapshot, data.delta);\n                __classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\")[event.data.id] = accumulated;\n            }\n            return __classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\")[event.data.id];\n        case 'thread.run.step.completed':\n        case 'thread.run.step.failed':\n        case 'thread.run.step.cancelled':\n        case 'thread.run.step.expired':\n        case 'thread.run.step.in_progress':\n            __classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\")[event.data.id] = event.data;\n            break;\n    }\n    if (__classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\")[event.data.id])\n        return __classPrivateFieldGet(this, _AssistantStream_runStepSnapshots, \"f\")[event.data.id];\n    throw new Error('No snapshot available');\n}, _AssistantStream_accumulateMessage = function _AssistantStream_accumulateMessage(event, snapshot) {\n    let newContent = [];\n    switch (event.event) {\n        case 'thread.message.created':\n            //On creation the snapshot is just the initial message\n            return [event.data, newContent];\n        case 'thread.message.delta':\n            if (!snapshot) {\n                throw Error('Received a delta with no existing snapshot (there should be one from message creation)');\n            }\n            let data = event.data;\n            //If this delta does not have content, nothing to process\n            if (data.delta.content) {\n                for (const contentElement of data.delta.content) {\n                    if (contentElement.index in snapshot.content) {\n                        let currentContent = snapshot.content[contentElement.index];\n                        snapshot.content[contentElement.index] = __classPrivateFieldGet(this, _AssistantStream_instances, \"m\", _AssistantStream_accumulateContent).call(this, contentElement, currentContent);\n                    }\n                    else {\n                        snapshot.content[contentElement.index] = contentElement;\n                        // This is a new element\n                        newContent.push(contentElement);\n                    }\n                }\n            }\n            return [snapshot, newContent];\n        case 'thread.message.in_progress':\n        case 'thread.message.completed':\n        case 'thread.message.incomplete':\n            //No changes on other thread events\n            if (snapshot) {\n                return [snapshot, newContent];\n            }\n            else {\n                throw Error('Received thread message event with no existing snapshot');\n            }\n    }\n    throw Error('Tried to accumulate a non-message event');\n}, _AssistantStream_accumulateContent = function _AssistantStream_accumulateContent(contentElement, currentContent) {\n    return AssistantStream.accumulateDelta(currentContent, contentElement);\n}, _AssistantStream_handleRun = function _AssistantStream_handleRun(event) {\n    __classPrivateFieldSet(this, _AssistantStream_currentRunSnapshot, event.data, \"f\");\n    switch (event.event) {\n        case 'thread.run.created':\n            break;\n        case 'thread.run.queued':\n            break;\n        case 'thread.run.in_progress':\n            break;\n        case 'thread.run.requires_action':\n        case 'thread.run.cancelled':\n        case 'thread.run.failed':\n        case 'thread.run.completed':\n        case 'thread.run.expired':\n            __classPrivateFieldSet(this, _AssistantStream_finalRun, event.data, \"f\");\n            if (__classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\")) {\n                this._emit('toolCallDone', __classPrivateFieldGet(this, _AssistantStream_currentToolCall, \"f\"));\n                __classPrivateFieldSet(this, _AssistantStream_currentToolCall, undefined, \"f\");\n            }\n            break;\n        case 'thread.run.cancelling':\n            break;\n    }\n};\n//# sourceMappingURL=AssistantStream.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../core.mjs\";\nimport { CursorPage } from \"../../../pagination.mjs\";\nexport class Messages extends APIResource {\n    /**\n     * Create a message.\n     */\n    create(threadId, body, options) {\n        return this._client.post(`/threads/${threadId}/messages`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Retrieve a message.\n     */\n    retrieve(threadId, messageId, options) {\n        return this._client.get(`/threads/${threadId}/messages/${messageId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Modifies a message.\n     */\n    update(threadId, messageId, body, options) {\n        return this._client.post(`/threads/${threadId}/messages/${messageId}`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    list(threadId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list(threadId, {}, query);\n        }\n        return this._client.getAPIList(`/threads/${threadId}/messages`, MessagesPage, {\n            query,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Deletes a message.\n     */\n    del(threadId, messageId, options) {\n        return this._client.delete(`/threads/${threadId}/messages/${messageId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n}\nexport class MessagesPage extends CursorPage {\n}\nMessages.MessagesPage = MessagesPage;\n//# sourceMappingURL=messages.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../../core.mjs\";\nimport { CursorPage } from \"../../../../pagination.mjs\";\nexport class Steps extends APIResource {\n    retrieve(threadId, runId, stepId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.retrieve(threadId, runId, stepId, {}, query);\n        }\n        return this._client.get(`/threads/${threadId}/runs/${runId}/steps/${stepId}`, {\n            query,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    list(threadId, runId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list(threadId, runId, {}, query);\n        }\n        return this._client.getAPIList(`/threads/${threadId}/runs/${runId}/steps`, RunStepsPage, {\n            query,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n}\nexport class RunStepsPage extends CursorPage {\n}\nSteps.RunStepsPage = RunStepsPage;\n//# sourceMappingURL=steps.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../../core.mjs\";\nimport { AssistantStream } from \"../../../../lib/AssistantStream.mjs\";\nimport { sleep } from \"../../../../core.mjs\";\nimport * as StepsAPI from \"./steps.mjs\";\nimport { RunStepsPage, Steps, } from \"./steps.mjs\";\nimport { CursorPage } from \"../../../../pagination.mjs\";\nexport class Runs extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.steps = new StepsAPI.Steps(this._client);\n    }\n    create(threadId, params, options) {\n        const { include, ...body } = params;\n        return this._client.post(`/threads/${threadId}/runs`, {\n            query: { include },\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n            stream: params.stream ?? false,\n        });\n    }\n    /**\n     * Retrieves a run.\n     */\n    retrieve(threadId, runId, options) {\n        return this._client.get(`/threads/${threadId}/runs/${runId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Modifies a run.\n     */\n    update(threadId, runId, body, options) {\n        return this._client.post(`/threads/${threadId}/runs/${runId}`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    list(threadId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list(threadId, {}, query);\n        }\n        return this._client.getAPIList(`/threads/${threadId}/runs`, RunsPage, {\n            query,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Cancels a run that is `in_progress`.\n     */\n    cancel(threadId, runId, options) {\n        return this._client.post(`/threads/${threadId}/runs/${runId}/cancel`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * A helper to create a run an poll for a terminal state. More information on Run\n     * lifecycles can be found here:\n     * https://platform.openai.com/docs/assistants/how-it-works/runs-and-run-steps\n     */\n    async createAndPoll(threadId, body, options) {\n        const run = await this.create(threadId, body, options);\n        return await this.poll(threadId, run.id, options);\n    }\n    /**\n     * Create a Run stream\n     *\n     * @deprecated use `stream` instead\n     */\n    createAndStream(threadId, body, options) {\n        return AssistantStream.createAssistantStream(threadId, this._client.beta.threads.runs, body, options);\n    }\n    /**\n     * A helper to poll a run status until it reaches a terminal state. More\n     * information on Run lifecycles can be found here:\n     * https://platform.openai.com/docs/assistants/how-it-works/runs-and-run-steps\n     */\n    async poll(threadId, runId, options) {\n        const headers = { ...options?.headers, 'X-Stainless-Poll-Helper': 'true' };\n        if (options?.pollIntervalMs) {\n            headers['X-Stainless-Custom-Poll-Interval'] = options.pollIntervalMs.toString();\n        }\n        while (true) {\n            const { data: run, response } = await this.retrieve(threadId, runId, {\n                ...options,\n                headers: { ...options?.headers, ...headers },\n            }).withResponse();\n            switch (run.status) {\n                //If we are in any sort of intermediate state we poll\n                case 'queued':\n                case 'in_progress':\n                case 'cancelling':\n                    let sleepInterval = 5000;\n                    if (options?.pollIntervalMs) {\n                        sleepInterval = options.pollIntervalMs;\n                    }\n                    else {\n                        const headerInterval = response.headers.get('openai-poll-after-ms');\n                        if (headerInterval) {\n                            const headerIntervalMs = parseInt(headerInterval);\n                            if (!isNaN(headerIntervalMs)) {\n                                sleepInterval = headerIntervalMs;\n                            }\n                        }\n                    }\n                    await sleep(sleepInterval);\n                    break;\n                //We return the run in any terminal state.\n                case 'requires_action':\n                case 'incomplete':\n                case 'cancelled':\n                case 'completed':\n                case 'failed':\n                case 'expired':\n                    return run;\n            }\n        }\n    }\n    /**\n     * Create a Run stream\n     */\n    stream(threadId, body, options) {\n        return AssistantStream.createAssistantStream(threadId, this._client.beta.threads.runs, body, options);\n    }\n    submitToolOutputs(threadId, runId, body, options) {\n        return this._client.post(`/threads/${threadId}/runs/${runId}/submit_tool_outputs`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n            stream: body.stream ?? false,\n        });\n    }\n    /**\n     * A helper to submit a tool output to a run and poll for a terminal run state.\n     * More information on Run lifecycles can be found here:\n     * https://platform.openai.com/docs/assistants/how-it-works/runs-and-run-steps\n     */\n    async submitToolOutputsAndPoll(threadId, runId, body, options) {\n        const run = await this.submitToolOutputs(threadId, runId, body, options);\n        return await this.poll(threadId, run.id, options);\n    }\n    /**\n     * Submit the tool outputs from a previous run and stream the run to a terminal\n     * state. More information on Run lifecycles can be found here:\n     * https://platform.openai.com/docs/assistants/how-it-works/runs-and-run-steps\n     */\n    submitToolOutputsStream(threadId, runId, body, options) {\n        return AssistantStream.createToolAssistantStream(threadId, runId, this._client.beta.threads.runs, body, options);\n    }\n}\nexport class RunsPage extends CursorPage {\n}\nRuns.RunsPage = RunsPage;\nRuns.Steps = Steps;\nRuns.RunStepsPage = RunStepsPage;\n//# sourceMappingURL=runs.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../core.mjs\";\nimport { AssistantStream } from \"../../../lib/AssistantStream.mjs\";\nimport * as MessagesAPI from \"./messages.mjs\";\nimport { Messages, MessagesPage, } from \"./messages.mjs\";\nimport * as RunsAPI from \"./runs/runs.mjs\";\nimport { Runs, RunsPage, } from \"./runs/runs.mjs\";\nexport class Threads extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.runs = new RunsAPI.Runs(this._client);\n        this.messages = new MessagesAPI.Messages(this._client);\n    }\n    create(body = {}, options) {\n        if (isRequestOptions(body)) {\n            return this.create({}, body);\n        }\n        return this._client.post('/threads', {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Retrieves a thread.\n     */\n    retrieve(threadId, options) {\n        return this._client.get(`/threads/${threadId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Modifies a thread.\n     */\n    update(threadId, body, options) {\n        return this._client.post(`/threads/${threadId}`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Delete a thread.\n     */\n    del(threadId, options) {\n        return this._client.delete(`/threads/${threadId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    createAndRun(body, options) {\n        return this._client.post('/threads/runs', {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n            stream: body.stream ?? false,\n        });\n    }\n    /**\n     * A helper to create a thread, start a run and then poll for a terminal state.\n     * More information on Run lifecycles can be found here:\n     * https://platform.openai.com/docs/assistants/how-it-works/runs-and-run-steps\n     */\n    async createAndRunPoll(body, options) {\n        const run = await this.createAndRun(body, options);\n        return await this.runs.poll(run.thread_id, run.id, options);\n    }\n    /**\n     * Create a thread and stream the run back\n     */\n    createAndRunStream(body, options) {\n        return AssistantStream.createThreadAssistantStream(body, this._client.beta.threads, options);\n    }\n}\nThreads.Runs = Runs;\nThreads.RunsPage = RunsPage;\nThreads.Messages = Messages;\nThreads.MessagesPage = MessagesPage;\n//# sourceMappingURL=threads.mjs.map","/**\n * Like `Promise.allSettled()` but throws an error if any promises are rejected.\n */\nexport const allSettledWithThrow = async (promises) => {\n    const results = await Promise.allSettled(promises);\n    const rejected = results.filter((result) => result.status === 'rejected');\n    if (rejected.length) {\n        for (const result of rejected) {\n            console.error(result.reason);\n        }\n        throw new Error(`${rejected.length} promise(s) failed - see the above errors`);\n    }\n    // Note: TS was complaining about using `.filter().map()` here for some reason\n    const values = [];\n    for (const result of results) {\n        if (result.status === 'fulfilled') {\n            values.push(result.value);\n        }\n    }\n    return values;\n};\n//# sourceMappingURL=Util.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { sleep, isRequestOptions } from \"../../../core.mjs\";\nimport { CursorPage } from \"../../../pagination.mjs\";\nexport class Files extends APIResource {\n    /**\n     * Create a vector store file by attaching a\n     * [File](https://platform.openai.com/docs/api-reference/files) to a\n     * [vector store](https://platform.openai.com/docs/api-reference/vector-stores/object).\n     */\n    create(vectorStoreId, body, options) {\n        return this._client.post(`/vector_stores/${vectorStoreId}/files`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Retrieves a vector store file.\n     */\n    retrieve(vectorStoreId, fileId, options) {\n        return this._client.get(`/vector_stores/${vectorStoreId}/files/${fileId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    list(vectorStoreId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list(vectorStoreId, {}, query);\n        }\n        return this._client.getAPIList(`/vector_stores/${vectorStoreId}/files`, VectorStoreFilesPage, {\n            query,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Delete a vector store file. This will remove the file from the vector store but\n     * the file itself will not be deleted. To delete the file, use the\n     * [delete file](https://platform.openai.com/docs/api-reference/files/delete)\n     * endpoint.\n     */\n    del(vectorStoreId, fileId, options) {\n        return this._client.delete(`/vector_stores/${vectorStoreId}/files/${fileId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Attach a file to the given vector store and wait for it to be processed.\n     */\n    async createAndPoll(vectorStoreId, body, options) {\n        const file = await this.create(vectorStoreId, body, options);\n        return await this.poll(vectorStoreId, file.id, options);\n    }\n    /**\n     * Wait for the vector store file to finish processing.\n     *\n     * Note: this will return even if the file failed to process, you need to check\n     * file.last_error and file.status to handle these cases\n     */\n    async poll(vectorStoreId, fileId, options) {\n        const headers = { ...options?.headers, 'X-Stainless-Poll-Helper': 'true' };\n        if (options?.pollIntervalMs) {\n            headers['X-Stainless-Custom-Poll-Interval'] = options.pollIntervalMs.toString();\n        }\n        while (true) {\n            const fileResponse = await this.retrieve(vectorStoreId, fileId, {\n                ...options,\n                headers,\n            }).withResponse();\n            const file = fileResponse.data;\n            switch (file.status) {\n                case 'in_progress':\n                    let sleepInterval = 5000;\n                    if (options?.pollIntervalMs) {\n                        sleepInterval = options.pollIntervalMs;\n                    }\n                    else {\n                        const headerInterval = fileResponse.response.headers.get('openai-poll-after-ms');\n                        if (headerInterval) {\n                            const headerIntervalMs = parseInt(headerInterval);\n                            if (!isNaN(headerIntervalMs)) {\n                                sleepInterval = headerIntervalMs;\n                            }\n                        }\n                    }\n                    await sleep(sleepInterval);\n                    break;\n                case 'failed':\n                case 'completed':\n                    return file;\n            }\n        }\n    }\n    /**\n     * Upload a file to the `files` API and then attach it to the given vector store.\n     *\n     * Note the file will be asynchronously processed (you can use the alternative\n     * polling helper method to wait for processing to complete).\n     */\n    async upload(vectorStoreId, file, options) {\n        const fileInfo = await this._client.files.create({ file: file, purpose: 'assistants' }, options);\n        return this.create(vectorStoreId, { file_id: fileInfo.id }, options);\n    }\n    /**\n     * Add a file to a vector store and poll until processing is complete.\n     */\n    async uploadAndPoll(vectorStoreId, file, options) {\n        const fileInfo = await this.upload(vectorStoreId, file, options);\n        return await this.poll(vectorStoreId, fileInfo.id, options);\n    }\n}\nexport class VectorStoreFilesPage extends CursorPage {\n}\nFiles.VectorStoreFilesPage = VectorStoreFilesPage;\n//# sourceMappingURL=files.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../core.mjs\";\nimport { sleep } from \"../../../core.mjs\";\nimport { allSettledWithThrow } from \"../../../lib/Util.mjs\";\nimport { VectorStoreFilesPage } from \"./files.mjs\";\nexport class FileBatches extends APIResource {\n    /**\n     * Create a vector store file batch.\n     */\n    create(vectorStoreId, body, options) {\n        return this._client.post(`/vector_stores/${vectorStoreId}/file_batches`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Retrieves a vector store file batch.\n     */\n    retrieve(vectorStoreId, batchId, options) {\n        return this._client.get(`/vector_stores/${vectorStoreId}/file_batches/${batchId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Cancel a vector store file batch. This attempts to cancel the processing of\n     * files in this batch as soon as possible.\n     */\n    cancel(vectorStoreId, batchId, options) {\n        return this._client.post(`/vector_stores/${vectorStoreId}/file_batches/${batchId}/cancel`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Create a vector store batch and poll until all files have been processed.\n     */\n    async createAndPoll(vectorStoreId, body, options) {\n        const batch = await this.create(vectorStoreId, body);\n        return await this.poll(vectorStoreId, batch.id, options);\n    }\n    listFiles(vectorStoreId, batchId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.listFiles(vectorStoreId, batchId, {}, query);\n        }\n        return this._client.getAPIList(`/vector_stores/${vectorStoreId}/file_batches/${batchId}/files`, VectorStoreFilesPage, { query, ...options, headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers } });\n    }\n    /**\n     * Wait for the given file batch to be processed.\n     *\n     * Note: this will return even if one of the files failed to process, you need to\n     * check batch.file_counts.failed_count to handle this case.\n     */\n    async poll(vectorStoreId, batchId, options) {\n        const headers = { ...options?.headers, 'X-Stainless-Poll-Helper': 'true' };\n        if (options?.pollIntervalMs) {\n            headers['X-Stainless-Custom-Poll-Interval'] = options.pollIntervalMs.toString();\n        }\n        while (true) {\n            const { data: batch, response } = await this.retrieve(vectorStoreId, batchId, {\n                ...options,\n                headers,\n            }).withResponse();\n            switch (batch.status) {\n                case 'in_progress':\n                    let sleepInterval = 5000;\n                    if (options?.pollIntervalMs) {\n                        sleepInterval = options.pollIntervalMs;\n                    }\n                    else {\n                        const headerInterval = response.headers.get('openai-poll-after-ms');\n                        if (headerInterval) {\n                            const headerIntervalMs = parseInt(headerInterval);\n                            if (!isNaN(headerIntervalMs)) {\n                                sleepInterval = headerIntervalMs;\n                            }\n                        }\n                    }\n                    await sleep(sleepInterval);\n                    break;\n                case 'failed':\n                case 'cancelled':\n                case 'completed':\n                    return batch;\n            }\n        }\n    }\n    /**\n     * Uploads the given files concurrently and then creates a vector store file batch.\n     *\n     * The concurrency limit is configurable using the `maxConcurrency` parameter.\n     */\n    async uploadAndPoll(vectorStoreId, { files, fileIds = [] }, options) {\n        if (files == null || files.length == 0) {\n            throw new Error(`No \\`files\\` provided to process. If you've already uploaded files you should use \\`.createAndPoll()\\` instead`);\n        }\n        const configuredConcurrency = options?.maxConcurrency ?? 5;\n        // We cap the number of workers at the number of files (so we don't start any unnecessary workers)\n        const concurrencyLimit = Math.min(configuredConcurrency, files.length);\n        const client = this._client;\n        const fileIterator = files.values();\n        const allFileIds = [...fileIds];\n        // This code is based on this design. The libraries don't accommodate our environment limits.\n        // https://stackoverflow.com/questions/40639432/what-is-the-best-way-to-limit-concurrency-when-using-es6s-promise-all\n        async function processFiles(iterator) {\n            for (let item of iterator) {\n                const fileObj = await client.files.create({ file: item, purpose: 'assistants' }, options);\n                allFileIds.push(fileObj.id);\n            }\n        }\n        // Start workers to process results\n        const workers = Array(concurrencyLimit).fill(fileIterator).map(processFiles);\n        // Wait for all processing to complete.\n        await allSettledWithThrow(workers);\n        return await this.createAndPoll(vectorStoreId, {\n            file_ids: allFileIds,\n        });\n    }\n}\nexport { VectorStoreFilesPage };\n//# sourceMappingURL=file-batches.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../core.mjs\";\nimport * as FileBatchesAPI from \"./file-batches.mjs\";\nimport { FileBatches, } from \"./file-batches.mjs\";\nimport * as FilesAPI from \"./files.mjs\";\nimport { Files, VectorStoreFilesPage, } from \"./files.mjs\";\nimport { CursorPage } from \"../../../pagination.mjs\";\nexport class VectorStores extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.files = new FilesAPI.Files(this._client);\n        this.fileBatches = new FileBatchesAPI.FileBatches(this._client);\n    }\n    /**\n     * Create a vector store.\n     */\n    create(body, options) {\n        return this._client.post('/vector_stores', {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Retrieves a vector store.\n     */\n    retrieve(vectorStoreId, options) {\n        return this._client.get(`/vector_stores/${vectorStoreId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Modifies a vector store.\n     */\n    update(vectorStoreId, body, options) {\n        return this._client.post(`/vector_stores/${vectorStoreId}`, {\n            body,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    list(query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list({}, query);\n        }\n        return this._client.getAPIList('/vector_stores', VectorStoresPage, {\n            query,\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n    /**\n     * Delete a vector store.\n     */\n    del(vectorStoreId, options) {\n        return this._client.delete(`/vector_stores/${vectorStoreId}`, {\n            ...options,\n            headers: { 'OpenAI-Beta': 'assistants=v2', ...options?.headers },\n        });\n    }\n}\nexport class VectorStoresPage extends CursorPage {\n}\nVectorStores.VectorStoresPage = VectorStoresPage;\nVectorStores.Files = Files;\nVectorStores.VectorStoreFilesPage = VectorStoreFilesPage;\nVectorStores.FileBatches = FileBatches;\n//# sourceMappingURL=vector-stores.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as AssistantsAPI from \"./assistants.mjs\";\nimport * as ChatAPI from \"./chat/chat.mjs\";\nimport { Assistants, AssistantsPage, } from \"./assistants.mjs\";\nimport * as ThreadsAPI from \"./threads/threads.mjs\";\nimport { Threads, } from \"./threads/threads.mjs\";\nimport * as VectorStoresAPI from \"./vector-stores/vector-stores.mjs\";\nimport { VectorStores, VectorStoresPage, } from \"./vector-stores/vector-stores.mjs\";\nimport { Chat } from \"./chat/chat.mjs\";\nexport class Beta extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.vectorStores = new VectorStoresAPI.VectorStores(this._client);\n        this.chat = new ChatAPI.Chat(this._client);\n        this.assistants = new AssistantsAPI.Assistants(this._client);\n        this.threads = new ThreadsAPI.Threads(this._client);\n    }\n}\nBeta.VectorStores = VectorStores;\nBeta.VectorStoresPage = VectorStoresPage;\nBeta.Assistants = Assistants;\nBeta.AssistantsPage = AssistantsPage;\nBeta.Threads = Threads;\n//# sourceMappingURL=beta.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nexport class Completions extends APIResource {\n    create(body, options) {\n        return this._client.post('/completions', { body, ...options, stream: body.stream ?? false });\n    }\n}\n//# sourceMappingURL=completions.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nexport class Embeddings extends APIResource {\n    /**\n     * Creates an embedding vector representing the input text.\n     */\n    create(body, options) {\n        return this._client.post('/embeddings', { body, ...options });\n    }\n}\n//# sourceMappingURL=embeddings.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nimport { isRequestOptions } from \"../core.mjs\";\nimport { sleep } from \"../core.mjs\";\nimport { APIConnectionTimeoutError } from \"../error.mjs\";\nimport * as Core from \"../core.mjs\";\nimport { CursorPage } from \"../pagination.mjs\";\nexport class Files extends APIResource {\n    /**\n     * Upload a file that can be used across various endpoints. Individual files can be\n     * up to 512 MB, and the size of all files uploaded by one organization can be up\n     * to 100 GB.\n     *\n     * The Assistants API supports files up to 2 million tokens and of specific file\n     * types. See the\n     * [Assistants Tools guide](https://platform.openai.com/docs/assistants/tools) for\n     * details.\n     *\n     * The Fine-tuning API only supports `.jsonl` files. The input also has certain\n     * required formats for fine-tuning\n     * [chat](https://platform.openai.com/docs/api-reference/fine-tuning/chat-input) or\n     * [completions](https://platform.openai.com/docs/api-reference/fine-tuning/completions-input)\n     * models.\n     *\n     * The Batch API only supports `.jsonl` files up to 200 MB in size. The input also\n     * has a specific required\n     * [format](https://platform.openai.com/docs/api-reference/batch/request-input).\n     *\n     * Please [contact us](https://help.openai.com/) if you need to increase these\n     * storage limits.\n     */\n    create(body, options) {\n        return this._client.post('/files', Core.multipartFormRequestOptions({ body, ...options }));\n    }\n    /**\n     * Returns information about a specific file.\n     */\n    retrieve(fileId, options) {\n        return this._client.get(`/files/${fileId}`, options);\n    }\n    list(query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list({}, query);\n        }\n        return this._client.getAPIList('/files', FileObjectsPage, { query, ...options });\n    }\n    /**\n     * Delete a file.\n     */\n    del(fileId, options) {\n        return this._client.delete(`/files/${fileId}`, options);\n    }\n    /**\n     * Returns the contents of the specified file.\n     */\n    content(fileId, options) {\n        return this._client.get(`/files/${fileId}/content`, { ...options, __binaryResponse: true });\n    }\n    /**\n     * Returns the contents of the specified file.\n     *\n     * @deprecated The `.content()` method should be used instead\n     */\n    retrieveContent(fileId, options) {\n        return this._client.get(`/files/${fileId}/content`, {\n            ...options,\n            headers: { Accept: 'application/json', ...options?.headers },\n        });\n    }\n    /**\n     * Waits for the given file to be processed, default timeout is 30 mins.\n     */\n    async waitForProcessing(id, { pollInterval = 5000, maxWait = 30 * 60 * 1000 } = {}) {\n        const TERMINAL_STATES = new Set(['processed', 'error', 'deleted']);\n        const start = Date.now();\n        let file = await this.retrieve(id);\n        while (!file.status || !TERMINAL_STATES.has(file.status)) {\n            await sleep(pollInterval);\n            file = await this.retrieve(id);\n            if (Date.now() - start > maxWait) {\n                throw new APIConnectionTimeoutError({\n                    message: `Giving up on waiting for file ${id} to finish processing after ${maxWait} milliseconds.`,\n                });\n            }\n        }\n        return file;\n    }\n}\nexport class FileObjectsPage extends CursorPage {\n}\nFiles.FileObjectsPage = FileObjectsPage;\n//# sourceMappingURL=files.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../core.mjs\";\nimport { CursorPage } from \"../../../pagination.mjs\";\nexport class Checkpoints extends APIResource {\n    list(fineTuningJobId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list(fineTuningJobId, {}, query);\n        }\n        return this._client.getAPIList(`/fine_tuning/jobs/${fineTuningJobId}/checkpoints`, FineTuningJobCheckpointsPage, { query, ...options });\n    }\n}\nexport class FineTuningJobCheckpointsPage extends CursorPage {\n}\nCheckpoints.FineTuningJobCheckpointsPage = FineTuningJobCheckpointsPage;\n//# sourceMappingURL=checkpoints.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../../resource.mjs\";\nimport { isRequestOptions } from \"../../../core.mjs\";\nimport * as CheckpointsAPI from \"./checkpoints.mjs\";\nimport { Checkpoints, FineTuningJobCheckpointsPage, } from \"./checkpoints.mjs\";\nimport { CursorPage } from \"../../../pagination.mjs\";\nexport class Jobs extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.checkpoints = new CheckpointsAPI.Checkpoints(this._client);\n    }\n    /**\n     * Creates a fine-tuning job which begins the process of creating a new model from\n     * a given dataset.\n     *\n     * Response includes details of the enqueued job including job status and the name\n     * of the fine-tuned models once complete.\n     *\n     * [Learn more about fine-tuning](https://platform.openai.com/docs/guides/fine-tuning)\n     */\n    create(body, options) {\n        return this._client.post('/fine_tuning/jobs', { body, ...options });\n    }\n    /**\n     * Get info about a fine-tuning job.\n     *\n     * [Learn more about fine-tuning](https://platform.openai.com/docs/guides/fine-tuning)\n     */\n    retrieve(fineTuningJobId, options) {\n        return this._client.get(`/fine_tuning/jobs/${fineTuningJobId}`, options);\n    }\n    list(query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.list({}, query);\n        }\n        return this._client.getAPIList('/fine_tuning/jobs', FineTuningJobsPage, { query, ...options });\n    }\n    /**\n     * Immediately cancel a fine-tune job.\n     */\n    cancel(fineTuningJobId, options) {\n        return this._client.post(`/fine_tuning/jobs/${fineTuningJobId}/cancel`, options);\n    }\n    listEvents(fineTuningJobId, query = {}, options) {\n        if (isRequestOptions(query)) {\n            return this.listEvents(fineTuningJobId, {}, query);\n        }\n        return this._client.getAPIList(`/fine_tuning/jobs/${fineTuningJobId}/events`, FineTuningJobEventsPage, {\n            query,\n            ...options,\n        });\n    }\n}\nexport class FineTuningJobsPage extends CursorPage {\n}\nexport class FineTuningJobEventsPage extends CursorPage {\n}\nJobs.FineTuningJobsPage = FineTuningJobsPage;\nJobs.FineTuningJobEventsPage = FineTuningJobEventsPage;\nJobs.Checkpoints = Checkpoints;\nJobs.FineTuningJobCheckpointsPage = FineTuningJobCheckpointsPage;\n//# sourceMappingURL=jobs.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as JobsAPI from \"./jobs/jobs.mjs\";\nimport { FineTuningJobEventsPage, FineTuningJobsPage, Jobs, } from \"./jobs/jobs.mjs\";\nexport class FineTuning extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.jobs = new JobsAPI.Jobs(this._client);\n    }\n}\nFineTuning.Jobs = Jobs;\nFineTuning.FineTuningJobsPage = FineTuningJobsPage;\nFineTuning.FineTuningJobEventsPage = FineTuningJobEventsPage;\n//# sourceMappingURL=fine-tuning.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nimport * as Core from \"../core.mjs\";\nexport class Images extends APIResource {\n    /**\n     * Creates a variation of a given image.\n     */\n    createVariation(body, options) {\n        return this._client.post('/images/variations', Core.multipartFormRequestOptions({ body, ...options }));\n    }\n    /**\n     * Creates an edited or extended image given an original image and a prompt.\n     */\n    edit(body, options) {\n        return this._client.post('/images/edits', Core.multipartFormRequestOptions({ body, ...options }));\n    }\n    /**\n     * Creates an image given a prompt.\n     */\n    generate(body, options) {\n        return this._client.post('/images/generations', { body, ...options });\n    }\n}\n//# sourceMappingURL=images.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nimport { Page } from \"../pagination.mjs\";\nexport class Models extends APIResource {\n    /**\n     * Retrieves a model instance, providing basic information about the model such as\n     * the owner and permissioning.\n     */\n    retrieve(model, options) {\n        return this._client.get(`/models/${model}`, options);\n    }\n    /**\n     * Lists the currently available models, and provides basic information about each\n     * one such as the owner and availability.\n     */\n    list(options) {\n        return this._client.getAPIList('/models', ModelsPage, options);\n    }\n    /**\n     * Delete a fine-tuned model. You must have the Owner role in your organization to\n     * delete a model.\n     */\n    del(model, options) {\n        return this._client.delete(`/models/${model}`, options);\n    }\n}\n/**\n * Note: no pagination actually occurs yet, this is for forwards-compatibility.\n */\nexport class ModelsPage extends Page {\n}\nModels.ModelsPage = ModelsPage;\n//# sourceMappingURL=models.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../resource.mjs\";\nexport class Moderations extends APIResource {\n    /**\n     * Classifies if text and/or image inputs are potentially harmful. Learn more in\n     * the [moderation guide](https://platform.openai.com/docs/guides/moderation).\n     */\n    create(body, options) {\n        return this._client.post('/moderations', { body, ...options });\n    }\n}\n//# sourceMappingURL=moderations.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as Core from \"../../core.mjs\";\nexport class Parts extends APIResource {\n    /**\n     * Adds a\n     * [Part](https://platform.openai.com/docs/api-reference/uploads/part-object) to an\n     * [Upload](https://platform.openai.com/docs/api-reference/uploads/object) object.\n     * A Part represents a chunk of bytes from the file you are trying to upload.\n     *\n     * Each Part can be at most 64 MB, and you can add Parts until you hit the Upload\n     * maximum of 8 GB.\n     *\n     * It is possible to add multiple Parts in parallel. You can decide the intended\n     * order of the Parts when you\n     * [complete the Upload](https://platform.openai.com/docs/api-reference/uploads/complete).\n     */\n    create(uploadId, body, options) {\n        return this._client.post(`/uploads/${uploadId}/parts`, Core.multipartFormRequestOptions({ body, ...options }));\n    }\n}\n//# sourceMappingURL=parts.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nimport { APIResource } from \"../../resource.mjs\";\nimport * as PartsAPI from \"./parts.mjs\";\nimport { Parts } from \"./parts.mjs\";\nexport class Uploads extends APIResource {\n    constructor() {\n        super(...arguments);\n        this.parts = new PartsAPI.Parts(this._client);\n    }\n    /**\n     * Creates an intermediate\n     * [Upload](https://platform.openai.com/docs/api-reference/uploads/object) object\n     * that you can add\n     * [Parts](https://platform.openai.com/docs/api-reference/uploads/part-object) to.\n     * Currently, an Upload can accept at most 8 GB in total and expires after an hour\n     * after you create it.\n     *\n     * Once you complete the Upload, we will create a\n     * [File](https://platform.openai.com/docs/api-reference/files/object) object that\n     * contains all the parts you uploaded. This File is usable in the rest of our\n     * platform as a regular File object.\n     *\n     * For certain `purpose`s, the correct `mime_type` must be specified. Please refer\n     * to documentation for the supported MIME types for your use case:\n     *\n     * - [Assistants](https://platform.openai.com/docs/assistants/tools/file-search#supported-files)\n     *\n     * For guidance on the proper filename extensions for each purpose, please follow\n     * the documentation on\n     * [creating a File](https://platform.openai.com/docs/api-reference/files/create).\n     */\n    create(body, options) {\n        return this._client.post('/uploads', { body, ...options });\n    }\n    /**\n     * Cancels the Upload. No Parts may be added after an Upload is cancelled.\n     */\n    cancel(uploadId, options) {\n        return this._client.post(`/uploads/${uploadId}/cancel`, options);\n    }\n    /**\n     * Completes the\n     * [Upload](https://platform.openai.com/docs/api-reference/uploads/object).\n     *\n     * Within the returned Upload object, there is a nested\n     * [File](https://platform.openai.com/docs/api-reference/files/object) object that\n     * is ready to use in the rest of the platform.\n     *\n     * You can specify the order of the Parts by passing in an ordered list of the Part\n     * IDs.\n     *\n     * The number of bytes uploaded upon completion must match the number of bytes\n     * initially specified when creating the Upload object. No Parts may be added after\n     * an Upload is completed.\n     */\n    complete(uploadId, body, options) {\n        return this._client.post(`/uploads/${uploadId}/complete`, { body, ...options });\n    }\n}\nUploads.Parts = Parts;\n//# sourceMappingURL=uploads.mjs.map","// File generated from our OpenAPI spec by Stainless. See CONTRIBUTING.md for details.\nvar _a;\nimport * as qs from \"./internal/qs/index.mjs\";\nimport * as Core from \"./core.mjs\";\nimport * as Errors from \"./error.mjs\";\nimport * as Pagination from \"./pagination.mjs\";\nimport * as Uploads from \"./uploads.mjs\";\nimport * as API from \"./resources/index.mjs\";\nimport { Batches, BatchesPage, } from \"./resources/batches.mjs\";\nimport { Completions, } from \"./resources/completions.mjs\";\nimport { Embeddings, } from \"./resources/embeddings.mjs\";\nimport { FileObjectsPage, Files, } from \"./resources/files.mjs\";\nimport { Images, } from \"./resources/images.mjs\";\nimport { Models, ModelsPage } from \"./resources/models.mjs\";\nimport { Moderations, } from \"./resources/moderations.mjs\";\nimport { Audio } from \"./resources/audio/audio.mjs\";\nimport { Beta } from \"./resources/beta/beta.mjs\";\nimport { Chat } from \"./resources/chat/chat.mjs\";\nimport { FineTuning } from \"./resources/fine-tuning/fine-tuning.mjs\";\nimport { Uploads as UploadsAPIUploads, } from \"./resources/uploads/uploads.mjs\";\n/**\n * API Client for interfacing with the OpenAI API.\n */\nexport class OpenAI extends Core.APIClient {\n    /**\n     * API Client for interfacing with the OpenAI API.\n     *\n     * @param {string | undefined} [opts.apiKey=process.env['OPENAI_API_KEY'] ?? undefined]\n     * @param {string | null | undefined} [opts.organization=process.env['OPENAI_ORG_ID'] ?? null]\n     * @param {string | null | undefined} [opts.project=process.env['OPENAI_PROJECT_ID'] ?? null]\n     * @param {string} [opts.baseURL=process.env['OPENAI_BASE_URL'] ?? https://api.openai.com/v1] - Override the default base URL for the API.\n     * @param {number} [opts.timeout=10 minutes] - The maximum amount of time (in milliseconds) the client will wait for a response before timing out.\n     * @param {number} [opts.httpAgent] - An HTTP agent used to manage HTTP(s) connections.\n     * @param {Core.Fetch} [opts.fetch] - Specify a custom `fetch` function implementation.\n     * @param {number} [opts.maxRetries=2] - The maximum number of times the client will retry a request.\n     * @param {Core.Headers} opts.defaultHeaders - Default headers to include with every request to the API.\n     * @param {Core.DefaultQuery} opts.defaultQuery - Default query parameters to include with every request to the API.\n     * @param {boolean} [opts.dangerouslyAllowBrowser=false] - By default, client-side use of this library is not allowed, as it risks exposing your secret API credentials to attackers.\n     */\n    constructor({ baseURL = Core.readEnv('OPENAI_BASE_URL'), apiKey = Core.readEnv('OPENAI_API_KEY'), organization = Core.readEnv('OPENAI_ORG_ID') ?? null, project = Core.readEnv('OPENAI_PROJECT_ID') ?? null, ...opts } = {}) {\n        if (apiKey === undefined) {\n            throw new Errors.OpenAIError(\"The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).\");\n        }\n        const options = {\n            apiKey,\n            organization,\n            project,\n            ...opts,\n            baseURL: baseURL || `https://api.openai.com/v1`,\n        };\n        if (!options.dangerouslyAllowBrowser && Core.isRunningInBrowser()) {\n            throw new Errors.OpenAIError(\"It looks like you're running in a browser-like environment.\\n\\nThis is disabled by default, as it risks exposing your secret API credentials to attackers.\\nIf you understand the risks and have appropriate mitigations in place,\\nyou can set the `dangerouslyAllowBrowser` option to `true`, e.g.,\\n\\nnew OpenAI({ apiKey, dangerouslyAllowBrowser: true });\\n\\nhttps://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety\\n\");\n        }\n        super({\n            baseURL: options.baseURL,\n            timeout: options.timeout ?? 600000 /* 10 minutes */,\n            httpAgent: options.httpAgent,\n            maxRetries: options.maxRetries,\n            fetch: options.fetch,\n        });\n        this.completions = new API.Completions(this);\n        this.chat = new API.Chat(this);\n        this.embeddings = new API.Embeddings(this);\n        this.files = new API.Files(this);\n        this.images = new API.Images(this);\n        this.audio = new API.Audio(this);\n        this.moderations = new API.Moderations(this);\n        this.models = new API.Models(this);\n        this.fineTuning = new API.FineTuning(this);\n        this.beta = new API.Beta(this);\n        this.batches = new API.Batches(this);\n        this.uploads = new API.Uploads(this);\n        this._options = options;\n        this.apiKey = apiKey;\n        this.organization = organization;\n        this.project = project;\n    }\n    defaultQuery() {\n        return this._options.defaultQuery;\n    }\n    defaultHeaders(opts) {\n        return {\n            ...super.defaultHeaders(opts),\n            'OpenAI-Organization': this.organization,\n            'OpenAI-Project': this.project,\n            ...this._options.defaultHeaders,\n        };\n    }\n    authHeaders(opts) {\n        return { Authorization: `Bearer ${this.apiKey}` };\n    }\n    stringifyQuery(query) {\n        return qs.stringify(query, { arrayFormat: 'brackets' });\n    }\n}\n_a = OpenAI;\nOpenAI.OpenAI = _a;\nOpenAI.DEFAULT_TIMEOUT = 600000; // 10 minutes\nOpenAI.OpenAIError = Errors.OpenAIError;\nOpenAI.APIError = Errors.APIError;\nOpenAI.APIConnectionError = Errors.APIConnectionError;\nOpenAI.APIConnectionTimeoutError = Errors.APIConnectionTimeoutError;\nOpenAI.APIUserAbortError = Errors.APIUserAbortError;\nOpenAI.NotFoundError = Errors.NotFoundError;\nOpenAI.ConflictError = Errors.ConflictError;\nOpenAI.RateLimitError = Errors.RateLimitError;\nOpenAI.BadRequestError = Errors.BadRequestError;\nOpenAI.AuthenticationError = Errors.AuthenticationError;\nOpenAI.InternalServerError = Errors.InternalServerError;\nOpenAI.PermissionDeniedError = Errors.PermissionDeniedError;\nOpenAI.UnprocessableEntityError = Errors.UnprocessableEntityError;\nOpenAI.toFile = Uploads.toFile;\nOpenAI.fileFromPath = Uploads.fileFromPath;\nOpenAI.Completions = Completions;\nOpenAI.Chat = Chat;\nOpenAI.Embeddings = Embeddings;\nOpenAI.Files = Files;\nOpenAI.FileObjectsPage = FileObjectsPage;\nOpenAI.Images = Images;\nOpenAI.Audio = Audio;\nOpenAI.Moderations = Moderations;\nOpenAI.Models = Models;\nOpenAI.ModelsPage = ModelsPage;\nOpenAI.FineTuning = FineTuning;\nOpenAI.Beta = Beta;\nOpenAI.Batches = Batches;\nOpenAI.BatchesPage = BatchesPage;\nOpenAI.Uploads = UploadsAPIUploads;\n/** API Client for interfacing with the Azure OpenAI API. */\nexport class AzureOpenAI extends OpenAI {\n    /**\n     * API Client for interfacing with the Azure OpenAI API.\n     *\n     * @param {string | undefined} [opts.apiVersion=process.env['OPENAI_API_VERSION'] ?? undefined]\n     * @param {string | undefined} [opts.endpoint=process.env['AZURE_OPENAI_ENDPOINT'] ?? undefined] - Your Azure endpoint, including the resource, e.g. `https://example-resource.azure.openai.com/`\n     * @param {string | undefined} [opts.apiKey=process.env['AZURE_OPENAI_API_KEY'] ?? undefined]\n     * @param {string | undefined} opts.deployment - A model deployment, if given, sets the base client URL to include `/deployments/{deployment}`.\n     * @param {string | null | undefined} [opts.organization=process.env['OPENAI_ORG_ID'] ?? null]\n     * @param {string} [opts.baseURL=process.env['OPENAI_BASE_URL']] - Sets the base URL for the API, e.g. `https://example-resource.azure.openai.com/openai/`.\n     * @param {number} [opts.timeout=10 minutes] - The maximum amount of time (in milliseconds) the client will wait for a response before timing out.\n     * @param {number} [opts.httpAgent] - An HTTP agent used to manage HTTP(s) connections.\n     * @param {Core.Fetch} [opts.fetch] - Specify a custom `fetch` function implementation.\n     * @param {number} [opts.maxRetries=2] - The maximum number of times the client will retry a request.\n     * @param {Core.Headers} opts.defaultHeaders - Default headers to include with every request to the API.\n     * @param {Core.DefaultQuery} opts.defaultQuery - Default query parameters to include with every request to the API.\n     * @param {boolean} [opts.dangerouslyAllowBrowser=false] - By default, client-side use of this library is not allowed, as it risks exposing your secret API credentials to attackers.\n     */\n    constructor({ baseURL = Core.readEnv('OPENAI_BASE_URL'), apiKey = Core.readEnv('AZURE_OPENAI_API_KEY'), apiVersion = Core.readEnv('OPENAI_API_VERSION'), endpoint, deployment, azureADTokenProvider, dangerouslyAllowBrowser, ...opts } = {}) {\n        if (!apiVersion) {\n            throw new Errors.OpenAIError(\"The OPENAI_API_VERSION environment variable is missing or empty; either provide it, or instantiate the AzureOpenAI client with an apiVersion option, like new AzureOpenAI({ apiVersion: 'My API Version' }).\");\n        }\n        if (typeof azureADTokenProvider === 'function') {\n            dangerouslyAllowBrowser = true;\n        }\n        if (!azureADTokenProvider && !apiKey) {\n            throw new Errors.OpenAIError('Missing credentials. Please pass one of `apiKey` and `azureADTokenProvider`, or set the `AZURE_OPENAI_API_KEY` environment variable.');\n        }\n        if (azureADTokenProvider && apiKey) {\n            throw new Errors.OpenAIError('The `apiKey` and `azureADTokenProvider` arguments are mutually exclusive; only one can be passed at a time.');\n        }\n        // define a sentinel value to avoid any typing issues\n        apiKey ?? (apiKey = API_KEY_SENTINEL);\n        opts.defaultQuery = { ...opts.defaultQuery, 'api-version': apiVersion };\n        if (!baseURL) {\n            if (!endpoint) {\n                endpoint = process.env['AZURE_OPENAI_ENDPOINT'];\n            }\n            if (!endpoint) {\n                throw new Errors.OpenAIError('Must provide one of the `baseURL` or `endpoint` arguments, or the `AZURE_OPENAI_ENDPOINT` environment variable');\n            }\n            baseURL = `${endpoint}/openai`;\n        }\n        else {\n            if (endpoint) {\n                throw new Errors.OpenAIError('baseURL and endpoint are mutually exclusive');\n            }\n        }\n        super({\n            apiKey,\n            baseURL,\n            ...opts,\n            ...(dangerouslyAllowBrowser !== undefined ? { dangerouslyAllowBrowser } : {}),\n        });\n        this.apiVersion = '';\n        this._azureADTokenProvider = azureADTokenProvider;\n        this.apiVersion = apiVersion;\n        this._deployment = deployment;\n    }\n    buildRequest(options) {\n        if (_deployments_endpoints.has(options.path) && options.method === 'post' && options.body !== undefined) {\n            if (!Core.isObj(options.body)) {\n                throw new Error('Expected request body to be an object');\n            }\n            const model = this._deployment || options.body['model'];\n            if (model !== undefined && !this.baseURL.includes('/deployments')) {\n                options.path = `/deployments/${model}${options.path}`;\n            }\n        }\n        return super.buildRequest(options);\n    }\n    async _getAzureADToken() {\n        if (typeof this._azureADTokenProvider === 'function') {\n            const token = await this._azureADTokenProvider();\n            if (!token || typeof token !== 'string') {\n                throw new Errors.OpenAIError(`Expected 'azureADTokenProvider' argument to return a string but it returned ${token}`);\n            }\n            return token;\n        }\n        return undefined;\n    }\n    authHeaders(opts) {\n        return {};\n    }\n    async prepareOptions(opts) {\n        /**\n         * The user should provide a bearer token provider if they want\n         * to use Azure AD authentication. The user shouldn't set the\n         * Authorization header manually because the header is overwritten\n         * with the Azure AD token if a bearer token provider is provided.\n         */\n        if (opts.headers?.['api-key']) {\n            return super.prepareOptions(opts);\n        }\n        const token = await this._getAzureADToken();\n        opts.headers ?? (opts.headers = {});\n        if (token) {\n            opts.headers['Authorization'] = `Bearer ${token}`;\n        }\n        else if (this.apiKey !== API_KEY_SENTINEL) {\n            opts.headers['api-key'] = this.apiKey;\n        }\n        else {\n            throw new Errors.OpenAIError('Unable to handle auth');\n        }\n        return super.prepareOptions(opts);\n    }\n}\nconst _deployments_endpoints = new Set([\n    '/completions',\n    '/chat/completions',\n    '/embeddings',\n    '/audio/transcriptions',\n    '/audio/translations',\n    '/audio/speech',\n    '/images/generations',\n]);\nconst API_KEY_SENTINEL = '<Missing Key>';\nexport { toFile, fileFromPath } from \"./uploads.mjs\";\nexport { OpenAIError, APIError, APIConnectionError, APIConnectionTimeoutError, APIUserAbortError, NotFoundError, ConflictError, RateLimitError, BadRequestError, AuthenticationError, InternalServerError, PermissionDeniedError, UnprocessableEntityError, } from \"./error.mjs\";\nexport default OpenAI;\n//# sourceMappingURL=index.mjs.map","import OpenAI from 'openai';\nimport type { Destination } from '../types/destination';\nimport { destinations } from '../data/destinations';\n\nconst apiKey = import.meta.env.VITE_OPENAI_API_KEY;\n\nif (!apiKey) {\n  console.warn('OpenAI API key is not configured. Using fallback data.');\n}\n\nconst openai = new OpenAI({\n  apiKey: apiKey || 'dummy-key',\n  dangerouslyAllowBrowser: true\n});\n\nexport async function generateDestinationInfo(query: string): Promise<Destination> {\n  if (!apiKey) {\n    // Return static data if no API key is available\n    return destinations.find(dest => \n      dest.name.toLowerCase().includes(query.toLowerCase())\n    ) || destinations[0];\n  }\n\n  try {\n    const completion = await openai.chat.completions.create({\n      model: \"gpt-4-turbo-preview\",\n      messages: [\n        { \n          role: \"system\", \n          content: \"You are a travel assistant. Generate a detailed travel guide in JSON format.\" \n        },\n        { \n          role: \"user\", \n          content: `Generate a JSON response with travel information for: ${query}` \n        }\n      ],\n      response_format: { type: \"json_object\" },\n      temperature: 0.7,\n      max_tokens: 1000\n    });\n\n    const content = JSON.parse(completion.choices[0].message.content);\n    return content;\n  } catch (error) {\n    console.error('OpenAI API Error:', error);\n    // Fallback to static data if API fails\n    return destinations.find(dest => \n      dest.name.toLowerCase().includes(query.toLowerCase())\n    ) || destinations[0];\n  }\n}","import { generateDestinationInfo } from './openai';\n\nconst API_BASE_URL = import.meta.env.PROD \n  ? '/.netlify/functions'\n  : 'http://localhost:8888/.netlify/functions';\n\nexport async function fetchFromAPI(endpoint: string, options: RequestInit = {}) {\n  try {\n    const response = await fetch(`${API_BASE_URL}/${endpoint}`, {\n      ...options,\n      headers: {\n        'Content-Type': 'application/json',\n        ...options.headers,\n      },\n    });\n\n    if (!response.ok) {\n      throw new Error(`API request failed: ${response.statusText}`);\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('API request error:', error);\n    throw error;\n  }\n}\n\nexport { generateDestinationInfo };","import { fetchFromAPI } from './api';\n\n// Cache for search suggestions\nconst suggestionsCache = new Map<string, { suggestions: string[]; timestamp: number }>();\nconst CACHE_DURATION = 1000 * 60 * 5; // 5 minutes\n\nexport async function getSearchSuggestions(query: string): Promise<string[]> {\n  if (!query || query.length < 2) return [];\n\n  // Check cache first\n  const cached = suggestionsCache.get(query);\n  if (cached && Date.now() - cached.timestamp < CACHE_DURATION) {\n    return cached.suggestions;\n  }\n\n  try {\n    const response = await fetchFromAPI('suggestions', {\n      method: 'POST',\n      body: JSON.stringify({ query })\n    });\n\n    const suggestions = response.suggestions || generateFallbackSuggestions(query);\n\n    // Cache the results\n    suggestionsCache.set(query, {\n      suggestions,\n      timestamp: Date.now()\n    });\n\n    return suggestions;\n  } catch (error) {\n    console.error('Error generating suggestions:', error);\n    return generateFallbackSuggestions(query);\n  }\n}\n\nfunction generateFallbackSuggestions(query: string): string[] {\n  return [\n    ` ${query} City Guide`,\n    ` Best Places in ${query}`,\n    ` ${query} Local Food`,\n    ` ${query} Cultural Sites`,\n    ` ${query} Hidden Gems`\n  ];\n}","import React from 'react';\nimport { MapPin } from 'lucide-react';\n\ninterface SearchSuggestionsProps {\n  suggestions: string[];\n  onSelect: (suggestion: string) => void;\n  visible: boolean;\n}\n\nexport function SearchSuggestions({ suggestions, onSelect, visible }: SearchSuggestionsProps) {\n  if (!visible || suggestions.length === 0) return null;\n\n  return (\n    <div className=\"absolute top-full left-0 right-0 mt-2 bg-white rounded-lg shadow-lg \n                    border border-gray-100 overflow-hidden z-50\">\n      <ul className=\"max-h-64 overflow-y-auto\">\n        {suggestions.map((suggestion, index) => (\n          <li key={index}>\n            <button\n              onClick={() => onSelect(suggestion)}\n              className=\"w-full px-4 py-3 text-left hover:bg-gray-50 flex items-center\n                         space-x-2 transition-colors\"\n            >\n              <MapPin className=\"h-4 w-4 text-gray-400 flex-shrink-0\" />\n              <span className=\"text-gray-700\">{suggestion}</span>\n            </button>\n          </li>\n        ))}\n      </ul>\n    </div>\n  );\n}","import { useState, useEffect } from 'react';\n\nexport function useDebounce<T>(value: T, delay: number): T {\n  const [debouncedValue, setDebouncedValue] = useState<T>(value);\n\n  useEffect(() => {\n    const handler = setTimeout(() => {\n      setDebouncedValue(value);\n    }, delay);\n\n    return () => {\n      clearTimeout(handler);\n    };\n  }, [value, delay]);\n\n  return debouncedValue;\n}","import React, { memo, useState, useEffect } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Search } from 'lucide-react';\nimport { Image } from '../ui/Image';\nimport { getRandomTravelImage } from '../../utils/images';\nimport { getSearchSuggestions } from '../../utils/suggestions';\nimport { SearchSuggestions } from './SearchSuggestions';\nimport { useDebounce } from '../../hooks/useDebounce';\n\nfunction SearchHeroComponent() {\n  const navigate = useNavigate();\n  const [query, setQuery] = useState('');\n  const [suggestions, setSuggestions] = useState<string[]>([]);\n  const [showSuggestions, setShowSuggestions] = useState(false);\n  const [backgroundImage, setBackgroundImage] = useState<string>(getRandomTravelImage());\n  const debouncedQuery = useDebounce(query, 300);\n\n  useEffect(() => {\n    async function fetchSuggestions() {\n      if (debouncedQuery.trim().length >= 2) {\n        const results = await getSearchSuggestions(debouncedQuery);\n        setSuggestions(results);\n        setShowSuggestions(true);\n      } else {\n        setSuggestions([]);\n        setShowSuggestions(false);\n      }\n    }\n\n    fetchSuggestions();\n  }, [debouncedQuery]);\n\n  const handleSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (query.trim()) {\n      setShowSuggestions(false);\n      navigate(`/search?q=${encodeURIComponent(query.trim())}`);\n    }\n  };\n\n  const handleSuggestionSelect = (suggestion: string) => {\n    setQuery(suggestion);\n    setShowSuggestions(false);\n    navigate(`/search?q=${encodeURIComponent(suggestion)}`);\n  };\n\n  return (\n    <div className=\"relative h-[600px]\">\n      <div className=\"absolute inset-0 w-full h-full\">\n        <Image\n          className=\"w-full h-full object-cover\"\n          src={backgroundImage}\n          alt=\"Travel background\"\n        />\n        <div className=\"absolute inset-0 w-full h-full bg-black/50\" />\n      </div>\n      \n      <div className=\"relative h-full flex flex-col items-center justify-center px-4\">\n        <div className=\"text-center mb-8 max-w-3xl\">\n          <h1 className=\"text-4xl md:text-5xl lg:text-6xl font-bold text-white mb-4\">\n            Discover Your Next Adventure\n          </h1>\n          <p className=\"text-xl text-gray-200\">\n            Let AI guide you to the perfect destination\n          </p>\n        </div>\n\n        <form onSubmit={handleSearch} className=\"w-full max-w-2xl relative\">\n          <div className=\"relative\">\n            <input\n              type=\"text\"\n              value={query}\n              onChange={(e) => setQuery(e.target.value)}\n              onFocus={() => setShowSuggestions(true)}\n              placeholder=\"Try 'Hidden gems in Bali' or 'Historical landmarks in Rome'\"\n              className=\"w-full px-6 py-4 pr-16 text-lg rounded-full bg-white/90 \n                       backdrop-blur-sm text-gray-900 placeholder-gray-500 \n                       focus:outline-none focus:ring-2 focus:ring-blue-500 shadow-lg\"\n            />\n            <button\n              type=\"submit\"\n              className=\"absolute right-2 top-1/2 -translate-y-1/2 p-2 \n                       bg-blue-600 text-white rounded-full hover:bg-blue-700 \n                       focus:outline-none focus:ring-2 focus:ring-blue-500 \n                       focus:ring-offset-2 transition-colors\"\n            >\n              <Search className=\"h-6 w-6\" />\n            </button>\n          </div>\n\n          <SearchSuggestions\n            suggestions={suggestions}\n            onSelect={handleSuggestionSelect}\n            visible={showSuggestions}\n          />\n        </form>\n      </div>\n    </div>\n  );\n}\n\nexport const SearchHero = memo(SearchHeroComponent);","import React from 'react';\nimport { Loader2 } from 'lucide-react';\n\nexport function LoadingSpinner() {\n  return (\n    <div className=\"flex items-center justify-center min-h-[50vh]\">\n      <Loader2 className=\"h-8 w-8 animate-spin text-blue-600\" />\n    </div>\n  );\n}","import React, { Suspense } from 'react';\nimport { SearchHero } from '../components/search/SearchHero';\nimport { LoadingSpinner } from '../components/ui/LoadingSpinner';\n\nconst FeaturedDestinations = React.lazy(() => \n  import('../components/destinations/FeaturedDestinations').then(mod => ({\n    default: mod.FeaturedDestinations\n  }))\n);\n\nfunction HomePage() {\n  return (\n    <>\n      <SearchHero />\n      <Suspense fallback={<LoadingSpinner />}>\n        <FeaturedDestinations />\n      </Suspense>\n    </>\n  );\n}\n\nexport default HomePage;","import type { Destination } from '../types/destination';\nimport { destinations } from '../data/destinations';\n\n// Cache implementation\nconst searchCache = new Map<string, { data: Destination; timestamp: number }>();\nconst CACHE_DURATION = 1000 * 60 * 60 * 24; // 24 hours\n\nconst API_URL = import.meta.env.PROD ? '/.netlify/functions' : 'http://localhost:8888/.netlify/functions';\n\nexport async function getSearchResults(query: string): Promise<Destination> {\n  // Check cache first\n  const cached = searchCache.get(query);\n  if (cached && Date.now() - cached.timestamp < CACHE_DURATION) {\n    return cached.data;\n  }\n\n  try {\n    const response = await fetch(`${API_URL}/search`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({ query })\n    });\n\n    if (!response.ok) {\n      throw new Error('Failed to fetch search results');\n    }\n\n    const result = await response.json();\n\n    // Cache the results\n    searchCache.set(query, {\n      data: result,\n      timestamp: Date.now()\n    });\n\n    return result;\n  } catch (error) {\n    console.error('Error fetching search results:', error);\n    // Fallback to static data\n    const fallback = destinations.find(dest => \n      dest.name.toLowerCase().includes(query.toLowerCase())\n    ) || destinations[0];\n    \n    return fallback;\n  }\n}","import { \n  Camera, \n  Utensils, \n  Hotel, \n  MapPin, \n  Compass,\n  Music,\n  Coffee,\n  Wine,\n  ShoppingBag,\n  Ticket\n} from 'lucide-react';\n\nexport function getIconForRecommendationType(type: string) {\n  const iconMap: Record<string, any> = {\n    attraction: Camera,\n    restaurant: Utensils,\n    hotel: Hotel,\n    location: MapPin,\n    activity: Compass,\n    entertainment: Music,\n    cafe: Coffee,\n    bar: Wine,\n    shopping: ShoppingBag,\n    event: Ticket,\n    // Default to Camera if type is not found\n    default: Camera\n  };\n\n  return iconMap[type.toLowerCase()] || iconMap.default;\n}","import React from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { ArrowRight } from 'lucide-react';\nimport { getSearchSuggestions } from '../../utils/suggestions';\n\ninterface RelatedQueriesProps {\n  baseQuery: string;\n}\n\nexport function RelatedQueries({ baseQuery }: RelatedQueriesProps) {\n  const navigate = useNavigate();\n  const suggestions = getSearchSuggestions(baseQuery);\n\n  const handleQueryClick = (query: string) => {\n    navigate(`/search?q=${encodeURIComponent(query)}`);\n  };\n\n  return (\n    <div className=\"bg-white py-12\">\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\n        <h2 className=\"text-2xl font-bold text-gray-900 mb-8\">\n          Explore More About This Destination\n        </h2>\n        <div className=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {suggestions.map((suggestion, index) => (\n            <button\n              key={index}\n              onClick={() => handleQueryClick(suggestion)}\n              className=\"flex items-center justify-between p-6 bg-gray-50 \n                       rounded-lg hover:bg-gray-100 transition-colors \n                       group text-left\"\n            >\n              <span className=\"text-gray-900 font-medium\">{suggestion}</span>\n              <ArrowRight className=\"h-5 w-5 text-gray-400 \n                                   group-hover:text-blue-600 \n                                   transition-colors\" />\n            </button>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}","import React, { useState } from 'react';\nimport { \n  MapPin, \n  Calendar, \n  Thermometer, \n  Coins, \n  Languages,\n  Info,\n  Star,\n  Search\n} from 'lucide-react';\nimport { Image } from '../ui/Image';\nimport { getIconForRecommendationType } from '../../utils/icons';\nimport { RelatedQueries } from './RelatedQueries';\nimport { getSearchResults } from '../../utils/search';\nimport type { Destination } from '../../types/destination';\n\ninterface SearchResultContentProps {\n  content: Destination;\n  isLoading: boolean;\n}\n\nexport function SearchResultContent({ content, isLoading }: SearchResultContentProps) {\n  const [query, setQuery] = useState('');\n  const [followUpResults, setFollowUpResults] = useState<Destination | null>(null);\n\n  const handleSearch = (e: React.FormEvent) => {\n    e.preventDefault();\n    if (query.trim()) {\n      const results = getSearchResults(query.trim());\n      setFollowUpResults(results);\n      setQuery('');\n    }\n  };\n\n  if (isLoading) {\n    return null;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gray-50\">\n      {/* Hero Section */}\n      <div className=\"relative h-[60vh] min-h-[500px]\">\n        <Image\n          src={content.image}\n          alt={content.title}\n          className=\"w-full h-full object-cover\"\n        />\n        <div className=\"absolute inset-0 bg-gradient-to-t from-black/80 via-black/50 to-transparent\" />\n        <div className=\"absolute bottom-0 left-0 right-0 p-8\">\n          <div className=\"max-w-7xl mx-auto\">\n            <div className=\"max-w-3xl mb-8\">\n              <h1 className=\"text-4xl md:text-5xl lg:text-6xl font-bold mb-4 text-white\">\n                {content.title}\n              </h1>\n              <p className=\"text-xl text-gray-200\">{content.subtitle}</p>\n            </div>\n            \n            {/* Search Bar */}\n            <form onSubmit={handleSearch} className=\"max-w-2xl\">\n              <div className=\"relative\">\n                <input\n                  type=\"text\"\n                  value={query}\n                  onChange={(e) => setQuery(e.target.value)}\n                  placeholder=\"Ask anything about this destination...\"\n                  className=\"w-full px-6 py-4 pr-16 text-lg rounded-full bg-white/90 \n                           backdrop-blur-sm text-gray-900 placeholder-gray-500 \n                           focus:outline-none focus:ring-2 focus:ring-blue-500 \n                           shadow-lg\"\n                />\n                <button\n                  type=\"submit\"\n                  className=\"absolute right-2 top-1/2 -translate-y-1/2 p-2 \n                           bg-blue-600 text-white rounded-full hover:bg-blue-700 \n                           focus:outline-none focus:ring-2 focus:ring-blue-500 \n                           focus:ring-offset-2 transition-colors\"\n                >\n                  <Search className=\"h-6 w-6\" />\n                </button>\n              </div>\n            </form>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12\">\n        {/* Main Content Grid */}\n        <div className=\"grid grid-cols-1 lg:grid-cols-12 gap-8\">\n          {/* Left Column - Main Content */}\n          <div className=\"lg:col-span-8 space-y-8\">\n            {/* Follow-up Results */}\n            {followUpResults && (\n              <div className=\"bg-white rounded-xl shadow-md overflow-hidden animate-slide-in\">\n                <div className=\"p-6\">\n                  <h2 className=\"text-2xl font-bold mb-4\">{followUpResults.title}</h2>\n                  <p className=\"text-gray-600 mb-6\">{followUpResults.subtitle}</p>\n                  {followUpResults.sections?.map((section, index) => (\n                    <div key={index} className=\"mb-6\">\n                      <h3 className=\"text-xl font-semibold mb-3\">{section.title}</h3>\n                      <p className=\"text-gray-700 mb-4\">{section.content}</p>\n                      <ul className=\"space-y-2\">\n                        {section.highlights.map((highlight, i) => (\n                          <li key={i} className=\"flex items-center text-gray-600\">\n                            <Star className=\"h-5 w-5 text-yellow-500 mr-2 flex-shrink-0\" />\n                            {highlight}\n                          </li>\n                        ))}\n                      </ul>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            )}\n\n            {/* Main Sections */}\n            {content.sections?.map((section, index) => (\n              <section \n                key={index} \n                className=\"bg-white rounded-xl shadow-md overflow-hidden\"\n              >\n                <div className=\"relative h-48\">\n                  <Image\n                    src={section.image}\n                    alt={section.title}\n                    className=\"w-full h-full object-cover\"\n                  />\n                  <div className=\"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent\" />\n                  <h2 className=\"absolute bottom-4 left-6 text-2xl font-bold text-white\">\n                    {section.title}\n                  </h2>\n                </div>\n                <div className=\"p-6\">\n                  <p className=\"text-gray-700 mb-4\">{section.content}</p>\n                  <ul className=\"space-y-2\">\n                    {section.highlights.map((highlight, i) => (\n                      <li key={i} className=\"flex items-center text-gray-600\">\n                        <Star className=\"h-5 w-5 text-yellow-500 mr-2 flex-shrink-0\" />\n                        {highlight}\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n              </section>\n            ))}\n          </div>\n\n          {/* Right Column - Practical Info & Recommendations */}\n          <div className=\"lg:col-span-4 space-y-8\">\n            {/* Practical Information Card */}\n            <div className=\"bg-white rounded-xl shadow-md p-6 sticky top-24\">\n              <h3 className=\"text-xl font-semibold mb-4 flex items-center\">\n                <Info className=\"h-5 w-5 mr-2 text-blue-600\" />\n                Practical Information\n              </h3>\n              <div className=\"space-y-4\">\n                <div className=\"flex items-start\">\n                  <Calendar className=\"h-5 w-5 mr-3 text-gray-500 flex-shrink-0 mt-1\" />\n                  <div>\n                    <p className=\"font-medium text-gray-700\">Best Time to Visit</p>\n                    <p className=\"text-gray-600\">{content.practicalInfo.bestTimeToVisit}</p>\n                  </div>\n                </div>\n                <div className=\"flex items-start\">\n                  <Thermometer className=\"h-5 w-5 mr-3 text-gray-500 flex-shrink-0 mt-1\" />\n                  <div>\n                    <p className=\"font-medium text-gray-700\">Climate</p>\n                    <p className=\"text-gray-600\">{content.practicalInfo.climate}</p>\n                  </div>\n                </div>\n                <div className=\"flex items-start\">\n                  <Coins className=\"h-5 w-5 mr-3 text-gray-500 flex-shrink-0 mt-1\" />\n                  <div>\n                    <p className=\"font-medium text-gray-700\">Currency</p>\n                    <p className=\"text-gray-600\">{content.practicalInfo.currency}</p>\n                  </div>\n                </div>\n                <div className=\"flex items-start\">\n                  <Languages className=\"h-5 w-5 mr-3 text-gray-500 flex-shrink-0 mt-1\" />\n                  <div>\n                    <p className=\"font-medium text-gray-700\">Language</p>\n                    <p className=\"text-gray-600\">{content.practicalInfo.language}</p>\n                  </div>\n                </div>\n              </div>\n\n              {/* Recommendations */}\n              <div className=\"mt-8\">\n                <h3 className=\"text-xl font-semibold mb-4 flex items-center\">\n                  <Star className=\"h-5 w-5 mr-2 text-blue-600\" />\n                  Top Recommendations\n                </h3>\n                <div className=\"space-y-4\">\n                  {content.recommendations.map((rec, index) => {\n                    const Icon = getIconForRecommendationType(rec.type);\n                    return (\n                      <div key={index} className=\"flex items-start\">\n                        <Icon className=\"h-5 w-5 mr-3 text-gray-500 flex-shrink-0 mt-1\" />\n                        <div>\n                          <p className=\"font-medium text-gray-700\">{rec.title}</p>\n                          <p className=\"text-gray-600\">{rec.description}</p>\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      {/* Related Queries Section */}\n      <RelatedQueries baseQuery={content.title} />\n    </div>\n  );\n}","import React from 'react';\nimport { Lightbulb } from 'lucide-react';\n\ninterface TravelTipProps {\n  tip: string;\n  author?: string;\n}\n\nexport function TravelTip({ tip, author }: TravelTipProps) {\n  return (\n    <div className=\"bg-white/10 backdrop-blur-sm rounded-lg p-6 max-w-xl mx-auto\">\n      <div className=\"flex items-start space-x-4\">\n        <Lightbulb className=\"h-6 w-6 text-yellow-400 flex-shrink-0 mt-1\" />\n        <div>\n          <p className=\"text-white text-lg\">{tip}</p>\n          {author && (\n            <p className=\"text-gray-300 mt-2 text-sm italic\">- {author}</p>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}","export const travelTips = [\n  {\n    tip: \"Pack a portable charger - you'll thank yourself later when exploring off the beaten path.\",\n    author: \"Travel Pro Tip\"\n  },\n  {\n    tip: \"Learn basic phrases in the local language - it shows respect and opens doors to authentic experiences.\",\n    author: \"Cultural Explorer\"\n  },\n  {\n    tip: \"Take photos of your hotel's address and nearby landmarks in case you get lost.\",\n    author: \"Safety First\"\n  },\n  {\n    tip: \"Always carry a reusable water bottle and some local currency for emergencies.\",\n    author: \"Sustainable Traveler\"\n  },\n  {\n    tip: \"Try the street food where locals eat - it's often the most authentic cuisine.\",\n    author: \"Foodie Adventurer\"\n  }\n];","import React, { useState, useEffect } from 'react';\nimport { TravelTip } from './TravelTip';\nimport { travelTips } from '../../data/tips';\n\nexport function TravelTipsCarousel() {\n  const [currentTipIndex, setCurrentTipIndex] = useState(0);\n  const [isTransitioning, setIsTransitioning] = useState(false);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      setIsTransitioning(true);\n      setTimeout(() => {\n        setCurrentTipIndex((prev) => (prev + 1) % travelTips.length);\n        setIsTransitioning(false);\n      }, 500);\n    }, 5000);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  const currentTip = travelTips[currentTipIndex];\n\n  return (\n    <div className=\"relative overflow-hidden w-full max-w-xl mx-auto\">\n      <div\n        className={`transform transition-all duration-500 ease-in-out ${\n          isTransitioning ? 'opacity-0 translate-y-4' : 'opacity-100 translate-y-0'\n        }`}\n      >\n        <TravelTip tip={currentTip.tip} author={currentTip.author} />\n      </div>\n    </div>\n  );\n}","import React, { useEffect, useState } from 'react';\nimport { Plane } from 'lucide-react';\nimport { TravelTipsCarousel } from './TravelTipsCarousel';\n\nexport function LoadingPage() {\n  const [progress, setProgress] = useState(0);\n\n  useEffect(() => {\n    // Fast initial progress up to 60%\n    const fastProgress = setInterval(() => {\n      setProgress(prev => {\n        if (prev >= 60) {\n          clearInterval(fastProgress);\n          return prev;\n        }\n        return prev + 5;\n      });\n    }, 100);\n\n    // Slower progress from 60% to 90%\n    setTimeout(() => {\n      const slowProgress = setInterval(() => {\n        setProgress(prev => {\n          if (prev >= 90) {\n            clearInterval(slowProgress);\n            return prev;\n          }\n          return prev + 1;\n        });\n      }, 500);\n\n      return () => clearInterval(slowProgress);\n    }, 2000);\n\n    // Very slow progress from 90% to 99%\n    setTimeout(() => {\n      const finalProgress = setInterval(() => {\n        setProgress(prev => {\n          if (prev >= 99) {\n            clearInterval(finalProgress);\n            return prev;\n          }\n          return prev + 0.2;\n        });\n      }, 1000);\n\n      return () => clearInterval(finalProgress);\n    }, 6000);\n\n    return () => clearInterval(fastProgress);\n  }, []);\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-blue-600 to-purple-700 flex items-center justify-center\">\n      <div className=\"max-w-4xl mx-auto px-4 py-16 text-center space-y-12\">\n        {/* Animated Plane */}\n        <div className=\"relative inline-block\">\n          <Plane className=\"h-16 w-16 text-white animate-pulse\" />\n          <div className=\"absolute inset-0 animate-ping opacity-75\">\n            <Plane className=\"h-16 w-16 text-white\" />\n          </div>\n        </div>\n\n        {/* Loading Text */}\n        <div className=\"space-y-4\">\n          <h2 className=\"text-3xl font-bold text-white\">\n            Planning Your Perfect Trip\n          </h2>\n          <p className=\"text-xl text-gray-200\">\n            Gathering insights and recommendations just for you...\n          </p>\n        </div>\n\n        {/* Progress Bar */}\n        <div className=\"w-full max-w-md mx-auto\">\n          <div className=\"h-2 bg-white/20 rounded-full overflow-hidden\">\n            <div \n              className=\"h-full bg-white rounded-full transition-all duration-300 ease-out\"\n              style={{ width: `${progress}%` }}\n            />\n          </div>\n          <p className=\"mt-2 text-gray-200\">{Math.round(progress)}%</p>\n        </div>\n\n        {/* Travel Tips Carousel */}\n        <div className=\"mt-12\">\n          <TravelTipsCarousel />\n        </div>\n      </div>\n    </div>\n  );\n}","import React, { useState, useEffect } from 'react';\nimport { useSearchParams } from 'react-router-dom';\nimport { getSearchResults } from '../utils/search';\nimport { SearchResultContent } from '../components/search/SearchResultContent';\nimport { LoadingPage } from '../components/loading/LoadingPage';\nimport type { Destination } from '../types/destination';\n\nfunction SearchResultsPage() {\n  const [searchParams] = useSearchParams();\n  const [isLoading, setIsLoading] = useState(true);\n  const [searchResults, setSearchResults] = useState<Destination | null>(null);\n  const query = searchParams.get('q') || '';\n\n  useEffect(() => {\n    async function fetchResults() {\n      if (query) {\n        setIsLoading(true);\n        try {\n          const results = await getSearchResults(query);\n          setSearchResults(results);\n        } catch (error) {\n          console.error('Error fetching results:', error);\n        } finally {\n          // Add a minimum loading time for better UX\n          setTimeout(() => setIsLoading(false), 2000);\n        }\n      }\n    }\n\n    fetchResults();\n  }, [query]);\n\n  if (!query) {\n    return (\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16\">\n        <p className=\"text-center text-gray-600\">No search query provided.</p>\n      </div>\n    );\n  }\n\n  if (isLoading) {\n    return <LoadingPage />;\n  }\n\n  if (!searchResults) {\n    return (\n      <div className=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16\">\n        <p className=\"text-center text-red-600\">Failed to load search results. Please try again.</p>\n      </div>\n    );\n  }\n\n  return <SearchResultContent content={searchResults} isLoading={false} />;\n}\n\nexport default SearchResultsPage;","import React, { useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { Loader2 } from 'lucide-react';\nimport { useAuth } from '../../hooks/useAuth';\n\ninterface AuthFormProps {\n  mode: 'login' | 'register';\n}\n\nexport function AuthForm({ mode }: AuthFormProps) {\n  const [email, setEmail] = useState('');\n  const [password, setPassword] = useState('');\n  const [loading, setLoading] = useState(false);\n  const navigate = useNavigate();\n  const { signIn, signUp } = useAuth();\n\n  const handleSubmit = async (e: React.FormEvent) => {\n    e.preventDefault();\n    setLoading(true);\n\n    try {\n      if (mode === 'login') {\n        await signIn(email, password);\n      } else {\n        await signUp(email, password);\n      }\n      navigate('/');\n    } catch (error) {\n      console.error('Authentication error:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  return (\n    <div className=\"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8\">\n      <div className=\"sm:mx-auto sm:w-full sm:max-w-md\">\n        <h2 className=\"mt-6 text-center text-3xl font-extrabold text-gray-900\">\n          {mode === 'login' ? 'Sign in to your account' : 'Create your account'}\n        </h2>\n      </div>\n\n      <div className=\"mt-8 sm:mx-auto sm:w-full sm:max-w-md\">\n        <div className=\"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10\">\n          <form onSubmit={handleSubmit} className=\"space-y-6\">\n            <div>\n              <label htmlFor=\"email\" className=\"block text-sm font-medium text-gray-700\">\n                Email address\n              </label>\n              <div className=\"mt-1\">\n                <input\n                  id=\"email\"\n                  name=\"email\"\n                  type=\"email\"\n                  autoComplete=\"email\"\n                  required\n                  value={email}\n                  onChange={(e) => setEmail(e.target.value)}\n                  className=\"appearance-none block w-full px-3 py-2 border border-gray-300 \n                           rounded-md shadow-sm placeholder-gray-400 focus:outline-none \n                           focus:ring-blue-500 focus:border-blue-500\"\n                />\n              </div>\n            </div>\n\n            <div>\n              <label htmlFor=\"password\" className=\"block text-sm font-medium text-gray-700\">\n                Password\n              </label>\n              <div className=\"mt-1\">\n                <input\n                  id=\"password\"\n                  name=\"password\"\n                  type=\"password\"\n                  autoComplete={mode === 'login' ? 'current-password' : 'new-password'}\n                  required\n                  value={password}\n                  onChange={(e) => setPassword(e.target.value)}\n                  className=\"appearance-none block w-full px-3 py-2 border border-gray-300 \n                           rounded-md shadow-sm placeholder-gray-400 focus:outline-none \n                           focus:ring-blue-500 focus:border-blue-500\"\n                />\n              </div>\n            </div>\n\n            <div>\n              <button\n                type=\"submit\"\n                disabled={loading}\n                className=\"w-full flex justify-center py-2 px-4 border border-transparent \n                         rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 \n                         hover:bg-blue-700 focus:outline-none focus:ring-2 \n                         focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 \n                         disabled:cursor-not-allowed\"\n              >\n                {loading ? (\n                  <Loader2 className=\"h-5 w-5 animate-spin\" />\n                ) : mode === 'login' ? (\n                  'Sign In'\n                ) : (\n                  'Sign Up'\n                )}\n              </button>\n            </div>\n          </form>\n        </div>\n      </div>\n    </div>\n  );\n}","import React from 'react';\nimport { AuthForm } from '../components/auth/AuthForm';\n\nfunction LoginPage() {\n  return <AuthForm mode=\"login\" />;\n}\n\nexport default LoginPage;","import React from 'react';\nimport { AuthForm } from '../components/auth/AuthForm';\n\nfunction RegisterPage() {\n  return <AuthForm mode=\"register\" />;\n}\n\nexport default RegisterPage;","import React from 'react';\nimport { Routes, Route } from 'react-router-dom';\nimport { Layout } from './components/layout/Layout';\nimport HomePage from './pages/HomePage';\nimport SearchResultsPage from './pages/SearchResultsPage';\nimport LoginPage from './pages/LoginPage';\nimport RegisterPage from './pages/RegisterPage';\n\nfunction App() {\n  return (\n    <Layout>\n      <Routes>\n        <Route path=\"/\" element={<HomePage />} />\n        <Route path=\"/search\" element={<SearchResultsPage />} />\n        <Route path=\"/login\" element={<LoginPage />} />\n        <Route path=\"/register\" element={<RegisterPage />} />\n      </Routes>\n    </Layout>\n  );\n}\n\nexport default App;","import React from 'react';\nimport { createRoot } from 'react-dom/client';\nimport { QueryClient, QueryClientProvider } from '@tanstack/react-query';\nimport { BrowserRouter } from 'react-router-dom';\nimport { Toaster } from 'react-hot-toast';\nimport { AuthProvider } from './hooks/useAuth';\nimport App from './App';\nimport './index.css';\n\nconst queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      staleTime: 1000 * 60 * 5, // 5 minutes\n      retry: 1,\n      refetchOnWindowFocus: false,\n    },\n  },\n});\n\nconst container = document.getElementById('root');\nif (!container) throw new Error('Failed to find the root element');\n\nconst root = createRoot(container);\nroot.render(\n  <React.StrictMode>\n    <QueryClientProvider client={queryClient}>\n      <BrowserRouter>\n        <AuthProvider>\n          <App />\n          <Toaster position=\"top-right\" />\n        </AuthProvider>\n      </BrowserRouter>\n    </QueryClientProvider>\n  </React.StrictMode>\n);"],"file":"assets/index-BewH937b.js"}